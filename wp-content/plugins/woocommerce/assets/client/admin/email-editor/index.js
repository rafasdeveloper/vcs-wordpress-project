<<<<<<< HEAD
(()=>{"use strict";var e,t={384:(e,t,o)=>{var n={};o.r(n),o.d(n,{requestSendingNewsletterPreview:()=>ao,setIsFetchingPersonalizationTags:()=>co,setPersonalizationTagsList:()=>mo,setTemplateToPost:()=>lo,togglePreviewModal:()=>so,updateSendPreviewEmail:()=>io});var r={};o.r(r),o.d(r,{canUserEditGlobalEmailStyles:()=>Po,canUserEditTemplates:()=>ko,getBlockPatternsForEmailTemplate:()=>jo,getCurrentTemplate:()=>Eo,getCurrentTemplateContent:()=>To,getEditedEmailContent:()=>bo,getEditedPostTemplate:()=>Co,getEmailPostId:()=>Mo,getEmailTemplates:()=>Bo,getGlobalEmailStylesPost:()=>No,getGlobalStylesPostId:()=>Ho,getInitialEditorSettings:()=>Io,getPaletteColors:()=>zo,getPersonalizationTagsList:()=>Lo,getPersonalizationTagsState:()=>Ao,getPreviewState:()=>Fo,getSentEmailEditorPosts:()=>vo,getStyles:()=>Ro,getTheme:()=>Oo,getUrls:()=>Vo,hasEdits:()=>xo,hasEmptyContent:()=>wo,isEmailSent:()=>fo,isFeatureActive:()=>yo});var s={};o.r(s),o.d(s,{getPersonalizationTagsList:()=>Do});const i=window.wp.data,l=window.wp.element,a=window.wp.hooks,c=(window.wp.formatLibrary,window.wp.blockLibrary),d=window.wp.blockEditor,m=window.wp.compose,p=window.ReactJSXRuntime,u=(0,m.createHigherOrderComponent)((e=>function(t){return"core/columns"!==t.name?(0,p.jsx)(e,{...t}):(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(e,{...t}),(0,p.jsx)(d.InspectorControls,{children:(0,p.jsx)("style",{children:"\n      .components-panel__body .components-toggle-control .components-form-toggle { opacity: 0.3; }\n      .components-panel__body .components-toggle-control .components-form-toggle__input { pointer-events: none; }\n      .components-panel__body .components-toggle-control label { pointer-events: none; }\n    "})})]})}),"columnsEditCallback"),_=window.wp.i18n;function g({layoutClassNames:e}){const t=(0,d.useBlockProps)({className:e});return(0,p.jsxs)("div",{...t,children:[(0,p.jsx)("p",{children:(0,_.__)("This is the Content block.","woocommerce")}),(0,p.jsx)("p",{children:(0,_.__)("It will display all the blocks in the email content, which might be only simple text paragraphs. You can enrich your message with images, incorporate data through tables, explore different layout designs with columns, or use any other block type.","woocommerce")})]})}const h=(0,m.createHigherOrderComponent)((e=>function(t){return"core/image"!==t.name?(0,p.jsx)(e,{...t}):(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(e,{...t}),(0,p.jsx)(d.InspectorControls,{children:(0,p.jsx)("style",{children:"\n        .components-tools-panel .components-toggle-control { display: none; }\n      "})})]})}),"imageEditCallback"),y=window.wp.richText,x=window.wp.components,w=(e,t)=>{const o=e.current.ownerDocument.defaultView.getSelection();if(!o.rangeCount)return{start:0,end:0};const n=o.getRangeAt(0);if(null===o.anchorNode.previousSibling)return{start:o.anchorOffset,end:o.anchorOffset+n.toString().length};const r=(0,y.create)({html:t});let s=o.anchorNode.previousSibling;s=function(e){let t=e;for(;t&&t?.children?.length>0;)t=t.children[0];return t}(s);const i=function(e,t){let o=null;for(const[n,r]of t.entries())if(r)for(const t of r)t?.attributes&&e.tagName.toLowerCase()===t.tagName?.toLowerCase()&&e.getAttribute("data-link-href")===t?.attributes["data-link-href"]&&(o=n);return o}(s,r.formats);if(null!==i)return{start:i+o.anchorOffset+1,end:i+o.anchorOffset+n.toString().length};const l=function(e,t){for(const[o,n]of t.entries()){if(!n)continue;const{attributes:t}=n;if(e.getAttribute("data-rich-text-comment")===t["data-rich-text-comment"])return o}return null}(s,r.replacements);return null!==l?{start:l+o.anchorOffset+1,end:l+o.anchorOffset+n.toString().length}:{start:r.text.length,end:r.text.length+n.toString().length}},f=(e,t)=>(t.forEach((t=>{if(!e.includes(t.token.slice(0,t.token.length-1)))return;const o=t.token.substring(1,t.token.length-1).replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),n=new RegExp(`(?<!\x3c!--)(?<!["'])\\[(${o}(\\s[^\\]]*)?)\\](?!--\x3e)`,"g");e=e.replace(n,(e=>`\x3c!--${e}--\x3e`))})),e),b=({groupedTags:e,activeCategory:t,onCategorySelect:o})=>{const n=e=>e===t?"woocommerce-personalization-tags-modal-menu-item-active":"";return(0,p.jsxs)(x.MenuGroup,{className:"woocommerce-personalization-tags-modal-menu",children:[(0,p.jsx)(x.MenuItem,{onClick:()=>o(null),className:n(null),children:(0,_.__)("All","woocommerce")}),(0,p.jsx)("div",{className:"woocommerce-personalization-tags-modal-menu-separator","aria-hidden":"true",role:"presentation","data-testid":"woocommerce-personalization-tags-modal-menu-separator"}),Object.keys(e).map(((e,t,r)=>(0,p.jsxs)(l.Fragment,{children:[(0,p.jsx)(x.MenuItem,{onClick:()=>o(e),className:n(e),children:e}),t<r.length-1&&(0,p.jsx)("div",{className:"woocommerce-personalization-tags-modal-menu-separator","aria-hidden":"true",role:"presentation","data-testid":"woocommerce-personalization-tags-modal-menu-separator"})]},e)))]})},v=({groupedTags:e,activeCategory:t,onInsert:o,canInsertLink:n,closeCallback:r,openLinkModal:s})=>{const{updateBlockAttributes:l}=(0,i.useDispatch)(d.store),a=(0,i.useSelect)((e=>e(d.store).getSelectedBlockClientId())),c=(0,i.useSelect)((e=>e(d.store).getBlock(a))),m=["core/button"].includes(c?.name),u=null===t?Object.entries(e):[[t,e[t]||[]]];return(0,p.jsx)(p.Fragment,{children:u.map((([e,t])=>(0,p.jsxs)("div",{children:[(0,p.jsx)("div",{className:"woocommerce-personalization-tags-modal-category",children:e}),(0,p.jsx)("div",{className:"woocommerce-personalization-tags-modal-category-group",children:t.map((t=>{const i=/\burl\b/.test(t.token);return(0,p.jsxs)("div",{className:"woocommerce-personalization-tags-modal-category-group-item",children:[(0,p.jsxs)("div",{className:"woocommerce-personalization-tags-modal-item-text",children:[(0,p.jsx)("strong",{children:t.name}),t.valueToInsert]}),(0,p.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end"},children:[(0,p.jsx)(x.Button,{variant:"link",onClick:()=>{o&&o(t.valueToInsert,!1)},children:(0,_.__)("Insert","woocommerce")}),m&&i&&(0,p.jsx)(x.Button,{variant:"link",onClick:()=>{l(a,{url:t.valueToInsert}),r()},children:(0,_.__)("Set as URL","woocommerce")}),e===(0,_.__)("Link","woocommerce")&&n&&(0,p.jsx)(p.Fragment,{children:(0,p.jsx)(x.Button,{variant:"link",onClick:()=>{r(),s(t)},children:(0,_.__)("Insert as link","woocommerce")})})]})]},t.token)}))})]},e)))})},j=({onInsert:e,isOpened:t,closeCallback:o,tag:n})=>{const[r,s]=(0,l.useState)((0,_.__)("Link","woocommerce"));return t?(0,p.jsxs)(x.Modal,{size:"small",title:(0,_.__)("Insert Link","woocommerce"),onRequestClose:o,className:"woocommerce-personalization-tags-modal",children:[(0,p.jsx)(x.TextControl,{label:(0,_.__)("Link Text","woocommerce"),value:r,onChange:s}),(0,p.jsx)(x.Button,{isPrimary:!0,onClick:()=>{e&&e(n.token,r)},children:(0,_.__)("Insert","woocommerce")})]}):null},k=window.lodash,S=(0,a.applyFilters)("woocommerce_email_editor_events_tracking_enabled",!1),C="email_editor_events",E=new EventTarget,T=(e,t={})=>{if(!S)return;const o={name:`${C}_${e}`,..."object"!=typeof t?{data:t}:t};E.dispatchEvent(new CustomEvent(C,{detail:o}))},P=function(){const e={};return(t,o={})=>{if(!S)return;const n=`${t}_${JSON.stringify(o).length}`;e[n]||(T(t,o),e[n]=!0)}}(),N=(0,k.debounce)(T,700),B="email-editor/editor",M=window.WooCommerceEmailEditor.current_post_type,I=window.WooCommerceEmailEditor.current_post_id,z=({onInsert:e,isOpened:t,closeCallback:o,canInsertLink:n=!1,openedBy:r=""})=>{const[s,a]=(0,l.useState)(null),[c,d]=(0,l.useState)(""),[m,u]=(0,l.useState)(null),[g,h]=(0,l.useState)(!1),y=(0,i.useSelect)((e=>e(B).getPersonalizationTagsList()),[]);if(g)return(0,p.jsx)(j,{onInsert:(t,o)=>{e(t,o),h(!1)},isOpened:g,closeCallback:()=>h(!1),tag:m});if(!t)return null;P("personalization_tags_modal_opened",{openedBy:r});const w=y.reduce(((e,t)=>{const{category:o,name:n,token:r}=t;return(!c||n.toLowerCase().includes(c.toLowerCase())||r.toLowerCase().includes(c.toLowerCase()))&&(e[o]||(e[o]=[]),e[o].push(t)),e}),{});return(0,p.jsxs)(x.Modal,{size:"medium",title:(0,_.__)("Personalization Tags","woocommerce"),onRequestClose:()=>{o(),T("personalization_tags_modal_closed",{openedBy:r})},className:"woocommerce-personalization-tags-modal",children:[(0,p.jsxs)("p",{children:[(0,_.__)("Insert personalization tags to dynamically fill in information and personalize your emails.","woocommerce")," ",(0,p.jsx)(x.ExternalLink,{href:"https://kb.mailpoet.com/article/435-a-guide-to-personalisation-tags-for-tailored-newsletters#list",onClick:()=>T("personalization_tags_modal_learn_more_link_clicked",{openedBy:r}),children:(0,_.__)("Learn more","woocommerce")})]}),(0,p.jsx)(x.SearchControl,{onChange:e=>{d(e),P("personalization_tags_modal_search_control_input_updated",{openedBy:r})},value:c}),(0,p.jsx)(b,{groupedTags:w,activeCategory:s,onCategorySelect:e=>{a(e),T("personalization_tags_modal_category_menu_clicked",{category:e,openedBy:r})}}),(0,p.jsx)(v,{groupedTags:w,activeCategory:s,onInsert:t=>{e(t),T("personalization_tags_modal_tag_insert_button_clicked",{insertedTag:t,activeCategory:s,openedBy:r})},closeCallback:o,canInsertLink:n,openLinkModal:e=>{u(e),h(!0)}})]})},F=({contentRef:e,onUpdate:t})=>{const[o,n]=(0,l.useState)(!1),[r,s]=(0,l.useState)(null),[i,a]=(0,l.useState)(""),[c,d]=(0,l.useState)("");return(0,l.useEffect)((()=>{if(!e||!e.current)return;const t=e.current,o=e=>{const t=e.target.closest("span[data-rich-text-comment]");if(t){const e=t.innerText.replace(/^\[|\]$/g,"");d(e),a(e),s(t),n(!0)}};return t.addEventListener("click",o),()=>{t.removeEventListener("click",o)}}),[e]),(0,p.jsx)(p.Fragment,{children:o&&r&&(0,p.jsx)(x.Popover,{position:"bottom right",onClose:()=>n(!1),anchor:r,className:"woocommerce-personalization-tag-popover",children:(0,p.jsxs)("div",{className:"woocommerce-personalization-tag-popover-content",children:[(0,p.jsx)(x.TextControl,{label:(0,_.__)("Personalization Tag","woocommerce"),value:i,onChange:e=>a(e),__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0}),(0,p.jsxs)("div",{className:"woocommerce-personalization-tag-popover-content-buttons",children:[(0,p.jsx)(x.Button,{isTertiary:!0,onClick:()=>{n(!1)},children:(0,_.__)("Cancel","woocommerce")}),(0,p.jsx)(x.Button,{isPrimary:!0,onClick:()=>{t(c,i),n(!1)},children:(0,_.__)("Update","woocommerce")})]})]})})})},A=({contentRef:e,onUpdate:t})=>{const[o,n]=(0,l.useState)(!1),[r,s]=(0,l.useState)(null),[a,c]=(0,l.useState)(""),[d,m]=(0,l.useState)(""),u=(0,i.useSelect)((e=>e(B).getPersonalizationTagsList()),[]);return(0,l.useEffect)((()=>{if(!e||!e.current)return;const t=e.current,o=e=>{const t=e.target.closest("a[data-link-href]");t&&(s(t),m(t.getAttribute("data-link-href")||""),c(t.textContent||""),n(!0))};return t.addEventListener("click",o),()=>{t.removeEventListener("click",o)}}),[e]),(0,p.jsx)(p.Fragment,{children:o&&r&&(0,p.jsx)(x.Popover,{position:"bottom left",onClose:()=>n(!1),anchor:r,className:"woocommerce-personalization-tag-popover",children:(0,p.jsxs)("div",{className:"woocommerce-personalization-tag-popover-content",children:[(0,p.jsx)(x.TextControl,{label:(0,_.__)("Link Text","woocommerce"),value:a,onChange:e=>c(e),__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0,autoComplete:"off"}),(0,p.jsx)(x.SelectControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,label:(0,_.__)("Link tag","woocommerce"),value:d,onChange:e=>{m(e)},options:u.filter((e=>e.category===(0,_.__)("Link","woocommerce"))).map((e=>({label:e.name,value:e.token})))}),(0,p.jsxs)("div",{className:"woocommerce-personalization-tag-popover-content-buttons",children:[(0,p.jsx)(x.Button,{isTertiary:!0,onClick:()=>{n(!1)},children:(0,_.__)("Cancel","woocommerce")}),(0,p.jsx)(x.Button,{isPrimary:!0,onClick:()=>{n(!1),t(r,d,a)},children:(0,_.__)("Update link","woocommerce")})]})]})})})};function L({contentRef:e}){const[t,o]=(0,l.useState)(!1),n=(0,i.useSelect)((e=>e("core/block-editor").getSelectedBlockClientId())),{updateBlockAttributes:r}=(0,i.useDispatch)("core/block-editor"),s=(0,i.useSelect)((e=>e("core/block-editor").getBlockAttributes(n))),a="text"in s?"text":"content",c=s?.[a]?.originalHTML||s?.[a]||"",m=(0,l.useCallback)(((t,o)=>{let{start:s,end:i}=w(e,c),l="";if(o){let e=(0,y.create)({html:c});e=(0,y.insert)(e,o,s,i),i=s+o.length,e=(0,y.applyFormat)(e,{type:"woocommerce-email-editor/link-shortcode",attributes:{"data-link-href":t,contenteditable:"false",style:"text-decoration: underline;"}},s,i),l=(0,y.toHTMLString)({value:e})}else{let e=(0,y.create)({html:c});e=(0,y.insert)(e,(0,y.create)({html:`\x3c!--${t}--\x3e&nbsp;`}),s,i),l=(0,y.toHTMLString)({value:e})}r(n,{[a]:l})}),[c,a,e,n,r]);return(0,p.jsx)(d.BlockControls,{children:(0,p.jsxs)(x.ToolbarGroup,{children:[(0,p.jsx)(x.ToolbarButton,{icon:"shortcode",title:(0,_.__)("Personalization Tags","woocommerce"),onClick:()=>{o(!0),T("block_controls_personalization_tags_button_clicked")}}),(0,p.jsx)(F,{contentRef:e,onUpdate:(e,t)=>{const o=c.replace(`\x3c!--[${e}]--\x3e`,`\x3c!--[${t}]--\x3e`);r(n,{[a]:o})}}),(0,p.jsx)(A,{contentRef:e,onUpdate:(e,t,o)=>{const s=e.getAttribute("data-link-href").replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),i=new RegExp(`<a([^>]*?)data-link-href="${s}"([^>]*?)>${e.textContent}</a>`,"gi"),l=c.replace(i,((e,n,r)=>`<a${n}data-link-href="${t}"${r}>${o}</a>`));r(n,{content:l})}}),(0,p.jsx)(z,{isOpened:t,onInsert:(e,t)=>{m(e,t),o(!1)},closeCallback:()=>o(!1),canInsertLink:!0,openedBy:"block-controls"})]})})}const R=(0,m.createHigherOrderComponent)((e=>t=>{const{attributes:o,setAttributes:n,name:r}=t,{content:s}=o,a=(0,i.useSelect)((e=>e(B).getPersonalizationTagsList()),[]),c=(0,l.useCallback)((()=>s?f(s,a):""),[s,a]),d=(0,l.useCallback)((e=>{if(void 0!==e.content){const t=f(e.content,a);n({...e,content:t})}else n(e)}),[a,n]);return"core/paragraph"===r||"core/heading"===r||"core/list-item"===r?(0,p.jsx)(e,{...t,attributes:{...o,content:c()},setAttributes:d}):(0,p.jsx)(e,{...t})}),"personalizationTagsLiveContentUpdate"),O=e=>t=>{const{setAttributes:o}=t,n=(0,l.useCallback)((e=>{e?.url&&e.url?.startsWith("http://[")&&(e.url=e.url.replace("http://[","[")),o(e)}),[o]);return(0,p.jsx)(e,{...t,setAttributes:n})},H=window.wp.blocks,V=["behance","bluesky","chain","discord","facebook","feed","github","gravatar","instagram","linkedin","mail","mastodon","medium","patreon","pinterest","reddit","spotify","telegram","threads","tiktok","tumblr","twitch","twitter","vimeo","wordpress","whatsapp","x","youtube"],D=e=>t=>{if("core/social-links"!==t.name)return(0,p.jsx)(e,{...t});const o=`\n\t\t.block-editor-tools-panel-color-gradient-settings__item:has([title="${(0,_.__)("Icon color")}"]) {\n\t\t\tdisplay: none !important;\n\t\t}\n\t\t.block-editor-tools-panel-color-gradient-settings__item:nth-child(2 of .block-editor-tools-panel-color-gradient-settings__item){\n\t\t\tborder-top:1px solid #ddd;\n\t\t\tborder-top-left-radius:2px;\n\t\t\tborder-top-right-radius:2px;\n\t\t}\n\t\t`;return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(e,{...t}),(0,p.jsx)(d.InspectorControls,{group:"color",children:(0,p.jsx)("style",{children:o})})]})},G=window.wp.privateApis,$=window.wp.editor,{unlock:W}=(0,G.__dangerousOptInToUnstableAPIsOnlyForCoreModules)("I acknowledge private features are not for use in themes or plugins and doing so will break in the next version of WordPress.","@wordpress/edit-site"),{ColorPanel:U}=W(d.privateApis),{useGlobalStylesOutputWithConfig:q}=W(d.privateApis),{Editor:Z,FullscreenMode:J,ViewMoreMenuGroup:Y,BackButton:K}=W($.privateApis),{registerEntityAction:X,unregisterEntityAction:Q}=W((0,i.dispatch)($.store)),ee=window.wp.coreData,te=window.wp.notices,oe=window.wp.primitives,ne=(0,p.jsx)(oe.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,p.jsx)(oe.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M12 5.5A2.25 2.25 0 0 0 9.878 7h4.244A2.251 2.251 0 0 0 12 5.5ZM12 4a3.751 3.751 0 0 0-3.675 3H5v1.5h1.27l.818 8.997a2.75 2.75 0 0 0 2.739 2.501h4.347a2.75 2.75 0 0 0 2.738-2.5L17.73 8.5H19V7h-3.325A3.751 3.751 0 0 0 12 4Zm4.224 4.5H7.776l.806 8.861a1.25 1.25 0 0 0 1.245 1.137h4.347a1.25 1.25 0 0 0 1.245-1.137l.805-8.861Z"})}),re=window.wp.htmlEntities,se=(0,a.applyFilters)("woocommerce_email_editor_trash_modal_should_permanently_delete",!1);function ie(e){return"string"==typeof e.title?(0,re.decodeEntities)(e.title):e.title&&"rendered"in e.title?(0,re.decodeEntities)(e.title.rendered):e.title&&"raw"in e.title?(0,re.decodeEntities)(e.title.raw):""}function le(e){return se?e.length>1?(0,_.sprintf)((0,_._n)("Are you sure you want to permanently delete %d item?","Are you sure you want to permanently delete %d items?",e.length,"woocommerce"),e.length):(0,_.sprintf)((0,_.__)('Are you sure you want to permanently delete "%s"?',"woocommerce"),(0,re.decodeEntities)(ie(e[0]))):e.length>1?(0,_.sprintf)((0,_._n)("Are you sure you want to move %d item to the trash ?","Are you sure you want to move %d items to the trash ?",e.length,"woocommerce"),e.length):(0,_.sprintf)((0,_.__)('Are you sure you want to move "%s" to the trash?',"woocommerce"),ie(e[0]))}const ae={id:"trash-email-post",label:se?(0,_.__)("Permanently delete","woocommerce"):(0,_.__)("Move to trash","woocommerce"),supportsBulk:!0,icon:ne,isEligible(e){if("wp_template"===e.type||"wp_template_part"===e.type||"wp_block"===e.type)return!1;const{permissions:t}=e;return t?.delete},hideModalHeader:!0,modalFocusOnMount:"firstContentElement",RenderModal:({items:e,closeModal:t,onActionPerformed:o})=>{const[n,r]=(0,l.useState)(!1),{createSuccessNotice:s,createErrorNotice:a}=(0,i.useDispatch)(te.store),{deleteEntityRecord:c}=(0,i.useDispatch)(ee.store),{urls:d}=(0,i.useSelect)((e=>({urls:e(B).getUrls()})),[]);return(0,p.jsxs)(x.__experimentalVStack,{spacing:"5",children:[(0,p.jsx)(x.__experimentalText,{children:le(e)}),(0,p.jsxs)(x.__experimentalHStack,{justify:"right",children:[(0,p.jsx)(x.Button,{variant:"tertiary",onClick:()=>{t?.(),T("trash_modal_cancel_button_clicked")},disabled:n,__next40pxDefaultSize:!0,children:(0,_.__)("Cancel","woocommerce")}),(0,p.jsx)(x.Button,{variant:"primary",onClick:async()=>{T("trash_modal_move_to_trash_button_clicked"),r(!0);const n=await Promise.allSettled(e.map((e=>c("postType",e.type,e.id,{force:se},{throwOnError:!0}))));if(n.every((({status:e})=>"fulfilled"===e))){let t;t=1===n.length?se?(0,_.sprintf)((0,_.__)('"%s" permanently deleted.',"woocommerce"),ie(e[0])):(0,_.sprintf)((0,_.__)('"%s" moved to the trash.',"woocommerce"),ie(e[0])):se?(0,_.__)("The items were permanently deleted.","woocommerce"):(0,_.sprintf)((0,_._n)("%s item moved to the trash.","%s items moved to the trash.",e.length,"woocommerce"),e.length),s(t,{type:"snackbar",id:"trash-email-post-action"}),o?.(e),d?.listings&&(window.location.href=d.listings)}else{let e;if(1===n.length){const t=n[0];e=t.reason?.message?t.reason.message:(0,_.__)("An error occurred while performing the action.","woocommerce")}else{const t=new Set,o=n.filter((({status:e})=>"rejected"===e));for(const e of o){const o=e;o.reason?.message&&t.add(o.reason.message)}e=0===t.size?(0,_.__)("An error occurred while performing the action.","woocommerce"):1===t.size?(0,_.sprintf)((0,_.__)("An error occurred while performing the action: %s","woocommerce"),[...t][0]):(0,_.sprintf)((0,_.__)("Some errors occurred while performing the action: %s","woocommerce"),[...t].join(","))}T("trash_modal_move_to_trash_error",{errorMessage:e}),a(e,{type:"snackbar"})}r(!1),t?.()},isBusy:n,disabled:n,__next40pxDefaultSize:!0,children:se?(0,_.__)("Delete permanently","woocommerce"):(0,_.__)("Move to trash","woocommerce")})]})]})}},ce=e=>{Q("postType",e,"move-to-trash"),X("postType",e,ae)};function de(e){var t,o,n="";if("string"==typeof e||"number"==typeof e)n+=e;else if("object"==typeof e)if(Array.isArray(e)){var r=e.length;for(t=0;t<r;t++)e[t]&&(o=de(e[t]))&&(n&&(n+=" "),n+=o)}else for(o in e)e[o]&&(n&&(n+=" "),n+=o);return n}const me=(0,p.jsx)(oe.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,p.jsx)(oe.Path,{d:"M9 9v6h11V9H9zM4 20h1.5V4H4v16z"})}),pe=(0,p.jsx)(oe.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,p.jsx)(oe.Path,{d:"M12.5 15v5H11v-5H4V9h7V4h1.5v5h7v6h-7Z"})}),ue=(0,p.jsx)(oe.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,p.jsx)(oe.Path,{d:"M4 15h11V9H4v6zM18.5 4v16H20V4h-1.5z"})}),_e="__experimentalEmailFlexLayout";function ge(e){return(0,H.hasBlockSupport)(e,_e)}function he({justificationValue:e,onChange:t,isToolbar:o=!1}){const n=[{value:"left",icon:me,label:(0,_.__)("Justify items left","woocommerce")},{value:"center",icon:pe,label:(0,_.__)("Justify items center","woocommerce")},{value:"right",icon:ue,label:(0,_.__)("Justify items right","woocommerce")}];if(o){const o=n.map((e=>e.value));return(0,p.jsx)(d.JustifyContentControl,{value:e,onChange:t,allowedControls:o,popoverProps:{placement:"bottom-start"}})}return(0,p.jsx)(x.__experimentalToggleGroupControl,{__nextHasNoMarginBottom:!0,label:(0,_.__)("Justification","woocommerce"),value:e,onChange:t,className:"block-editor-hooks__flex-layout-justification-controls",children:n.map((({value:e,icon:t,label:o})=>(0,p.jsx)(x.__experimentalToggleGroupControlOptionIcon,{value:e,icon:t,label:o},e)))})}function ye({setAttributes:e,attributes:t,name:o}){if(!(0,H.getBlockSupport)(o,_e,{}))return null;const{justifyContent:n="left"}=t.layout||{},r=o=>{e({layout:{...t.layout,justifyContent:o}})};return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(d.InspectorControls,{children:(0,p.jsx)(x.PanelBody,{title:(0,_.__)("Layout","woocommerce"),children:(0,p.jsx)(x.Flex,{children:(0,p.jsx)(x.FlexItem,{children:(0,p.jsx)(he,{justificationValue:n,onChange:r})})})})}),(0,p.jsx)(d.BlockControls,{group:"block",__experimentalShareWithChildBlocks:!0,children:(0,p.jsx)(he,{justificationValue:n,onChange:r,isToolbar:!0})})]})}function xe(e){return ge(e.name)?{...e,attributes:{...e.attributes,layout:{type:"object"}}}:e}const we=(0,m.createHigherOrderComponent)((e=>t=>[ge(t.name)&&(0,p.jsx)(ye,{...t},"layout"),(0,p.jsx)(e,{...t},"edit")]),"withLayoutControls");function fe({block:e,props:t}){const{attributes:o}=t,{layout:n}=o,r=function(){for(var e,t,o=0,n="",r=arguments.length;o<r;o++)(e=arguments[o])&&(t=de(e))&&(n&&(n+=" "),n+=t);return n}(`is-content-justification-${n?.justifyContent||"left"}`,"is-layout-email-flex is-layout-flex");return(0,p.jsx)(e,{...t,className:r})}const be=(0,m.createHigherOrderComponent)((e=>function(t){return ge(t.name)?(0,p.jsx)(fe,{block:e,props:t}):(0,p.jsx)(e,{...t})}),"withLayoutStyles"),ve=window.wp.commands;var je=o(192),ke=o.n(je);function Se(){const{globalStylePost:e}=(0,i.useSelect)((e=>({globalStylePost:e(B).getGlobalEmailStylesPost()||null})),[]),t=(0,l.useCallback)((t=>{e&&(0,i.dispatch)(ee.store).editEntityRecord("postType","wp_global_styles",e.id,{styles:t.styles,settings:t.settings})}),[e]);return{userTheme:{settings:e?.settings,styles:e?.styles},updateUserTheme:t}}function Ce(e){if("string"!=typeof e)return null;const t=e.match(/^var:preset\|([a-zA-Z0-9-]+)\|([a-zA-Z0-9-]+)$/);return t?`--wp--preset--${t[1]}--${t[2]}`:null}function Ee(e){const t=Ce(e);return t?`var(${t})`:e}function Te(e){const t=Ce(e);if(!t)return e;const o=document.querySelector(":root");return o&&getComputedStyle(o).getPropertyValue(t).trim()||e}const Pe=[];function Ne(){const{userTheme:e}=Se(),{editorTheme:t,layout:o,deviceType:n,editorSettingsStyles:r}=(0,i.useSelect)((e=>{const{getEditorSettings:t,getDeviceType:o}=e($.store),n=t();return{editorTheme:e(B).getTheme(),layout:n.__experimentalFeatures?.layout,deviceType:o(),editorSettingsStyles:n.styles}}),[]),s=(0,l.useMemo)((()=>ke().all([{},t||{},e||{}])),[t,e]),[a]=q(s);let c="";o&&"Mobile"!==n&&(c=`display:flow-root; width:${o?.contentSize}; margin: 0 auto;box-sizing: border-box;`);const d=s.styles?.spacing?.padding;return d&&(c+=`padding-left:${Ee(d.left)};`,c+=`padding-right:${Ee(d.right)};`),[(0,l.useMemo)((()=>{var e;return[...null!==(e=a)&&void 0!==e?e:[],{css:`.is-root-container{ ${c} }`},...null!=r?r:[]]}),[a,r,c])||Pe]}const Be=[];function Me(e,t){return e.map((e=>"core/post-content"===e.name?{...e,name:"core/group",innerBlocks:t}:e.innerBlocks?.length?{...e,innerBlocks:Me(e.innerBlocks,t)}:e))}const Ie={};function ze(e=""){const{templates:t,patterns:o,emailPosts:n,hasEmailPosts:r}=(0,i.useSelect)((t=>{const o="swap"!==e?t(B).getSentEmailEditorPosts():void 0;return{templates:t(B).getEmailTemplates(),patterns:t(B).getBlockPatternsForEmailTemplate(),emailPosts:o,hasEmailPosts:!(!o||!o?.length)}}),[e]),s=(0,l.useMemo)((()=>{let n=[];const r=e&&(0,H.parse)(e);if(n=r?[{blocks:r}]:o,!n||!t)return Be;const s=[];return t?.filter((e=>"email-general"!==e.slug))?.forEach((e=>{n?.forEach((t=>{let o=(0,H.parse)(e.content?.raw);o=Me(o,t.blocks),s.push({id:e.id,slug:e.slug,previewContentParsed:o,emailParsed:t.blocks,template:e,category:"basic",type:e.type,displayName:t.title?`${e.title.rendered} - ${t.title}`:e.title.rendered})}))})),s}),[t,o,e]),c=(0,l.useMemo)((()=>n?.map((e=>{const t=(0,a.applyFilters)("woocommerce_email_editor_preferred_template_title","",e),{postTemplateContent:o}=function(e,t=[]){const o=e.template,n={postTemplateContent:null};if(!o)return n;if(Ie[o])return Ie[o];const r=t.find((e=>e.slug===o));if(!r)return n;const s={postTemplateContent:r?.template};return Ie[o]=s,s}(e,s),n=(0,H.parse)(e.content?.raw);let r=n;o?.content?.raw&&(r=Me((0,H.parse)(o?.content?.raw),n));const i={...e,title:{raw:e.title.raw,rendered:t||e.title.rendered}};return{id:e.id,slug:e.slug,previewContentParsed:r,emailParsed:n,category:"recent",type:e.type,displayName:i.title.rendered,template:i}}))),[n,s]);return[s||Be,c||Be,r]}const Fe=(0,l.forwardRef)((function({icon:e,size:t=24,...o},n){return(0,l.cloneElement)(e,{width:t,height:t,...o,ref:n})})),Ae=(0,p.jsx)(oe.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,p.jsx)(oe.Path,{d:"M19 8h-1V6h-5v2h-2V6H6v2H5c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-8c0-1.1-.9-2-2-2zm.5 10c0 .3-.2.5-.5.5H5c-.3 0-.5-.2-.5-.5v-8c0-.3.2-.5.5-.5h14c.3 0 .5.2.5.5v8z"})}),Le=(0,p.jsx)(oe.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,p.jsx)(oe.Path,{d:"M12 3.2c-4.8 0-8.8 3.9-8.8 8.8 0 4.8 3.9 8.8 8.8 8.8 4.8 0 8.8-3.9 8.8-8.8 0-4.8-4-8.8-8.8-8.8zm0 16c-4 0-7.2-3.3-7.2-7.2C4.8 8 8 4.8 12 4.8s7.2 3.3 7.2 7.2c0 4-3.2 7.2-7.2 7.2zM11 17h2v-6h-2v6zm0-8h2V7h-2v2z"})}),Re=(0,window.wp.priorityQueue.createQueue)();function Oe({children:e,placeholder:t}){const[o,n]=(0,l.useState)(!1);return(0,l.useEffect)((()=>{const e={};return Re.add(e,(()=>{(0,l.flushSync)((()=>{n(!0)}))})),()=>{Re.cancel(e)}}),[]),o?e:t}function He(){return(0,p.jsxs)("div",{className:"block-editor-inserter__no-results",children:[(0,p.jsx)(Fe,{className:"block-editor-inserter__no-results-icon",icon:Ae}),(0,p.jsx)("p",{children:(0,_.__)("No recent templates.","woocommerce")}),(0,p.jsx)("p",{children:(0,_.__)("Your recent creations will appear here as soon as you begin.","woocommerce")})]})}const Ve=(0,l.memo)((function({templates:e,onTemplateSelection:t,selectedCategory:o}){const{layout:n}=(0,i.useSelect)((e=>{const{getEditorSettings:t}=e($.store);return{layout:t().__experimentalFeatures.layout}})),[r]=Ne(),s=r.reduce(((e,t)=>{var o;return e+(null!==(o=t.css)&&void 0!==o?o:"")}),"")+`.is-root-container { width: ${n.contentSize}; margin: 0 auto; }`;return"recent"===o&&0===e.length?(0,p.jsx)(He,{}):(0,p.jsx)("div",{className:"block-editor-block-patterns-list",role:"listbox",children:e.map((e=>(0,p.jsx)("div",{className:"block-editor-block-patterns-list__list-item email-editor-pattern__list-item",children:(0,p.jsx)("div",{className:"block-editor-block-patterns-list__item",role:"button",tabIndex:0,onClick:()=>{t(e)},onKeyPress:o=>{"Enter"!==o.key&&" "!==o.key||t(e)},children:(0,p.jsxs)(Oe,{placeholder:(0,p.jsx)("p",{children:(0,_.__)("rendering template","woocommerce")}),children:[(0,p.jsx)(d.BlockPreview,{blocks:e.previewContentParsed,viewportWidth:900,minHeight:300,additionalStyles:[{css:s}]}),(0,p.jsx)(x.__experimentalHStack,{className:"block-editor-patterns__pattern-details",children:(0,p.jsx)("h4",{className:"block-editor-block-patterns-list__item-title",children:e.displayName})})]})})},`${e.slug}_${e.displayName}_${e.id}`)))})}),((e,t)=>e.templates.length===t.templates.length&&e.selectedCategory===t.selectedCategory));function De({templates:e,onTemplateSelection:t,selectedCategory:o}){const n=(0,l.useMemo)((()=>e.filter((e=>e.category===o))),[o,e]);return(0,p.jsxs)("div",{className:"block-editor-block-patterns-explorer__list",children:["recent"===o&&(0,p.jsx)("div",{className:"email-editor-recent-templates-info",children:(0,p.jsxs)(x.__experimentalHStack,{spacing:1,expanded:!1,justify:"start",children:[(0,p.jsx)(Fe,{icon:Le}),(0,p.jsx)("p",{children:(0,_.__)("Templates created on the legacy editor will not appear here.","woocommerce")})]})}),(0,p.jsx)(Ve,{templates:n,onTemplateSelection:t,selectedCategory:o})]})}function Ge({selectedCategory:e,templateCategories:t,onClickCategory:o}){const n="block-editor-block-patterns-explorer__sidebar";return(0,p.jsx)("div",{className:n,children:(0,p.jsx)("div",{className:`${n}__categories-list`,children:t.map((({name:t,label:r})=>(0,p.jsx)(x.Button,{label:r,className:`${n}__categories-list__item`,isPressed:e===t,onClick:()=>{o(t)},children:r},t)))})})}const $e=[{name:"recent",label:"Recent"},{name:"basic",label:"Basic"}],We=(0,l.memo)((function({hasEmailPosts:e,templates:t,handleTemplateSelection:o,templateSelectMode:n}){const[r,s]=(0,l.useState)($e[1].name),i="swap"===n,a=$e.filter((({name:e})=>"recent"!==e||!i));return(0,l.useEffect)((()=>{setTimeout((()=>{e&&!i&&s($e[0].name)}),1e3)}),[e,i]),(0,p.jsxs)("div",{className:"block-editor-block-patterns-explorer",children:[(0,p.jsx)(Ge,{templateCategories:a,selectedCategory:r,onClickCategory:e=>{T("template_select_modal_category_change",{category:e}),s(e)}}),(0,p.jsx)(De,{templates:t,onTemplateSelection:o,selectedCategory:r})]})}));function Ue({onSelectCallback:e,closeCallback:t=null,previewContent:o=""}){const n=o?"swap":"new";P("template_select_modal_opened",{templateSelectMode:n});const[r,s,l]=ze(o),a=r?.length>0,c=t=>{const r=t.type===M,s=t.template;T("template_select_modal_template_selected",{templateSlug:t.slug,templateSelectMode:n,templateType:t.type}),o||(0,i.dispatch)($.store).resetEditorBlocks(t.emailParsed),(0,i.dispatch)(B).setTemplateToPost(r?s.template:t.slug),e()},d=()=>{var e;const t=null!==(e=r[0])&&void 0!==e?e:null;t&&(T("template_select_modal_handle_close_without_template_selected"),c(t))};return(0,p.jsxs)(x.Modal,{title:"new"===n?(0,_.__)("Start with an email preset","woocommerce"):(0,_.__)("Select a template","woocommerce"),onRequestClose:()=>(T("template_select_modal_closed",{templateSelectMode:n}),t?t():d()),isFullScreen:!0,children:[(0,p.jsx)(We,{hasEmailPosts:l,templates:[...r,...s],handleTemplateSelection:c,templateSelectMode:n}),(0,p.jsx)(x.Flex,{className:"email-editor-modal-footer",justify:"flex-end",children:(0,p.jsx)(x.FlexItem,{children:(0,p.jsx)(x.Button,{variant:"tertiary",className:"email-editor-start_from_scratch_button",onClick:()=>(T("template_select_modal_start_from_scratch_clicked"),d()),isBusy:!a,children:(0,_.__)("Start from scratch","woocommerce")})})})]})}function qe(){const[e,t]=(0,l.useState)(!1),{emailContentIsEmpty:o,emailHasEdits:n}=(0,i.useSelect)((e=>({emailContentIsEmpty:e(B).hasEmptyContent(),emailHasEdits:e(B).hasEdits()})),[]);return!o||n||e?null:(0,p.jsx)(Ue,{onSelectCallback:()=>t(!0)})}const Ze=(0,p.jsx)(oe.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,p.jsx)(oe.Path,{d:"M12 4c-4.4 0-8 3.6-8 8v.1c0 4.1 3.2 7.5 7.2 7.9h.8c4.4 0 8-3.6 8-8s-3.6-8-8-8zm0 15V5c3.9 0 7 3.1 7 7s-3.1 7-7 7z"})}),Je=(0,p.jsx)(oe.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,p.jsx)(oe.Path,{d:"M6.9 7L3 17.8h1.7l1-2.8h4.1l1 2.8h1.7L8.6 7H6.9zm-.7 6.6l1.5-4.3 1.5 4.3h-3zM21.6 17c-.1.1-.2.2-.3.2-.1.1-.2.1-.4.1s-.3-.1-.4-.2c-.1-.1-.1-.3-.1-.6V12c0-.5 0-1-.1-1.4-.1-.4-.3-.7-.5-1-.2-.2-.5-.4-.9-.5-.4 0-.8-.1-1.3-.1s-1 .1-1.4.2c-.4.1-.7.3-1 .4-.2.2-.4.3-.6.5-.1.2-.2.4-.2.7 0 .3.1.5.2.8.2.2.4.3.8.3.3 0 .6-.1.8-.3.2-.2.3-.4.3-.7 0-.3-.1-.5-.2-.7-.2-.2-.4-.3-.6-.4.2-.2.4-.3.7-.4.3-.1.6-.1.8-.1.3 0 .6 0 .8.1.2.1.4.3.5.5.1.2.2.5.2.9v1.1c0 .3-.1.5-.3.6-.2.2-.5.3-.9.4-.3.1-.7.3-1.1.4-.4.1-.8.3-1.1.5-.3.2-.6.4-.8.7-.2.3-.3.7-.3 1.2 0 .6.2 1.1.5 1.4.3.4.9.5 1.6.5.5 0 1-.1 1.4-.3.4-.2.8-.6 1.1-1.1 0 .4.1.7.3 1 .2.3.6.4 1.2.4.4 0 .7-.1.9-.2.2-.1.5-.3.7-.4h-.3zm-3-.9c-.2.4-.5.7-.8.8-.3.2-.6.2-.8.2-.4 0-.6-.1-.9-.3-.2-.2-.3-.6-.3-1.1 0-.5.1-.9.3-1.2s.5-.5.8-.7c.3-.2.7-.3 1-.5.3-.1.6-.3.7-.6v3.4z"})}),Ye=(0,p.jsx)(oe.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,p.jsx)(oe.Path,{d:"M17.2 10.9c-.5-1-1.2-2.1-2.1-3.2-.6-.9-1.3-1.7-2.1-2.6L12 4l-1 1.1c-.6.9-1.3 1.7-2 2.6-.8 1.2-1.5 2.3-2 3.2-.6 1.2-1 2.2-1 3 0 3.4 2.7 6.1 6.1 6.1s6.1-2.7 6.1-6.1c0-.8-.3-1.8-1-3zm-5.1 7.6c-2.5 0-4.6-2.1-4.6-4.6 0-.3.1-1 .8-2.3.5-.9 1.1-1.9 2-3.1.7-.9 1.3-1.7 1.8-2.3.7.8 1.3 1.6 1.8 2.3.8 1.1 1.5 2.2 2 3.1.7 1.3.8 2 .8 2.3 0 2.5-2.1 4.6-4.6 4.6z"})}),Ke=(0,p.jsx)(oe.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,p.jsx)(oe.Path,{d:"M18 5.5H6a.5.5 0 00-.5.5v3h13V6a.5.5 0 00-.5-.5zm.5 5H10v8h8a.5.5 0 00.5-.5v-7.5zm-10 0h-3V18a.5.5 0 00.5.5h2.5v-8zM6 4h12a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2z"})}),Xe={};function Qe(e){const t=e=>{if("object"==typeof e&&null!==e||void 0===e){if(Array.isArray(e)&&0===e.length)return;for(const o in e)if(e.hasOwnProperty(o)){const n=t(e[o]);void 0===n?delete e[o]:e[o]=n}}return e};return t(e)}const et=()=>{const{userTheme:e,updateUserTheme:t}=Se(),o=(0,l.useMemo)((()=>e?Qe(function(e){const t=e=>{if("object"==typeof e&&null!==e)for(const o in e)e.hasOwnProperty(o)&&(e[o]=t(e[o]));else if("string"==typeof e)return e.replace(/var\(--([a-z]+)--([a-z]+(?:--[a-z0-9]+(?:-[a-z0-9]+)*)*)--([a-z0-9-]+)\)/g,((e,t,o,n)=>`var:${o.split("--").concat(n).join("|")}`));return e};return t(e)}(e?.styles)):Xe),[e]),{styles:n}=(0,i.useSelect)((e=>({styles:e(B).getStyles()}))),r=(0,l.useCallback)((o=>{const n={...e,styles:Qe(o)};t(n)}),[t,e]),s=(0,l.useCallback)(((o,n)=>{const r=function(e,t,o){const n=Array.isArray(t)?[...t]:[t],r=Array.isArray(e)?[...e]:{...e},s=n.pop();let i=r;return n.forEach((e=>{const t=i[e];i[e]=Array.isArray(t)?[...t]:{...t},i=i[e]})),i[s]=o,r}(e,["styles",...o],n);t(r)}),[t,e]);return{styles:(0,l.useMemo)((()=>n?o?ke().all([n,o]):n:Xe),[n,o]),userStyles:e?.styles,defaultStyles:n,updateStyleProp:s,updateStyles:r}},tt={start:{scale:1,opacity:1},hover:{scale:0,opacity:0}},ot={hover:{opacity:1},start:{opacity:.5}},nt={hover:{scale:1,opacity:1},start:{scale:0,opacity:0}};function rt({label:e,isFocused:t,withHoverView:o}){const{colors:n}=(0,i.useSelect)((e=>({colors:e(B).getPaletteColors()})),[]),r=(0,l.useMemo)((()=>n.theme.concat(n.default)),[n]),{styles:s}=et(),{backgroundColor:a,headingColor:c,textColorPaletteObject:d,buttonBackgroundColorPaletteObject:m}=(0,l.useMemo)((()=>{const e=Te(s?.color?.background)||"white",t=Te(s?.color?.text)||"black",o=Te(s?.elements?.h1?.color?.text)||t,n=Te(s?.elements?.link?.color?.text)||o,i=Te(s?.elements?.button?.color?.background)||n,l=r.find((({color:e})=>e.toLowerCase()===t.toLowerCase())),a=r.find((({color:e})=>e.toLowerCase()===i.toLowerCase()));return{backgroundColor:e,headingColor:o,buttonBackgroundColor:i,textColorPaletteObject:l,buttonBackgroundColorPaletteObject:a}}),[s,r]),u=s?.elements?.heading?.typography?.fontWeight||"inherit",_=s?.elements?.heading?.typography?.fontFamily||"inherit",g=[...d?[d]:[],...m?[m]:[],...r].filter((({color:e})=>e.toLowerCase()!==a.toLowerCase())).slice(0,2),[h,y]=(0,l.useState)(!1);return(0,p.jsx)("div",{onMouseEnter:()=>y(!0),onMouseLeave:()=>y(!1),children:(0,p.jsxs)(x.__unstableMotion.div,{style:{height:152,width:"100%",background:a,cursor:o?"pointer":void 0},initial:"start",animate:(h||t)&&e?"hover":"start",children:[(0,p.jsx)(x.__unstableMotion.div,{variants:tt,style:{height:"100%",overflow:"hidden"},children:(0,p.jsxs)(x.__experimentalHStack,{spacing:10,justify:"center",style:{height:"100%",overflow:"hidden"},children:[(0,p.jsx)(x.__unstableMotion.div,{style:{fontFamily:_,fontSize:65,color:c,fontWeight:u},animate:{scale:1,opacity:1},initial:{scale:.1,opacity:0},transition:{delay:.3,type:"tween"},children:"Aa"}),(0,p.jsx)(x.__experimentalVStack,{spacing:4,children:g.map((({slug:e,color:t},o)=>(0,p.jsx)(x.__unstableMotion.div,{style:{height:32,width:32,background:t,borderRadius:16},animate:{scale:1,opacity:1},initial:{scale:.1,opacity:0},transition:{delay:1===o?.2:.1}},e)))})]})}),(0,p.jsx)(x.__unstableMotion.div,{variants:o&&ot,style:{height:"100%",width:"100%",position:"absolute",top:0,overflow:"hidden",filter:"blur(60px)",opacity:.1},children:(0,p.jsx)(x.__experimentalHStack,{spacing:0,justify:"flex-start",style:{height:"100%",overflow:"hidden"},children:r.slice(0,4).map((({color:e})=>(0,p.jsx)("div",{style:{height:"100%",background:e,flexGrow:1}},e)))})}),(0,p.jsx)(x.__unstableMotion.div,{variants:nt,style:{height:"100%",width:"100%",overflow:"hidden",position:"absolute",top:0},children:(0,p.jsx)(x.__experimentalVStack,{spacing:3,justify:"center",style:{height:"100%",overflow:"hidden",padding:10,boxSizing:"border-box"},children:e&&(0,p.jsx)("div",{style:{fontSize:40,fontFamily:_,color:c,fontWeight:u,lineHeight:"1em",textAlign:"center"},children:e})})})]})})}function st(){return(0,p.jsx)(x.Card,{size:"small",className:"edit-site-global-styles-screen-root",variant:"primary",children:(0,p.jsx)(x.CardBody,{children:(0,p.jsxs)(x.__experimentalVStack,{spacing:4,children:[(0,p.jsx)(x.Card,{children:(0,p.jsx)(x.CardMedia,{children:(0,p.jsx)(rt,{})})}),(0,p.jsxs)(x.__experimentalItemGroup,{children:[(0,p.jsx)(x.__experimentalNavigatorButton,{path:"/typography",onClick:()=>T("styles_sidebar_navigation_click",{path:"typography"}),children:(0,p.jsx)(x.__experimentalItem,{children:(0,p.jsxs)(x.__experimentalHStack,{justify:"flex-start",children:[(0,p.jsx)(x.Icon,{icon:Je,size:24}),(0,p.jsx)(x.FlexItem,{children:(0,_.__)("Typography","woocommerce")})]})})}),(0,p.jsx)(x.__experimentalNavigatorButton,{path:"/colors",onClick:()=>T("styles_sidebar_navigation_click",{path:"colors"}),children:(0,p.jsx)(x.__experimentalItem,{children:(0,p.jsxs)(x.__experimentalHStack,{justify:"flex-start",children:[(0,p.jsx)(x.Icon,{icon:Ye,size:24}),(0,p.jsx)(x.FlexItem,{children:(0,_.__)("Colors","woocommerce")})]})})}),(0,p.jsx)(x.__experimentalNavigatorButton,{path:"/layout",onClick:()=>T("styles_sidebar_navigation_click",{path:"layout"}),children:(0,p.jsx)(x.__experimentalItem,{children:(0,p.jsxs)(x.__experimentalHStack,{justify:"flex-start",children:[(0,p.jsx)(x.Icon,{icon:Ke,size:24}),(0,p.jsx)(x.FlexItem,{children:(0,_.__)("Layout","woocommerce")})]})})})]})]})})})}const it={typography:{},color:{}},lt=(e,t,o="heading",n=!1)=>{switch(t){case"text":return{typography:e.typography,color:e.color};case"heading":return((e,t="heading",o=!1)=>o?ke().all([it,e.elements.heading||{},e.elements[t]||{}]):{...it,...e.elements.heading||{},...e.elements[t]||{}})(e,null!=o?o:"heading",n);default:return e.elements[t]||it}};function at({element:e,label:t}){const{styles:o}=et(),n=lt(o,e,null,!0),{fontFamily:r,fontStyle:s,fontWeight:i,letterSpacing:l,textDecoration:a,textTransform:c}=n.typography,d=n.color?.text||"inherit",m=n.color?.background||"#f0f0f0",u=(0,_.sprintf)((0,_.__)("Typography %s styles","woocommerce"),t);return(0,p.jsx)(x.__experimentalItem,{children:(0,p.jsx)(x.__experimentalNavigatorButton,{path:`/typography/${e}`,"aria-label":u,onClick:()=>T("styles_sidebar_screen_typography_button_click",{element:e,label:t,path:`typography/${e}`}),children:(0,p.jsxs)(x.__experimentalHStack,{justify:"flex-start",children:[(0,p.jsx)(x.FlexItem,{className:"edit-site-global-styles-screen-typography__indicator",style:{fontFamily:null!=r?r:"serif",background:m,color:d,fontStyle:null!=s?s:"normal",fontWeight:null!=i?i:"normal",letterSpacing:null!=l?l:"normal",textDecoration:null!=a?a:"link"===e?"underline":"none",textTransform:null!=c?c:"none"},children:"Aa"}),(0,p.jsx)(x.FlexItem,{children:t})]})})})}const ct=function(){return(0,p.jsx)(x.Card,{size:"small",variant:"primary",isBorderless:!0,children:(0,p.jsx)(x.CardBody,{children:(0,p.jsxs)(x.__experimentalVStack,{spacing:3,children:[(0,p.jsx)(x.__experimentalHeading,{level:3,className:"edit-site-global-styles-subtitle",children:(0,_.__)("Elements","woocommerce")}),(0,p.jsxs)(x.__experimentalItemGroup,{isBordered:!0,isSeparated:!0,size:"small",children:[(0,p.jsx)(at,{element:"text",label:(0,_.__)("Text","woocommerce")}),(0,p.jsx)(at,{element:"link",label:(0,_.__)("Links","woocommerce")}),(0,p.jsx)(at,{element:"heading",label:(0,_.__)("Headings","woocommerce")}),(0,p.jsx)(at,{element:"button",label:(0,_.__)("Buttons","woocommerce")})]})]})})})},dt=(0,p.jsx)(oe.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,p.jsx)(oe.Path,{d:"M14.6 7l-1.2-1L8 12l5.4 6 1.2-1-4.6-5z"})}),mt=x.Navigator||x.__experimentalNavigatorProvider;function pt({title:e,description:t,onBack:o}){return(0,p.jsxs)(x.__experimentalVStack,{spacing:0,children:[(0,p.jsx)(x.__experimentalView,{children:(0,p.jsx)(x.__experimentalSpacer,{marginBottom:0,paddingX:4,paddingY:3,children:(0,p.jsxs)(x.__experimentalHStack,{spacing:2,children:[(0,p.jsx)(mt.BackButton,{style:{minWidth:24,padding:0},icon:dt,size:"small","aria-label":(0,_.__)("Navigate to the previous view","woocommerce"),onClick:o}),(0,p.jsx)(x.__experimentalSpacer,{children:(0,p.jsx)(x.__experimentalHeading,{className:"woocommerce-email-editor-styles-header",level:2,size:13,children:e})})]})})}),t&&(0,p.jsx)("p",{className:"woocommerce-email-editor-styles-header-description",children:t})]})}x.Navigator||(mt.Screen=x.__experimentalNavigatorScreen,mt.BackButton=x.__experimentalNavigatorBackButton);const ut=pt;function _t(){return P("styles_sidebar_screen_typography_opened"),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(ut,{title:(0,_.__)("Typography","woocommerce"),description:(0,_.__)("Manage the typography settings for different elements.","woocommerce")}),(0,p.jsx)(ct,{})]})}const gt={fontFamily:!0,fontSize:!0,fontAppearance:!0,lineHeight:!0,letterSpacing:!1,textTransform:!1,textDecoration:!1,writingMode:!0,textColumns:!0},ht=function({element:e,headingLevel:t,defaultControls:o=gt}){const[n,r]=(0,d.useSettings)("typography.fontSizes","typography.fontFamilies"),s=r?.default||[],{styles:i,defaultStyles:a,updateStyleProp:c}=et(),m=lt(i,e,t),u=lt(a,e,t),{fontFamily:g,fontSize:h,fontStyle:y,fontWeight:w,lineHeight:f,letterSpacing:b,textDecoration:v,textTransform:j}=m.typography,{fontFamily:k,fontSize:S,fontStyle:C,fontWeight:E,lineHeight:P,letterSpacing:B,textDecoration:M,textTransform:I}=u.typography,z="heading"!==e||"heading"!==t,F=(0,l.useCallback)(((o,n)=>{c("heading"===e?["elements",t,...o]:"text"===e?[...o]:["elements",e,...o],n)}),[e,c,t]),A=t=>{F(["typography","letterSpacing"],t),N("styles_sidebar_screen_typography_element_panel_set_letter_spacing",{element:e,newValue:t,selectedDefaultLetterSpacing:t===B})},L=t=>{F(["typography","lineHeight"],t),N("styles_sidebar_screen_typography_element_panel_set_line_height",{element:e,newValue:t,selectedDefaultLineHeight:t===P})},R=o=>{F(["typography","fontSize"],o),N("styles_sidebar_screen_typography_element_panel_set_font_size",{element:e,headingLevel:t,newValue:o,selectedDefaultFontSize:o===S})},O=t=>{F(["typography","fontFamily"],t),N("styles_sidebar_screen_typography_element_panel_set_font_family",{element:e,newValue:t,selectedDefaultFontFamily:t===k})},H=t=>{F(["typography","textDecoration"],t),N("styles_sidebar_screen_typography_element_panel_set_text_decoration",{element:e,newValue:t,selectedDefaultTextDecoration:t===M})},V=t=>{F(["typography","textTransform"],t),N("styles_sidebar_screen_typography_element_panel_set_text_transform",{element:e,newValue:t,selectedDefaultTextTransform:t===I})},D=({fontStyle:t,fontWeight:o})=>{F(["typography","fontStyle"],t),F(["typography","fontWeight"],o),N("styles_sidebar_screen_typography_element_panel_set_font_appearance",{element:e,newFontStyle:t,newFontWeight:o,selectedDefaultFontStyle:t===C,selectedDefaultFontWeight:o===E})};return(0,p.jsxs)(x.__experimentalToolsPanel,{label:(0,_.__)("Typography","woocommerce"),resetAll:()=>{F(["typography"],u.typography),T("styles_sidebar_screen_typography_element_panel_reset_all_styles_selected",{element:e,headingLevel:t})},children:[(0,p.jsx)(x.__experimentalToolsPanelItem,{label:(0,_.__)("Font family","woocommerce"),hasValue:()=>g!==k,onDeselect:()=>O(k),isShownByDefault:o.fontFamily,children:(0,p.jsx)(d.__experimentalFontFamilyControl,{value:g,onChange:O,size:"__unstable-large",fontFamilies:s,__nextHasNoMarginBottom:!0})}),z&&(0,p.jsx)(x.__experimentalToolsPanelItem,{label:(0,_.__)("Font size","woocommerce"),hasValue:()=>h!==S,onDeselect:()=>R(S),isShownByDefault:o.fontSize,children:(0,p.jsx)(x.FontSizePicker,{value:h,onChange:R,fontSizes:n,disableCustomFontSizes:!1,withReset:!1,withSlider:!0,size:"__unstable-large",__nextHasNoMarginBottom:!0})}),(0,p.jsx)(x.__experimentalToolsPanelItem,{className:"single-column",label:(0,_.__)("Appearance","woocommerce"),hasValue:()=>w!==E||y!==C,onDeselect:()=>{D({fontStyle:C,fontWeight:E})},isShownByDefault:o.fontAppearance,children:(0,p.jsx)(d.__experimentalFontAppearanceControl,{value:{fontStyle:y,fontWeight:w},onChange:D,hasFontStyles:!0,hasFontWeights:!0,size:"__unstable-large"})}),(0,p.jsx)(x.__experimentalToolsPanelItem,{className:"single-column",label:(0,_.__)("Line height","woocommerce"),hasValue:()=>f!==P,onDeselect:()=>L(P),isShownByDefault:o.lineHeight,children:(0,p.jsx)(d.LineHeightControl,{__nextHasNoMarginBottom:!0,__unstableInputWidth:"auto",value:f,onChange:L,size:"__unstable-large"})}),(0,p.jsx)(x.__experimentalToolsPanelItem,{className:"single-column",label:(0,_.__)("Letter spacing","woocommerce"),hasValue:()=>b!==B,onDeselect:()=>A(B),isShownByDefault:o.letterSpacing,children:(0,p.jsx)(d.__experimentalLetterSpacingControl,{value:b,onChange:A,size:"__unstable-large",__unstableInputWidth:"auto"})}),(0,p.jsx)(x.__experimentalToolsPanelItem,{className:"single-column",label:(0,_.__)("Text decoration","woocommerce"),hasValue:()=>v!==M,onDeselect:()=>H(M),isShownByDefault:o.textDecoration,children:(0,p.jsx)(d.__experimentalTextDecorationControl,{value:v,onChange:H,size:"__unstable-large",__unstableInputWidth:"auto"})}),(0,p.jsx)(x.__experimentalToolsPanelItem,{label:(0,_.__)("Letter case","woocommerce"),hasValue:()=>j!==I,onDeselect:()=>V(I),isShownByDefault:o.textTransform,children:(0,p.jsx)(d.__experimentalTextTransformControl,{value:j,onChange:V,showNone:!0,isBlock:!0,size:"__unstable-large",__nextHasNoMarginBottom:!0})})]})};function yt({element:e,headingLevel:t}){const{styles:o}=et(),n=lt(o,e,t,!0),{fontFamily:r,fontSize:s,fontStyle:i,fontWeight:l,lineHeight:a,letterSpacing:c,textDecoration:d,textTransform:m}=n.typography,u=n.color?.text||"inherit",_=n.color?.background||"#f0f0f0",g="link"===e?{textDecoration:null!=d?d:"underline"}:{};return(0,p.jsx)("div",{className:"edit-site-typography-preview",style:{fontFamily:null!=r?r:"serif",background:_,color:u,lineHeight:a,fontSize:s,fontStyle:i,fontWeight:l,letterSpacing:c,textDecoration:d,textTransform:m,...g},children:"Aa"})}const xt={text:{title:(0,_.__)("Text","woocommerce"),description:(0,_.__)("Manage the fonts and typography used on text.","woocommerce"),defaultControls:gt},link:{title:(0,_.__)("Links","woocommerce"),description:(0,_.__)("Manage the fonts and typography used on links.","woocommerce"),defaultControls:{...gt,textDecoration:!0}},heading:{title:(0,_.__)("Headings","woocommerce"),description:(0,_.__)("Manage the fonts and typography used on headings.","woocommerce"),defaultControls:{...gt,textTransform:!0}},button:{title:(0,_.__)("Buttons","woocommerce"),description:(0,_.__)("Manage the fonts and typography used on buttons.","woocommerce"),defaultControls:gt}};function wt({element:e}){P("styles_sidebar_screen_typography_element_opened",{element:e});const[t,o]=(0,l.useState)("heading");return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(ut,{title:xt[e].title,description:xt[e].description}),(0,p.jsx)(x.__experimentalSpacer,{marginX:4,children:(0,p.jsx)(yt,{element:e,headingLevel:t})}),"heading"===e&&(0,p.jsx)(x.__experimentalSpacer,{marginX:4,marginBottom:"1em",children:(0,p.jsxs)(x.__experimentalToggleGroupControl,{label:(0,_.__)("Select heading level","woocommerce"),hideLabelFromVision:!0,value:t,onChange:e=>{o(e.toString()),T("styles_sidebar_screen_typography_element_heading_level_selected",{value:e})},isBlock:!0,size:"__unstable-large",__nextHasNoMarginBottom:!0,children:[(0,p.jsx)(x.__experimentalToggleGroupControlOption,{value:"heading",label:(0,_._x)("All","heading levels","woocommerce")}),(0,p.jsx)(x.__experimentalToggleGroupControlOption,{value:"h1",label:(0,_._x)("H1","Heading Level","woocommerce")}),(0,p.jsx)(x.__experimentalToggleGroupControlOption,{value:"h2",label:(0,_._x)("H2","Heading Level","woocommerce")}),(0,p.jsx)(x.__experimentalToggleGroupControlOption,{value:"h3",label:(0,_._x)("H3","Heading Level","woocommerce")}),(0,p.jsx)(x.__experimentalToggleGroupControlOption,{value:"h4",label:(0,_._x)("H4","Heading Level","woocommerce")}),(0,p.jsx)(x.__experimentalToggleGroupControlOption,{value:"h5",label:(0,_._x)("H5","Heading Level","woocommerce")}),(0,p.jsx)(x.__experimentalToggleGroupControlOption,{value:"h6",label:(0,_._x)("H6","Heading Level","woocommerce")})]})}),(0,p.jsx)(ht,{element:e,headingLevel:t,defaultControls:xt[e].defaultControls})]})}function ft(){P("styles_sidebar_screen_colors_opened");const{userStyles:e,styles:t,updateStyles:o}=et(),n=(0,i.useSelect)((e=>e(B).getTheme()),[]);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(ut,{title:(0,_.__)("Colors","woocommerce"),description:(0,_.__)("Manage palettes and the default color of different global elements.","woocommerce")}),(0,p.jsx)(U,{value:e,inheritedValue:t,onChange:e=>{o(e),T("styles_sidebar_screen_colors_styles_updated")},settings:n?.settings,panelId:"colors"})]})}function bt(){const[e]=(0,d.useSettings)("spacing.units"),t=(0,x.__experimentalUseCustomUnits)({availableUnits:e}),{styles:o,defaultStyles:n,updateStyleProp:r}=et();return(0,p.jsxs)(x.__experimentalToolsPanel,{label:(0,_.__)("Dimensions","woocommerce"),resetAll:()=>{r(["spacing"],n.spacing),T("styles_sidebar_screen_layout_dimensions_reset_all_selected")},children:[(0,p.jsx)(x.__experimentalToolsPanelItem,{isShownByDefault:!0,hasValue:()=>!(0,k.isEqual)(o.spacing.padding,n.spacing.padding),label:(0,_.__)("Padding","woocommerce"),onDeselect:()=>{r(["spacing","padding"],n.spacing.padding),T("styles_sidebar_screen_layout_dimensions_padding_reset_clicked")},className:"tools-panel-item-spacing",children:(0,p.jsx)(d.__experimentalSpacingSizesControl,{allowReset:!0,values:o.spacing.padding,onChange:e=>{r(["spacing","padding"],e),N("styles_sidebar_screen_layout_dimensions_padding_updated",{value:e})},label:(0,_.__)("Padding","woocommerce"),sides:["horizontal","vertical","top","left","right","bottom"],units:t})}),(0,p.jsx)(x.__experimentalToolsPanelItem,{isShownByDefault:!0,label:(0,_.__)("Block spacing","woocommerce"),hasValue:()=>o.spacing.blockGap!==n.spacing.blockGap,onDeselect:()=>{r(["spacing","blockGap"],n.spacing.blockGap),T("styles_sidebar_screen_layout_dimensions_block_spacing_reset_clicked")},className:"tools-panel-item-spacing",children:(0,p.jsx)(d.__experimentalSpacingSizesControl,{label:(0,_.__)("Block spacing","woocommerce"),min:0,onChange:e=>{r(["spacing","blockGap"],e.top),N("styles_sidebar_screen_layout_dimensions_block_spacing_updated",{value:e})},showSideInLabel:!1,sides:["top"],values:{top:o.spacing.blockGap},allowReset:!0})})]})}function vt(){return P("styles_sidebar_screen_layout_opened"),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(pt,{title:(0,_.__)("Layout","woocommerce")}),(0,p.jsx)(bt,{})]})}const jt=(0,l.memo)((function(){const{userCanEditGlobalStyles:e}=(0,i.useSelect)((e=>{const{canEdit:t}=e(B).canUserEditGlobalEmailStyles();return{userCanEditGlobalStyles:t}}),[]);return e&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)($.PluginSidebarMoreMenuItem,{target:"email-styles-sidebar",icon:Ze,children:(0,_.__)("Email styles","woocommerce")}),(0,p.jsx)($.PluginSidebar,{name:"email-styles-sidebar",icon:Ze,title:(0,_.__)("Styles","woocommerce"),className:"woocommerce-email-editor-styles-panel",header:(0,_.__)("Styles","woocommerce"),children:(0,p.jsxs)(mt,{initialPath:"/",children:[(0,p.jsx)(mt.Screen,{path:"/",children:(0,p.jsx)(st,{})}),(0,p.jsx)(mt.Screen,{path:"/typography",children:(0,p.jsx)(_t,{})}),(0,p.jsx)(mt.Screen,{path:"/typography/text",children:(0,p.jsx)(wt,{element:"text"})}),(0,p.jsx)(mt.Screen,{path:"/typography/link",children:(0,p.jsx)(wt,{element:"link"})}),(0,p.jsx)(mt.Screen,{path:"/typography/heading",children:(0,p.jsx)(wt,{element:"heading"})}),(0,p.jsx)(mt.Screen,{path:"/typography/button",children:(0,p.jsx)(wt,{element:"button"})}),(0,p.jsx)(mt.Screen,{path:"/colors",children:(0,p.jsx)(ft,{})}),(0,p.jsx)(mt.Screen,{path:"/layout",children:(0,p.jsx)(vt,{})})]})})]})})),kt=(0,p.jsx)(oe.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,p.jsx)(oe.Path,{d:"M19.5 4.5h-7V6h4.44l-5.97 5.97 1.06 1.06L18 7.06v4.44h1.5v-7Zm-13 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2v-3H17v3a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h3V5.5h-3Z"})}),St=(0,p.jsx)(oe.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,p.jsx)(oe.Path,{d:"M16.7 7.1l-6.3 8.5-3.3-2.5-.9 1.2 4.5 3.4L17.9 8z"})}),Ct=window.wp.keycodes,Et=window.wp.url;let Tt=function(e){return e.SUCCESS="success",e.ERROR="error",e}({});const Pt=(0,a.applyFilters)("woocommerce_email_editor_check_sending_method_configuration_link",`https://www.mailpoet.com/blog/mailpoet-smtp-plugin/?utm_source=woocommerce_email_editor&utm_medium=plugin&utm_source_platform=${M}`),Nt=(0,l.memo)((function(){const e=(0,l.useRef)(null),{requestSendingNewsletterPreview:t,togglePreviewModal:o,updateSendPreviewEmail:n}=(0,i.useDispatch)(B),{toEmail:r,isSendingPreviewEmail:s,sendingPreviewStatus:a,isModalOpened:c,errorMessage:d}=(0,i.useSelect)((e=>e(B).getPreviewState()),[]),m=()=>{t(r)},u=()=>{T("send_preview_email_modal_closed"),o(!1)};return(0,l.useEffect)((()=>{c&&(e.current?.focus(),T("send_preview_email_modal_opened"))}),[c]),c?(0,p.jsxs)(x.Modal,{className:"woocommerce-send-preview-email",title:(0,_.__)("Send a test email","woocommerce"),onRequestClose:u,focusOnMount:!1,children:[a===Tt.ERROR?(0,p.jsxs)("div",{className:"woocommerce-send-preview-modal-notice-error",children:[(0,p.jsx)("p",{children:(0,_.__)("Sorry, we were unable to send this email.","woocommerce")}),(0,p.jsx)("strong",{children:d&&(0,_.sprintf)((0,_.__)("Error: %s","woocommerce"),d)}),(0,p.jsxs)("ul",{children:[(0,p.jsx)("li",{children:Pt&&(0,l.createInterpolateElement)((0,_.__)("Please check your <link>sending method configuration</link> with your hosting provider.","woocommerce"),{link:(0,p.jsx)("a",{href:Pt,target:"_blank",rel:"noopener noreferrer",onClick:()=>T("send_preview_email_modal_check_sending_method_configuration_link_clicked")})})}),(0,p.jsx)("li",{children:(0,l.createInterpolateElement)((0,_.__)("Or, sign up for MailPoet Sending Service to easily send emails. <link>Sign up for free</link>","woocommerce"),{link:(0,p.jsx)("a",{href:`https://account.mailpoet.com/?s=1&g=1&utm_source=woocommerce_email_editor&utm_medium=plugin&utm_source_platform=${M}`,target:"_blank",rel:"noopener noreferrer",onClick:()=>T("send_preview_email_modal_sign_up_for_mailpoet_sending_service_link_clicked")},"sign-up-for-free")})})]})]}):null,(0,p.jsx)("p",{children:(0,_.__)("Send yourself a test email to test how your email would look like in different email apps.","woocommerce")}),(0,p.jsx)(x.TextControl,{label:(0,_.__)("Send to","woocommerce"),onChange:e=>{n(e),P("send_preview_email_modal_send_to_field_updated")},onKeyDown:e=>{const{keyCode:t}=e;t===Ct.ENTER&&(e.preventDefault(),m(),T("send_preview_email_modal_send_to_field_key_code_enter"))},className:"woocommerce-send-preview-email__send-to-field",value:r,type:"email",ref:e,required:!0,__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0}),a===Tt.SUCCESS?(0,p.jsxs)("p",{className:"woocommerce-send-preview-modal-notice-success",children:[(0,p.jsx)(Fe,{icon:St,style:{fill:"#4AB866"}}),(0,_.__)("Test email sent successfully!","woocommerce")]}):null,(0,p.jsxs)("div",{className:"woocommerce-send-preview-modal-footer",children:[(0,p.jsx)(x.Button,{variant:"tertiary",onClick:()=>{T("send_preview_email_modal_close_button_clicked"),u()},children:(0,_.__)("Cancel","woocommerce")}),(0,p.jsx)(x.Button,{variant:"primary",onClick:()=>{m(),T("send_preview_email_modal_send_test_email_button_clicked")},disabled:s||!(0,Et.isEmail)(r),children:s?(0,_.__)("Sending…","woocommerce"):(0,_.__)("Send test email","woocommerce")})]})]}):null}));function Bt(){const{togglePreviewModal:e}=(0,i.useDispatch)(B);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)($.PluginPreviewMenuItem,{icon:kt,onClick:()=>{T("header_preview_dropdown_send_test_email_selected"),e(!0)},children:(0,_.__)("Send a test email","woocommerce")}),(0,p.jsx)(Nt,{})]})}const Mt=window.wp.preferences,It=()=>{const e=(0,m.useViewportMatch)("large");return(0,p.jsx)(p.Fragment,{children:e&&(0,p.jsx)(Y,{children:(0,p.jsx)(Mt.PreferenceToggleMenuItem,{scope:B,name:"fullscreenMode",label:(0,_.__)("Fullscreen mode","woocommerce"),info:(0,_.__)("Show and hide the admin user interface","woocommerce"),messageActivated:(0,_.__)("Fullscreen mode activated.","woocommerce"),messageDeactivated:(0,_.__)("Fullscreen mode deactivated.","woocommerce"),shortcut:Ct.displayShortcut.secondary("f")})})})};function zt({close:e}){P("edit_template_modal_opened");const{onNavigateToEntityRecord:t,template:o}=(0,i.useSelect)((e=>{const{getEditorSettings:t}=e($.store);return{onNavigateToEntityRecord:t().onNavigateToEntityRecord,template:e(B).getCurrentTemplate()}}),[]);return(0,p.jsxs)(x.Modal,{size:"medium",onRequestClose:e,__experimentalHideHeader:!0,children:[(0,p.jsx)("p",{children:(0,_.__)("This template is used by multiple emails. Any changes made would affect other emails on the site. Are you sure you want to edit the template?","woocommerce")}),(0,p.jsxs)(x.Flex,{justify:"end",children:[(0,p.jsx)(x.FlexItem,{children:(0,p.jsx)(x.Button,{variant:"tertiary",onClick:()=>{T("edit_template_modal_cancel_button_clicked"),e()},children:(0,_.__)("Cancel","woocommerce")})}),(0,p.jsx)(x.FlexItem,{children:(0,p.jsx)(x.Button,{variant:"primary",onClick:()=>{T("edit_template_modal_continue_button_clicked",{templateId:o.id}),t({postId:o.id,postType:"wp_template"})},disabled:!o.id,children:(0,_.__)("Edit template","woocommerce")})})]})]})}function Ft(){const{template:e,currentEmailContent:t,canUpdateTemplates:o}=(0,i.useSelect)((e=>({template:e(B).getCurrentTemplate(),currentEmailContent:e(B).getEditedEmailContent(),canUpdateTemplates:e(B).canUserEditTemplates()})),[]),[n]=ze("swap"),[r,s]=(0,l.useState)(!1),[a,c]=(0,l.useState)(!1);return(0,p.jsxs)(p.Fragment,{children:[e&&(0,p.jsx)(x.PanelRow,{children:(0,p.jsxs)(x.Flex,{justify:"start",children:[(0,p.jsx)(x.FlexItem,{className:"editor-post-panel__row-label",children:(0,_.__)("Template","woocommerce")}),(0,p.jsxs)(x.FlexItem,{children:[!(n?.length>1||o)&&(0,p.jsx)("b",{children:e?.title}),(n?.length>1||o)&&(0,p.jsx)(x.DropdownMenu,{icon:null,text:e?.title,toggleProps:{variant:"tertiary"},label:(0,_.__)("Template actions","woocommerce"),onToggle:t=>T("sidebar_template_actions_clicked",{currentTemplate:e?.title,isOpen:t}),children:({onClose:e})=>(0,p.jsxs)(p.Fragment,{children:[o&&(0,p.jsx)(x.MenuItem,{onClick:()=>{T("sidebar_template_actions_edit_template_clicked"),s(!0),e()},children:(0,_.__)("Edit template","woocommerce")}),n?.length>1&&(0,p.jsx)(x.MenuItem,{onClick:()=>{T("sidebar_template_actions_swap_template_clicked"),c(!0),e()},children:(0,_.__)("Swap template","woocommerce")})]})})]})]})}),r&&(0,p.jsx)(zt,{close:()=>(T("edit_template_modal_closed"),s(!1))}),a&&(0,p.jsx)(Ue,{onSelectCallback:()=>c(!1),closeCallback:()=>c(!1),previewContent:t})]})}const At={recordEvent:T,recordEventOnce:P,debouncedRecordEvent:N},Lt=(0,a.applyFilters)("woocommerce_email_editor_setting_sidebar_extension_component",(function({label:e,labelSuffix:t,help:o,placeholder:n,attributeName:r,attributeValue:s,updateProperty:a=()=>{}}){const[c,m]=(0,l.useState)(null),[u,g]=(0,l.useState)(!1),h=(0,i.useSelect)((e=>e(B).getPersonalizationTagsList()),[]),b=(0,l.useRef)(null),v=(0,l.useCallback)(((e,t,o)=>{var n,s;const i=null!==(n=o?.start)&&void 0!==n?n:t.length,l=null!==(s=o?.end)&&void 0!==s?s:t.length;let c=(0,y.create)({html:t});c=(0,y.insert)(c,(0,y.create)({html:`\x3c!--${e}--\x3e`}),i,l);const d=(0,y.toHTMLString)({value:c});a(r,d),m(null)}),[r,a]),j=(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("span",{children:e}),(0,p.jsx)(x.Button,{className:"woocommerce-settings-panel-personalization-tags-button",icon:"shortcode",title:(0,_.__)("Personalization Tags","woocommerce"),onClick:()=>{g(!0),T("rich_text_with_button_personalization_tags_shortcode_icon_clicked",{attributeName:r,label:e})}}),t]});return r?(0,p.jsxs)(x.BaseControl,{id:"",label:j,className:`woocommerce-settings-panel-${r}-text`,help:o,__nextHasNoMarginBottom:!0,children:[(0,p.jsx)(z,{isOpened:u,onInsert:e=>{v(e,null!=s?s:"",c),g(!1),T("rich_text_with_button_personalization_tags_inserted",{attributeName:r,value:e})},closeCallback:()=>g(!1),openedBy:"RichTextWithButton-BaseControl"}),(0,p.jsx)(F,{contentRef:b,onUpdate:(e,t)=>{const o=(null!=s?s:"").replace(`\x3c!--[${e}]--\x3e`,`\x3c!--[${t}]--\x3e`);a(r,o)}}),(0,p.jsx)(d.RichText,{ref:b,className:"woocommerce-settings-panel-richtext",placeholder:n,onFocus:()=>{m(w(b,null!=s?s:""))},onKeyUp:()=>{m(w(b,null!=s?s:""))},onClick:()=>{m(w(b,null!=s?s:""))},onChange:e=>{var t;e=f(null!==(t=e)&&void 0!==t?t:"",h),a(r,e),P("rich_text_with_button_input_field_updated",{attributeName:r})},value:null!=s?s:"","data-automation-id":`email_${r}`})]}):null}),At),Rt=(0,a.applyFilters)("woocommerce_email_editor_setting_sidebar_email_status_component",(()=>null),At);function Ot(){return(0,p.jsxs)($.PluginDocumentSettingPanel,{name:"email-settings-panel",title:(0,_.__)("Settings","woocommerce"),className:"woocommerce-email-editor__settings-panel",children:[(0,p.jsx)(Rt,{}),(0,p.jsx)(Ft,{}),(0,p.jsx)($.ErrorBoundary,{canCopyContent:!0,children:(0,p.jsx)(Lt,{})})]})}const Ht={recordEvent:T,recordEventOnce:P,debouncedRecordEvent:N};function Vt(){const e=(0,a.applyFilters)("woocommerce_email_editor_template_sections",[],Ht);return 0===e.length?null:(0,p.jsx)($.PluginDocumentSettingPanel,{name:"template-settings-panel",title:(0,_.__)("Settings","woocommerce"),className:"woocommerce-email-editor__settings-panel",children:e.map((e=>(0,p.jsx)($.ErrorBoundary,{children:(0,p.jsx)("div",{children:e.render()},e.id)},`error-boundary-${e.id}`)))})}function Dt(){const{isDirty:e}=(0,$.useEntitiesSavedStatesIsDirty)(),{hasEmptyContent:t,isEmailSent:o,urls:n}=(0,i.useSelect)((e=>({hasEmptyContent:e(B).hasEmptyContent(),isEmailSent:e(B).isEmailSent(),urls:e(B).getUrls()})),[]);function r(){n.send&&(window.location.href=n.send)}const s=t||o||e,l=(0,a.applyFilters)("woocommerce_email_editor_send_button_label",(0,_.__)("Send","woocommerce"));return(0,p.jsx)(x.Button,{variant:"primary",size:"compact",onClick:()=>{T("header_send_button_clicked"),(0,a.applyFilters)("woocommerce_email_editor_send_action_callback",r)()},disabled:s,"data-automation-id":"email_editor_send_button",children:l})}function Gt({children:e}){const t=(0,l.useRef)(document.createElement("div"));return(0,l.useEffect)((()=>{const e=document.getElementsByClassName("editor-post-publish-button__button")[0];e&&e.parentNode?.insertBefore(t.current,e.nextSibling)}),[t]),(0,l.createPortal)((0,p.jsx)(p.Fragment,{children:e}),t.current)}function $t(){const e=(0,l.useRef)(null),{hasNonPostEntityChanges:t,isEditedPostDirty:o}=(0,i.useSelect)((e=>({hasNonPostEntityChanges:e($.store).hasNonPostEntityChanges(),isEditedPostDirty:e($.store).isEditedPostDirty()})),[]),n=t||o,r=(0,l.useCallback)(((e,t)=>{t&&e.classList.contains("force-hidden")&&e.classList.remove("force-hidden"),t||e.classList.contains("force-hidden")||e.classList.add("force-hidden")}),[]);return(0,l.useEffect)((()=>{const t=document.getElementsByClassName("editor-post-publish-button__button")[0];return r(t,n),t?(e.current&&e.current.disconnect(),e.current=new MutationObserver((()=>{r(t,n)})),e.current.observe(t,{attributes:!0,childList:!0,subtree:!1}),()=>e.current?.disconnect()):()=>e.current?.disconnect()}),[n,r]),(0,p.jsx)(Gt,{children:!n&&(0,p.jsx)(Dt,{})})}const Wt=()=>{const e="email-validation",t=(0,i.useSelect)((t=>t(te.store).getNotices(e)));return{notices:t,hasValidationNotice:(0,l.useCallback)((e=>e?void 0!==t.find((t=>t.id===e)):t?.length>0),[t]),addValidationNotice:(0,l.useCallback)(((t,o,n=[])=>{(0,i.dispatch)(te.store).createNotice("error",o,{id:t,isDismissible:!1,actions:n,context:e})}),[e]),removeValidationNotice:(0,l.useCallback)((t=>{(0,i.dispatch)(te.store).removeNotice(t,e)}),[e])}};function Ut(){const{notices:e}=Wt();return 0===e.length?null:(0,p.jsx)(x.Notice,{status:"error",className:"woocommerce-email-editor-validation-errors components-editor-notices__pinned",isDismissible:!1,children:(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("strong",{children:(0,_.__)("Fix errors to continue:","woocommerce")}),(0,p.jsx)("ul",{children:e.map((({id:e,content:t,actions:o})=>(0,p.jsxs)("li",{children:[t,o.length>0?o.map((({label:e,onClick:t})=>(0,p.jsx)(x.Button,{onClick:t,variant:"link",children:e},e))):null]},e)))})]})})}function qt({context:e="email-editor"}){const{notices:t}=(0,i.useSelect)((t=>({notices:t(te.store).getNotices(e)})),[e]),o=(0,l.useMemo)((()=>({"site-editor-save-success":{content:(0,_.__)("Email design updated.","woocommerce"),removeActions:!0},"editor-save":{content:(0,_.__)("Email saved.","woocommerce"),removeActions:!1,contentCheck:e=>e.content.includes((0,_.__)("Post updated."))}})),[]),{removeNotice:n}=(0,i.useDispatch)(te.store),r=t.filter((({type:e})=>"snackbar"===e)).map((e=>o[e.id]?o[e.id].contentCheck&&!o[e.id].contentCheck(e)?e:{...e,content:o[e.id].content,spokenMessage:o[e.id].content,actions:o[e.id].removeActions?[]:e.actions}:e));return(0,p.jsx)(x.SnackbarList,{notices:r,className:"components-editor-notices__snackbar",onRemove:t=>n(t,e)})}function Zt({children:e}){const[t]=(0,l.useState)(document.createElement("div"));return(0,l.useEffect)((()=>{const e=document.getElementsByClassName("editor-visual-editor ")[0];e&&e.parentNode?.insertBefore(t,e)}),[t]),(0,l.createPortal)((0,p.jsx)(p.Fragment,{children:e}),t)}function Jt(){const{notices:e}=(0,i.useSelect)((e=>({notices:e(te.store).getNotices("email-editor")})),[]),{removeNotice:t}=(0,i.useDispatch)(te.store),o=e.filter((({isDismissible:e,type:t})=>e&&"default"===t)),n=e.filter((({isDismissible:e,type:t})=>!e&&"default"===t));return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(Zt,{children:[(0,p.jsx)(x.NoticeList,{notices:n,className:"components-editor-notices__pinned"}),(0,p.jsx)(x.NoticeList,{notices:o,className:"components-editor-notices__dismissible",onRemove:e=>t(e,"email-editor")}),(0,p.jsx)(Ut,{})]}),(0,p.jsx)(qt,{context:"global"}),(0,p.jsx)(qt,{context:"email-editor"})]})}const Yt=e=>{const t=(0,H.getBlockSupport)(e,"background");return t&&!1!==t?.backgroundImage};function Kt(){const e=(0,i.useSelect)((e=>e("core/block-editor").getSelectedBlock()),[]),t=(0,H.hasBlockSupport)(e?.name,"border",!1)||(0,H.hasBlockSupport)(e?.name,"__experimentalBorder",!1);return(0,p.jsxs)(p.Fragment,{children:[t&&(0,p.jsx)(x.Fill,{name:"InspectorControlsBorder",children:(0,p.jsxs)(x.Notice,{className:"woocommerce-grid-full-width",status:"warning",isDismissible:!1,children:[(0,_.__)("Border display may vary or be unsupported in some email clients.","woocommerce"),(0,p.jsx)("br",{}),(0,_.__)("Units other than pixels (px) lack support in old email clients.","woocommerce")]})}),Yt(e?.name)&&(0,p.jsx)(x.Fill,{name:"InspectorControlsBackground",children:(0,p.jsx)(x.Notice,{className:"woocommerce-grid-full-width",status:"warning",isDismissible:!1,children:(0,_.__)("Select a background color for email clients that do not support background images.","woocommerce")})})]})}const Xt=(0,p.jsx)(oe.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"-2 -2 24 24",children:(0,p.jsx)(oe.Path,{d:"M20 10c0-5.51-4.49-10-10-10C4.48 0 0 4.49 0 10c0 5.52 4.48 10 10 10 5.51 0 10-4.48 10-10zM7.78 15.37L4.37 6.22c.55-.02 1.17-.08 1.17-.08.5-.06.44-1.13-.06-1.11 0 0-1.45.11-2.37.11-.18 0-.37 0-.58-.01C4.12 2.69 6.87 1.11 10 1.11c2.33 0 4.45.87 6.05 2.34-.68-.11-1.65.39-1.65 1.58 0 .74.45 1.36.9 2.1.35.61.55 1.36.55 2.46 0 1.49-1.4 5-1.4 5l-3.03-8.37c.54-.02.82-.17.82-.17.5-.05.44-1.25-.06-1.22 0 0-1.44.12-2.38.12-.87 0-2.33-.12-2.33-.12-.5-.03-.56 1.2-.06 1.22l.92.08 1.26 3.41zM17.41 10c.24-.64.74-1.87.43-4.25.7 1.29 1.05 2.71 1.05 4.25 0 3.29-1.73 6.24-4.4 7.78.97-2.59 1.94-5.2 2.92-7.78zM6.1 18.09C3.12 16.65 1.11 13.53 1.11 10c0-1.3.23-2.48.72-3.59C3.25 10.3 4.67 14.2 6.1 18.09zm4.03-6.63l2.58 6.98c-.86.29-1.76.45-2.71.45-.79 0-1.57-.11-2.29-.33.81-2.38 1.62-4.74 2.42-7.1z"})}),Qt=(0,p.jsx)(oe.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,p.jsx)(oe.Path,{d:"M20 11.2H6.8l3.7-3.7-1-1L3.9 12l5.6 5.5 1-1-3.7-3.7H20z"})}),eo={edit:{opacity:0,scale:.2},hover:{opacity:1,scale:1,clipPath:"inset( 22% round 2px )"}},to={edit:{clipPath:"inset(0% round 0px)"},hover:{clipPath:"inset( 22% round 2px )"},tap:{clipPath:"inset(0% round 0px)"}},oo=()=>{const{urls:e}=(0,i.useSelect)((e=>({urls:e(B).getUrls()})),[]);function t(){e.listings&&(window.location.href=e.back)}return(0,p.jsx)(K,{children:({length:e})=>e<=1&&(0,p.jsxs)(x.__unstableMotion.div,{className:"woocommerce-email-editor__view-mode-toggle",transition:{duration:.2},animate:"edit",initial:"edit",whileHover:"hover",whileTap:"tap",children:[(0,p.jsx)(x.Button,{label:(0,_.__)("Close editor","woocommerce"),showTooltip:!0,tooltipPosition:"middle right",onClick:()=>{T("header_close_button_clicked"),(0,a.applyFilters)("woocommerce_email_editor_close_action_callback",t)()},children:(0,p.jsx)(x.__unstableMotion.div,{variants:to,children:(0,p.jsx)("div",{className:"woocommerce-email-editor__view-mode-toggle-icon",children:(0,p.jsx)(Fe,{className:"woocommerce-email-editor-icon__icon",icon:Xt,size:48})})})}),(0,p.jsx)(x.__unstableMotion.div,{className:"woocommerce-email-editor-icon",variants:eo,children:(0,p.jsx)(Fe,{icon:Qt})})]})})};function no({postId:e,postType:t,settings:o}){const{currentPost:n,onNavigateToEntityRecord:r,onNavigateToPreviousEntityRecord:s}=function(e,t,o){const[n,r]=(0,l.useReducer)(((e,{type:t,post:o,previousRenderingMode:n})=>"push"===t?[...e,{post:o,previousRenderingMode:n}]:"pop"===t&&e.length>1?e.slice(0,-1):e),[{post:{postId:e,postType:t}}]),{post:s,previousRenderingMode:a}=n[n.length-1],{getRenderingMode:c}=(0,i.useSelect)($.store),{setRenderingMode:d}=(0,i.useDispatch)($.store),m=(0,l.useCallback)((e=>{r({type:"push",post:{postId:e.postId,postType:e.postType},previousRenderingMode:c()}),d(o)}),[c,d,o]),p=(0,l.useCallback)((()=>{r({type:"pop"}),a&&d(a)}),[d,a]);return{currentPost:s,onNavigateToEntityRecord:m,onNavigateToPreviousEntityRecord:n.length>1?p:void 0}}(e,t,"post-only"),{post:a,template:c,isFullscreenEnabled:d}=(0,i.useSelect)((e=>{const{getEntityRecord:t}=e(ee.store),{getEditedPostTemplate:o}=e(B),r=t("postType",n.postType,n.postId);return{template:"wp_template"!==n.postType?o():null,post:r,isFullscreenEnabled:e(B).isFeatureActive("fullscreenMode")}}),[n.postType,n.postId]),{isFullScreenForced:m,displaySendEmailButton:u}=o,{removeEditorPanel:_}=(0,i.useDispatch)($.store);(0,l.useEffect)((()=>{_("post-status")}),[_]);const[g]=Ne(),h=(0,l.useMemo)((()=>({...o,onNavigateToEntityRecord:r,onNavigateToPreviousEntityRecord:s,defaultRenderingMode:"wp_template"===n.postType?"post-only":"template-locked",supportsTemplateMode:!0})),[o,r,s,n.postType]);return!a||"wp_template"!==n.postType&&!c?(0,p.jsx)("div",{className:"spinner-container",children:(0,p.jsx)(x.Spinner,{style:{width:"80px",height:"80px"}})}):(P("editor_layout_loaded"),(0,p.jsx)(x.SlotFillProvider,{children:(0,p.jsxs)($.ErrorBoundary,{canCopyContent:!0,children:[(0,p.jsx)(ve.CommandMenu,{}),(0,p.jsxs)(Z,{postId:n.postId,postType:n.postType,settings:h,templateId:c&&c.id,styles:g,children:[(0,p.jsx)($.AutosaveMonitor,{}),(0,p.jsx)($.LocalAutosaveMonitor,{}),(0,p.jsx)($.UnsavedChangesWarning,{}),(0,p.jsx)($.EditorKeyboardShortcutsRegister,{}),(0,p.jsx)($.PostLockedModal,{}),(0,p.jsx)(qe,{}),(0,p.jsx)(jt,{}),(0,p.jsx)(Bt,{}),(0,p.jsx)(J,{isActive:m||d}),(m||d)&&(0,p.jsx)(oo,{}),!m&&(0,p.jsx)(It,{}),"wp_template"===n.postType?(0,p.jsx)(Vt,{}):(0,p.jsx)(Ot,{}),u&&(0,p.jsx)($t,{}),(0,p.jsx)(Jt,{}),(0,p.jsx)(Kt,{})]})]})}))}const ro=window.wp.dataControls;function so(e){return{type:"CHANGE_PREVIEW_STATE",state:{isModalOpened:e}}}function io(e){return{type:"CHANGE_PREVIEW_STATE",state:{toEmail:e}}}const lo=e=>async({registry:t})=>{const o=t.select(B).getEmailPostId();t.dispatch(ee.store).editEntityRecord("postType",M,o,{template:e})};function*ao(e){if(!(0,i.select)(B).getPreviewState().isSendingPreviewEmail){yield{type:"CHANGE_PREVIEW_STATE",state:{sendingPreviewStatus:null,isSendingPreviewEmail:!0}};try{const t=(0,i.select)(B).getEmailPostId();yield(0,ro.apiFetch)({path:"/woocommerce-email-editor/v1/send_preview_email",method:"POST",data:{email:e,postId:t}}),yield{type:"CHANGE_PREVIEW_STATE",state:{sendingPreviewStatus:Tt.SUCCESS,isSendingPreviewEmail:!1}},T("sent_preview_email",{postId:t,email:e})}catch(t){T("sent_preview_email_error",{email:e}),yield{type:"CHANGE_PREVIEW_STATE",state:{sendingPreviewStatus:Tt.ERROR,isSendingPreviewEmail:!1,errorMessage:JSON.stringify(t?.error)}}}}}function co(e){return{type:"SET_IS_FETCHING_PERSONALIZATION_TAGS",state:{isFetching:e}}}function mo(e){return{type:"SET_PERSONALIZATION_TAGS_LIST",state:{list:e}}}function po(e,t){switch(t.type){case"CHANGE_PREVIEW_STATE":return{...e,preview:{...e.preview,...t.state}};case"CHANGE_PERSONALIZATION_TAGS_STATE":case"SET_IS_FETCHING_PERSONALIZATION_TAGS":case"SET_PERSONALIZATION_TAGS_LIST":return{...e,personalizationTags:{...e.personalizationTags,...t.state}};case"SET_PERSONALIZATION_TAGS":return{...e,personalizationTags:{...e.personalizationTags,list:t.personalizationTags}};default:return e}}function uo(e){return e?.content&&"function"==typeof e.content?e.content(e):e?.blocks?(0,H.serialize)(e.blocks):e?.content?e.content:""}const _o=new WeakMap;function go(e){let t=_o.get(e);return t||(t={...e,get blocks(){return(0,H.parse)(e.content)}},_o.set(e,t)),t}function ho(e){return e?{...e,title:e?.title?.raw||e?.title||"",content:e?.content?.raw||e?.content||""}:null}const yo=(0,i.createRegistrySelector)((e=>(t,o)=>!!e(Mt.store).get(B,o))),xo=(0,i.createRegistrySelector)((e=>()=>{const t=e(B).getEmailPostId();return!!e(ee.store).hasEditsForEntityRecord("postType",M,t)})),wo=(0,i.createRegistrySelector)((e=>()=>{const t=e(B).getEmailPostId(),o=e(ee.store).getEntityRecord("postType",M,t);if(!o)return!0;const{content:n}=o;return!n.raw})),fo=(0,i.createRegistrySelector)((e=>()=>{const t=e(B).getEmailPostId(),o=e(ee.store).getEntityRecord("postType",M,t);return!!o&&"sent"===o.status})),bo=(0,i.createRegistrySelector)((e=>()=>{const t=e(B).getEmailPostId(),o=e(ee.store).getEditedEntityRecord("postType",M,t);return o?uo(o):""})),vo=(0,i.createRegistrySelector)((e=>()=>e(ee.store).getEntityRecords("postType",M,{per_page:30,status:"publish,sent"})?.filter((e=>""!==e?.content?.raw))||[])),jo=(0,i.createRegistrySelector)((e=>(0,i.createSelector)((()=>e(ee.store).getBlockPatterns().filter((({templateTypes:e})=>Array.isArray(e)&&e.includes("email-template"))).map(go)),(()=>[e(ee.store).getBlockPatterns()])))),ko=(0,i.createRegistrySelector)((e=>()=>e(ee.store).canUser("create",{kind:"postType",name:"wp_template"})));function So(e,t){return ko()?e(ee.store).getEditedEntityRecord("postType","wp_template",t):ho(e(ee.store).getEntityRecord("postType","wp_template",t,{context:"view"}))}const Co=(0,i.createRegistrySelector)((e=>()=>{const t=e($.store).getEditedPostAttribute("template");if(t){const o=e(ee.store).getEntityRecords("postType","wp_template",{per_page:-1,context:"view"})?.find((e=>e.slug===t));return o?So(e,o.id):ho(o)}const o=e(ee.store).getDefaultTemplateId({slug:"email-general"});return So(e,o)})),Eo=(0,i.createRegistrySelector)((e=>()=>{if("wp_template"===e($.store).getCurrentPostType()){const t=e($.store).getCurrentPostId();return e(ee.store).getEditedEntityRecord("postType","wp_template",t)}return Co()})),To=()=>{const e=Eo();return e?uo(e):""},Po=(0,i.createRegistrySelector)((e=>()=>{const t=e(B).getGlobalStylesPostId();return{postId:t,canEdit:e(ee.store).canUser("update",{kind:"root",name:"globalStyles",id:t})}})),No=(0,i.createRegistrySelector)((e=>()=>{const{postId:t,canEdit:o}=Po();return t&&void 0!==o&&t?o?e(ee.store).getEditedEntityRecord("postType","wp_global_styles",t):ho(e(ee.store).getEntityRecord("postType","wp_global_styles",t,{context:"view"})):null})),Bo=(0,i.createRegistrySelector)((e=>()=>e(ee.store).getEntityRecords("postType","wp_template",{per_page:-1,post_type:M,context:"view"})?.filter((e=>e.post_types.includes(M)))));function Mo(e){return e.postId}function Io(e){return e.editorSettings}function zo(e){return e.editorSettings.__experimentalFeatures.color.palette}function Fo(e){return e.preview}function Ao(e){return e.personalizationTags}function Lo(e){return e.personalizationTags.list}function Ro(e){return e.theme.styles}function Oo(e){return e.theme}function Ho(e){return e.styles.globalStylesPostId}function Vo(e){return e.urls}function*Do(){const e=yield(0,i.select)(B),t=e.personalizationTags?.isFetching;if(!t){yield co(!0);try{const e=yield(0,ro.apiFetch)({path:"/woocommerce-email-editor/v1/get_personalization_tags",method:"GET"});yield mo(e.result)}finally{yield co(!1)}}}const Go=window.wp.mediaUtils,$o=e=>{(0,a.doAction)("woocommerce_email_editor_events",e.detail)};window.addEventListener("unload",(function(){S&&E.removeEventListener(C,$o)}));const Wo=(...e)=>{const t=(0,i.select)($.store).isInserterOpened(),o=!!document.getElementsByClassName("block-editor-inserter__quick-inserter").length;let n="other_inserter";t?n="inserter_sidebar":o&&(n="quick_inserter");const r=e[0],s=e[5];!1===Array.isArray(r)&&"object"==typeof r&&T(`${n}_library_block_selected`,{blockName:r.name}),Array.isArray(r)&&s&&s.patternName&&T(`${n}_library_pattern_selected`,{patternName:s.patternName})},Uo={"core/editor":{autosave:"editor_content_auto_saved",setDeviceType:e=>{T(`header_preview_dropdown_${e.toLowerCase()}_selected`)},setRenderingMode:e=>{(0,i.select)($.store).getRenderingMode()!==e&&document.querySelector(`[aria-label="${(0,_.__)("View options")}"]`)&&T("preview_dropdown_rendering_mode_changed",{renderingMode:e})}},core:{deleteEntityRecord:(e,t,o)=>{t===M&&o===I&&T("trash_modal_move_to_trash_button_clicked")}},"core/block-editor":{insertBlock:Wo,insertBlocks:Wo},"core/preferences":{set:(e,t,o)=>{if((0,i.select)(Mt.store).get(e,t)===o)return;const n={focusMode:"focus_mode_toggle",fullscreenMode:"full_screen_mode_toggle",distractionFree:"distraction_free_toggle",fixedToolbar:"fixed_toolbar_toggle"};n[t]&&T(n[t],{isEnabled:o})}},"core/commands":{open:"command_menu_opened",close:"command_menu_closed"}},qo={},Zo={};let Jo=[];function Yo(e){Jo.forEach((t=>{const o=e.target?.matches?.(t.selector)?e.target:e.target?.closest?.(t.selector);o&&("function"==typeof t.track?t.track(o,e):T(t.track))}))}const Ko=window.wp.isShallowEqual;var Xo=o.n(Ko);function Qo(e){const t=(0,l.useRef)(e);return Xo()(e,t.current)||(t.current=e),t.current}const en=[],tn=(0,a.applyFilters)("woocommerce_email_editor_wrap_editor_component",(function(){const{postId:e,settings:t}=(0,i.useSelect)((e=>({postId:e(B).getEmailPostId(),settings:e(B).getInitialEditorSettings()})),[]);return(()=>{const{addValidationNotice:e,hasValidationNotice:t,removeValidationNotice:o}=Wt(),{editedContent:n,editedTemplateContent:r}=(0,i.useSelect)((e=>({editedContent:e(B).getEditedEmailContent(),editedTemplateContent:e(B).getCurrentTemplateContent()}))),s=Qo(n),c=Qo(r),d=(0,l.useCallback)((()=>((e,t,{addValidationNotice:o,hasValidationNotice:n,removeValidationNotice:r})=>{const s=(0,a.applyFilters)("woocommerce_email_editor_content_validation_rules",en);let i=!0;return s.forEach((({id:s,testContent:l,message:a,actions:c})=>{l(e+t)?(o(s,a,c),i=!1):n(s)&&r(s)})),i})(s,c,{addValidationNotice:e,hasValidationNotice:t,removeValidationNotice:o})),[s,c,e,o,t]);(0,l.useEffect)((()=>((0,a.addFilter)("editor.preSavePost","woocommerce/email-editor/validate-content",(async e=>{if(!d())throw new Error;return e})),()=>{(0,a.removeFilter)("editor.preSavePost","woocommerce/email-editor/validate-content")})),[d]),(0,l.useEffect)((()=>{const e=(0,i.subscribe)((()=>{t()&&d()}),ee.store);return()=>e()}),[t,d]),t()})(),(0,p.jsx)(l.StrictMode,{children:(0,p.jsx)(no,{postId:e,postType:M,settings:t})})}));window.addEventListener("DOMContentLoaded",(()=>{!function(e){const t=document.getElementById(e);t&&(S&&E.addEventListener(C,$o),(0,a.applyFilters)("woocommerce_email_editor_events_tracking_enabled",!1)&&(0,i.use)((e=>({dispatch:t=>{const o="object"==typeof t?t.name:t,n=e.dispatch(o),r=Uo[o];if(!r)return n;qo[o]||(qo[o]={}),Zo[o]||(Zo[o]={});for(const[e,t]of Object.entries(r))Zo[o][e]||(Zo[o][e]=n[e],qo[o][e]=(...n)=>{try{"function"==typeof t?t(...n):"string"==typeof t&&T(t)}catch(e){console.error("Error tracking event",e)}return Zo[o][e](...n)}),n[e]=qo[o][e];return n}}))),(0,a.applyFilters)("woocommerce_email_editor_events_tracking_enabled",!1)&&(Jo=[{track:"header_preview_dropdown_preview_in_new_tab_selected",selector:".editor-preview-dropdown__button-external"},{track:()=>{const e=document.getElementsByClassName("is-collapsed editor-collapsible-block-toolbar").length;T("header_blocks_tool_button_clicked",{isBlockToolsCollapsed:e})},selector:".editor-collapsible-block-toolbar__toggle"},{track:e=>{const t=e.classList.contains("is-opened");T("header_more_menu_dropdown_toggle",{isOpened:t})},selector:`.components-dropdown-menu__toggle[aria-label="${(0,_.__)("Options")}"]`},{track:e=>{(e.textContent===(0,_.__)("Save")&&"false"===e.getAttribute("aria-disabled")||e.textContent===(0,_.__)("Saving…"))&&T("header_save_button_clicked")},selector:".editor-post-publish-button"},{track:"header_save_email_button_clicked",selector:".editor-post-saved-state.is-saving"},{track:"inserter_sidebar_library_close_icon_clicked",selector:".block-editor-inserter__menu .block-editor-tabbed-sidebar__close-button"},{track:e=>{const t=e.classList.contains("is-opened");T("header_preview_dropdown_clicked",{isOpened:t})},selector:".editor-preview-dropdown__toggle"},{track:()=>{T("sidebar_tab_selected",{tab:"document"})},selector:'[data-tab-id="edit-post/document"]'},{track:()=>{T("sidebar_tab_selected",{tab:"block"})},selector:'[data-tab-id="edit-post/block"]'},{track:e=>{const t=e.classList.contains("is-pressed");T("header_inserter_sidebar_clicked",{isOpened:t})},selector:".editor-document-tools__inserter-toggle"},{track:e=>{const t=e.classList.contains("is-pressed");T("header_listview_sidebar_clicked",{isOpened:t})},selector:".editor-document-tools__document-overview-toggle"},{track:e=>{T("command_bar_command_clicked",{command:e.dataset?.value})},selector:'.commands-command-menu__container [role="option"]'}],document.addEventListener("click",Yo)),(()=>{const e=(0,i.createReduxStore)(B,{actions:n,controls:ro.controls,selectors:r,resolvers:s,reducer:po,initialState:{postId:I,editorSettings:window.WooCommerceEmailEditor.editor_settings,theme:window.WooCommerceEmailEditor.editor_theme,styles:{globalStylesPostId:window.WooCommerceEmailEditor.user_theme_post_id},urls:window.WooCommerceEmailEditor.urls,preview:{toEmail:window.WooCommerceEmailEditor.current_wp_user_email,isModalOpened:!1,isSendingPreviewEmail:!1,sendingPreviewStatus:null},personalizationTags:{list:[],isFetching:!1}}});(0,i.register)(e)})(),(0,a.addFilter)("blocks.registerBlockType","woocommerce-email-editor/layout/addAttribute",xe),(0,a.addFilter)("editor.BlockListBlock","woocommerce-email-editor/with-layout-styles",be),(0,a.addFilter)("editor.BlockEdit","woocommerce-email-editor/with-inspector-controls",we),(0,a.addFilter)("editor.BlockEdit","woocommerce-email-editor/filter-set-url-attribute",O),(0,a.addFilter)("editor.BlockEdit","woocommerce-email-editor/deactivate-stack-on-mobile",u),(0,a.addFilter)("editor.BlockEdit","woocommerce-email-editor/hide-expand-on-click",h),(0,a.addFilter)("blocks.registerBlockType","woocommerce-email-editor/deactivate-image-filter",((e,t)=>"core/image"===t?{...e,supports:{...e.supports,filter:{duetone:!1}}}:e)),(0,y.unregisterFormatType)("core/image"),(0,y.unregisterFormatType)("core/code"),(0,y.unregisterFormatType)("core/language"),(0,a.addFilter)("blocks.registerBlockType","woocommerce-email-editor/disable-columns-layout",((e,t)=>"core/columns"===t||"core/column"===t?{...e,supports:{...e.supports,layout:!1}}:e)),(0,a.addFilter)("blocks.registerBlockType","woocommerce-email-editor/disable-group-variations",((e,t)=>"core/group"===t?{...e,variations:e.variations.filter((e=>"group"===e.name)),supports:{...e.supports,layout:!1}}:e)),(0,a.addFilter)("blocks.registerBlockType","woocommerce-email-editor/change-button",((e,t)=>"core/button"===t?{...e,styles:[]}:e)),(0,a.addFilter)("blocks.registerBlockType","woocommerce-email-editor/change-buttons",((e,t)=>"core/buttons"===t?{...e,supports:{...e.supports,layout:!1,__experimentalEmailFlexLayout:!0}}:e)),(0,a.addFilter)("blocks.registerBlockType","woocommerce-email-editor/change-column",((e,t)=>"core/column"===t?{...e,supports:{...e.supports,background:{backgroundImage:!0}}}:e)),(0,a.addFilter)("blocks.registerBlockType","woocommerce-email-editor/change-columns",((e,t)=>"core/columns"===t?{...e,supports:{...e.supports,background:{backgroundImage:!0}}}:e)),(0,a.addFilter)("blocks.registerBlockType","woocommerce-email-editor/change-post-content",((e,t)=>{return"core/post-content"===t?{...e,edit:(o=e.edit,function({context:e,__unstableLayoutClassNames:t}){const{postId:n,postType:r}=e;return n&&r?(0,p.jsx)(o,{context:e,__unstableLayoutClassNames:t}):(0,p.jsx)(g,{layoutClassNames:t})})}:e;var o})),(0,a.addFilter)("blocks.registerBlockType","woocommerce-email-editor/change-quote",((e,t)=>"core/quote"===t?{...e,styles:[],supports:{...e.supports,align:[]}}:e)),(0,y.registerFormatType)("woocommerce-email-editor/shortcode",{name:"woocommerce-email-editor/shortcode",title:(0,_.__)("Personalization Tags","woocommerce"),className:"woocommerce-email-editor-personalization-tags",tagName:"span",attributes:{},edit:L}),(0,y.registerFormatType)("woocommerce-email-editor/link-shortcode",{name:"woocommerce-email-editor/link-shortcode",title:(0,_.__)("Personalization Tags Link","woocommerce"),className:"woocommerce-email-editor-personalization-tags-link",tagName:"a",attributes:{"data-link-href":"data-link-href",contenteditable:"contenteditable",style:"style"},edit:null}),(0,a.addFilter)("editor.BlockEdit","woocommerce-email-editor/with-live-content-update",R),(0,a.addFilter)("blocks.registerBlockType","woocommerce-email-editor/block-support",(e=>e.supports?.shadow?{...e,supports:{...e.supports,shadow:!1}}:e)),(0,a.addFilter)("blocks.registerBlockType","woocommerce-email-editor/disable-social-link-variations",((e,t)=>"core/social-link"===t?{...e,variations:e.variations.filter((e=>V.includes(e.name))),supports:{...e.supports,layout:!1}}:e)),(0,H.registerBlockVariation)("core/social-links",{name:"social-links-default",title:"Social Icons",attributes:{openInNewTab:!0,showLabels:!1,align:"center",className:"is-style-logos-only"},isDefault:!0,innerBlocks:[{name:"core/social-link",attributes:{service:"wordpress",url:"https://wordpress.org"}},{name:"core/social-link",attributes:{service:"facebook",url:"https://www.facebook.com/WordPress/"}},{name:"core/social-link",attributes:{service:"x",url:"https://x.com/WordPress"}}]}),(0,a.addFilter)("editor.BlockEdit","woocommerce-email-editor/disable-social-links-icon-color",D),(0,a.addAction)("core.registerPostTypeSchema","woocommerce-email-editor/modify-move-to-trash-action",(e=>{ce(e)})),(0,a.addAction)("core.registerPostTypeActions","woocommerce-email-editor/modify-move-to-trash-action",(e=>{ce(e)})),(0,c.registerCoreBlocks)(),(0,a.addFilter)("editor.MediaUpload","woocommerce/email-editor/replace-media-upload",(()=>Go.MediaUpload)),(()=>{const e={"You’ve tried to select a block that is part of a template that may be used elsewhere on your site. Would you like to edit the template?":{domain:"default",replacementText:(0,_.__)("You’ve tried to select a block that is part of a template that may be used in other emails. Would you like to edit the template?","woocommerce")}};(0,a.addFilter)("i18n.gettext","woocommerce/email-editor/override-text",((t,o,n)=>e[o]&&e[o].domain===(n||"default")?e[o].replacementText:t))})(),(0,l.createRoot)(t).render((0,p.jsx)(tn,{})))}("woocommerce-email-editor")}))},192:e=>{var t=function(e){return function(e){return!!e&&"object"==typeof e}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===o}(e)}(e)},o="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function n(e,t){return!1!==t.clone&&t.isMergeableObject(e)?l((o=e,Array.isArray(o)?[]:{}),e,t):e;var o}function r(e,t,o){return e.concat(t).map((function(e){return n(e,o)}))}function s(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(t){return Object.propertyIsEnumerable.call(e,t)})):[]}(e))}function i(e,t){try{return t in e}catch(e){return!1}}function l(e,o,a){(a=a||{}).arrayMerge=a.arrayMerge||r,a.isMergeableObject=a.isMergeableObject||t,a.cloneUnlessOtherwiseSpecified=n;var c=Array.isArray(o);return c===Array.isArray(e)?c?a.arrayMerge(e,o,a):function(e,t,o){var r={};return o.isMergeableObject(e)&&s(e).forEach((function(t){r[t]=n(e[t],o)})),s(t).forEach((function(s){(function(e,t){return i(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))})(e,s)||(i(e,s)&&o.isMergeableObject(t[s])?r[s]=function(e,t){if(!t.customMerge)return l;var o=t.customMerge(e);return"function"==typeof o?o:l}(s,o)(e[s],t[s],o):r[s]=n(t[s],o))})),r}(e,o,a):n(o,a)}l.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,o){return l(e,o,t)}),{})};var a=l;e.exports=a}},o={};function n(e){var r=o[e];if(void 0!==r)return r.exports;var s=o[e]={exports:{}};return t[e](s,s.exports,n),s.exports}n.m=t,e=[],n.O=(t,o,r,s)=>{if(!o){var i=1/0;for(d=0;d<e.length;d++){for(var[o,r,s]=e[d],l=!0,a=0;a<o.length;a++)(!1&s||i>=s)&&Object.keys(n.O).every((e=>n.O[e](o[a])))?o.splice(a--,1):(l=!1,s<i&&(i=s));if(l){e.splice(d--,1);var c=r();void 0!==c&&(t=c)}}return t}s=s||0;for(var d=e.length;d>0&&e[d-1][2]>s;d--)e[d]=e[d-1];e[d]=[o,r,s]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={57:0,350:0};n.O.j=t=>0===e[t];var t=(t,o)=>{var r,s,[i,l,a]=o,c=0;if(i.some((t=>0!==e[t]))){for(r in l)n.o(l,r)&&(n.m[r]=l[r]);if(a)var d=a(n)}for(t&&t(o);c<i.length;c++)s=i[c],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return n.O(d)},o=globalThis.webpackChunk_woocommerce_email_editor=globalThis.webpackChunk_woocommerce_email_editor||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})();var r=n.O(void 0,[350],(()=>n(384)));r=n.O(r)})();
=======
(()=>{var e={894:(e,t)=>{var n;!function(){"use strict";var i={}.hasOwnProperty;function o(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var a=typeof n;if("string"===a||"number"===a)e.push(n);else if(Array.isArray(n)){if(n.length){var s=o.apply(null,n);s&&e.push(s)}}else if("object"===a){if(n.toString!==Object.prototype.toString&&!n.toString.toString().includes("[native code]")){e.push(n.toString());continue}for(var l in n)i.call(n,l)&&n[l]&&e.push(l)}}}return e.join(" ")}e.exports?(o.default=o,e.exports=o):void 0===(n=function(){return o}.apply(t,[]))||(e.exports=n)}()},192:e=>{"use strict";var t=function(e){return function(e){return!!e&&"object"==typeof e}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===n}(e)}(e)},n="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function i(e,t){return!1!==t.clone&&t.isMergeableObject(e)?l((n=e,Array.isArray(n)?[]:{}),e,t):e;var n}function o(e,t,n){return e.concat(t).map((function(e){return i(e,n)}))}function a(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(t){return Object.propertyIsEnumerable.call(e,t)})):[]}(e))}function s(e,t){try{return t in e}catch(e){return!1}}function l(e,n,r){(r=r||{}).arrayMerge=r.arrayMerge||o,r.isMergeableObject=r.isMergeableObject||t,r.cloneUnlessOtherwiseSpecified=i;var c=Array.isArray(n);return c===Array.isArray(e)?c?r.arrayMerge(e,n,r):function(e,t,n){var o={};return n.isMergeableObject(e)&&a(e).forEach((function(t){o[t]=i(e[t],n)})),a(t).forEach((function(a){(function(e,t){return s(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))})(e,a)||(s(e,a)&&n.isMergeableObject(t[a])?o[a]=function(e,t){if(!t.customMerge)return l;var n=t.customMerge(e);return"function"==typeof n?n:l}(a,n)(e[a],t[a],n):o[a]=i(t[a],n))})),o}(e,n,r):i(n,r)}l.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,n){return l(e,n,t)}),{})};var r=l;e.exports=r}},t={};function n(i){var o=t[i];if(void 0!==o)return o.exports;var a=t[i]={exports:{}};return e[i](a,a.exports,n),a.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";var e={};n.r(e),n.d(e,{closeModal:()=>Ce,disableComplementaryArea:()=>fe,enableComplementaryArea:()=>ye,openModal:()=>ke,pinItem:()=>ve,setDefaultComplementaryArea:()=>xe,setFeatureDefaults:()=>Se,setFeatureValue:()=>we,toggleFeature:()=>je,unpinItem:()=>be});var t={};n.r(t),n.d(t,{getActiveComplementaryArea:()=>Te,isComplementaryAreaLoading:()=>Ee,isFeatureActive:()=>Pe,isItemPinned:()=>Ne,isModalActive:()=>Ie});var i={};n.r(i),n.d(i,{changePreviewDeviceType:()=>xi,closeSidebar:()=>ji,openSidebar:()=>bi,requestSendingNewsletterPreview:()=>Ci,revertAndSaveTemplate:()=>Ti,saveEditedEmail:()=>Si,setIsFetchingPersonalizationTags:()=>Ei,setPersonalizationTagsList:()=>Ni,setTemplateToPost:()=>ki,toggleFeature:()=>gi,togglePersonalizationTagsModal:()=>fi,togglePreviewModal:()=>yi,toggleSettingsSidebarActiveTab:()=>wi,updateSendPreviewEmail:()=>vi});var o={};n.r(o),n.d(o,{getAutosaveInterval:()=>ao,getBlockPatternsForEmailTemplate:()=>$i,getCurrentTemplate:()=>Wi,getCurrentTemplateContent:()=>qi,getDeviceType:()=>io,getEditedEmailContent:()=>Hi,getEditedPostTemplate:()=>Ui,getEmailPostId:()=>Ji,getEmailTemplates:()=>Yi,getGlobalEmailStylesPost:()=>Zi,getGlobalStylesPostId:()=>lo,getInitialEditorSettings:()=>Ki,getPaletteColors:()=>Qi,getPersonalizationTagsList:()=>no,getPersonalizationTagsState:()=>to,getPreviewState:()=>eo,getSentEmailEditorPosts:()=>Gi,getSettingsSidebarActiveTab:()=>Xi,getStyles:()=>oo,getTheme:()=>so,getUrls:()=>ro,hasEdits:()=>Ri,hasEmptyContent:()=>Oi,isEmailLoaded:()=>Fi,isEmailSent:()=>Vi,isEmpty:()=>Di,isFeatureActive:()=>Ai,isSaving:()=>zi,isSidebarOpened:()=>Li});var a={};n.r(a),n.d(a,{getPersonalizationTagsList:()=>co});const s=window.wp.data,l=window.wp.element,r=window.wp.hooks,c=(window.wp.formatLibrary,window.wp.blockLibrary),d=window.wp.blockEditor,p=window.wp.compose,m=window.ReactJSXRuntime,u=(0,p.createHigherOrderComponent)((e=>function(t){return"core/columns"!==t.name?(0,m.jsx)(e,{...t}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(e,{...t}),(0,m.jsx)(d.InspectorControls,{children:(0,m.jsx)("style",{children:"\n      .components-panel__body .components-toggle-control .components-form-toggle { opacity: 0.3; }\n      .components-panel__body .components-toggle-control .components-form-toggle__input { pointer-events: none; }\n      .components-panel__body .components-toggle-control label { pointer-events: none; }\n    "})})]})}),"columnsEditCallback"),_=window.wp.i18n;function h({layoutClassNames:e}){const t=(0,d.useBlockProps)({className:e});return(0,m.jsxs)("div",{...t,children:[(0,m.jsx)("p",{children:(0,_.__)("This is the Content block.","mailpoet")}),(0,m.jsx)("p",{children:(0,_.__)("It will display all the blocks in the email content, which might be only simple text paragraphs. You can enrich your message with images, incorporate data through tables, explore different layout designs with columns, or use any other block type.","mailpoet")})]})}const g=(0,p.createHigherOrderComponent)((e=>function(t){return"core/image"!==t.name?(0,m.jsx)(e,{...t}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(e,{...t}),(0,m.jsx)(d.InspectorControls,{children:(0,m.jsx)("style",{children:"\n        .components-tools-panel .components-toggle-control { display: none; }\n      "})})]})}),"imageEditCallback"),x=window.wp.richText,y=window.wp.components,f=(e,t)=>{const n=e.current.ownerDocument.defaultView.getSelection();if(!n.rangeCount)return{start:0,end:0};const i=n.getRangeAt(0);if(null===n.anchorNode.previousSibling)return{start:n.anchorOffset,end:n.anchorOffset+i.toString().length};const o=(0,x.create)({html:t});let a=n.anchorNode.previousSibling;a=function(e){let t=e;for(;t&&t?.children?.length>0;)t=t.children[0];return t}(a);const s=function(e,t){let n=null;for(const[i,o]of t.entries())if(o)for(const t of o)t?.attributes&&e.tagName.toLowerCase()===t.tagName?.toLowerCase()&&e.getAttribute("data-link-href")===t?.attributes["data-link-href"]&&(n=i);return n}(a,o.formats);if(null!==s)return{start:s+n.anchorOffset+1,end:s+n.anchorOffset+i.toString().length};const l=function(e,t){for(const[n,i]of t.entries()){if(!i)continue;const{attributes:t}=i;if(e.getAttribute("data-rich-text-comment")===t["data-rich-text-comment"])return n}return null}(a,o.replacements);return null!==l?{start:l+n.anchorOffset+1,end:l+n.anchorOffset+i.toString().length}:{start:o.text.length,end:o.text.length+i.toString().length}},v=(e,t)=>(t.forEach((t=>{if(!e.includes(t.token.slice(0,t.token.length-1)))return;const n=t.token.substring(1,t.token.length-1).replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),i=new RegExp(`(?<!\x3c!--)(?<!["'])\\[(${n}(\\s[^\\]]*)?)\\](?!--\x3e)`,"g");e=e.replace(i,(e=>`\x3c!--${e}--\x3e`))})),e),b=({groupedTags:e,activeCategory:t,onCategorySelect:n})=>{const i=e=>e===t?"mailpoet-personalization-tags-modal-menu-item-active":"";return(0,m.jsxs)(y.MenuGroup,{className:"mailpoet-personalization-tags-modal-menu",children:[(0,m.jsx)(y.MenuItem,{onClick:()=>n(null),className:i(null),children:(0,_.__)("All","mailpoet")}),(0,m.jsx)("div",{className:"mailpoet-personalization-tags-modal-menu-separator","aria-hidden":"true"}),Object.keys(e).map(((e,t,o)=>(0,m.jsxs)(l.Fragment,{children:[(0,m.jsx)(y.MenuItem,{onClick:()=>n(e),className:i(e),children:e}),t<o.length-1&&(0,m.jsx)("div",{className:"mailpoet-personalization-tags-modal-menu-separator","aria-hidden":"true"})]},e)))]})},j=({groupedTags:e,activeCategory:t,onInsert:n,canInsertLink:i,closeCallback:o,openLinkModal:a})=>{const s=null===t?Object.entries(e):[[t,e[t]||[]]];return(0,m.jsx)(m.Fragment,{children:s.map((([e,t])=>(0,m.jsxs)("div",{children:[(0,m.jsx)("div",{className:"mailpoet-personalization-tags-modal-category",children:e}),(0,m.jsx)("div",{className:"mailpoet-personalization-tags-modal-category-group",children:t.map((t=>(0,m.jsxs)("div",{className:"mailpoet-personalization-tags-modal-category-group-item",children:[(0,m.jsxs)("div",{className:"mailpoet-personalization-tags-modal-item-text",children:[(0,m.jsx)("strong",{children:t.name}),t.valueToInsert]}),(0,m.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end"},children:[(0,m.jsx)(y.Button,{variant:"link",onClick:()=>{n&&n(t.valueToInsert,!1)},children:(0,_.__)("Insert","mailpoet")}),e===(0,_.__)("Link","mailpoet")&&i&&(0,m.jsx)(m.Fragment,{children:(0,m.jsx)(y.Button,{variant:"link",onClick:()=>{o(),a(t)},children:(0,_.__)("Insert as link","mailpoet")})})]})]},t.token)))})]},e)))})},w=({onInsert:e,isOpened:t,closeCallback:n,tag:i})=>{const[o,a]=(0,l.useState)((0,_.__)("Link","mailpoet"));return t?(0,m.jsxs)(y.Modal,{size:"small",title:(0,_.__)("Insert Link","mailpoet"),onRequestClose:n,className:"mailpoet-personalization-tags-modal",children:[(0,m.jsx)(y.TextControl,{label:(0,_.__)("Link Text","mailpoet"),value:o,onChange:a}),(0,m.jsx)(y.Button,{isPrimary:!0,onClick:()=>{e&&e(i.token,o)},children:(0,_.__)("Insert","mailpoet")})]}):null},S=window.lodash,k=(0,r.applyFilters)("mailpoet_email_editor_events_tracking_enabled",!1),C="email_editor_events",T=new EventTarget,E=(e,t={})=>{if(!k)return;const n={name:`${C}_${e}`,..."object"!=typeof t?{data:t}:t};T.dispatchEvent(new CustomEvent(C,{detail:n}))},N=function(){const e={};return(t,n={})=>{if(!k)return;const i=`${t}_${JSON.stringify(n).length}`;e[i]||(E(t,n),e[i]=!0)}}(),P=(0,S.debounce)(E,700),I="email-editor/editor",M="document",B="block",A=window.MailPoetEmailEditor.current_post_type,L=parseInt(window.MailPoetEmailEditor.current_post_id,10),R=({onInsert:e,isOpened:t,closeCallback:n,canInsertLink:i=!1,openedBy:o=""})=>{const[a,r]=(0,l.useState)(null),[c,d]=(0,l.useState)(""),[p,u]=(0,l.useState)(null),[h,g]=(0,l.useState)(!1),x=(0,s.useSelect)((e=>e(I).getPersonalizationTagsList()),[]);if(h)return(0,m.jsx)(w,{onInsert:(t,n)=>{e(t,n),g(!1)},isOpened:h,closeCallback:()=>g(!1),tag:p});if(!t)return null;N("personalization_tags_modal_opened",{openedBy:o});const f=x.reduce(((e,t)=>{const{category:n,name:i,token:o}=t;return(!c||i.toLowerCase().includes(c.toLowerCase())||o.toLowerCase().includes(c.toLowerCase()))&&(e[n]||(e[n]=[]),e[n].push(t)),e}),{});return(0,m.jsxs)(y.Modal,{size:"medium",title:(0,_.__)("Personalization Tags","mailpoet"),onRequestClose:()=>{n(),E("personalization_tags_modal_closed",{openedBy:o})},className:"mailpoet-personalization-tags-modal",children:[(0,m.jsxs)("p",{children:[(0,_.__)("Insert personalization tags to dynamically fill in information and personalize your emails.","mailpoet")," ",(0,m.jsx)(y.ExternalLink,{href:"https://kb.mailpoet.com/article/435-a-guide-to-personalisation-tags-for-tailored-newsletters#list",onClick:()=>E("personalization_tags_modal_learn_more_link_clicked",{openedBy:o}),children:(0,_.__)("Learn more","mailpoet")})]}),(0,m.jsx)(y.SearchControl,{onChange:e=>{d(e),N("personalization_tags_modal_search_control_input_updated",{openedBy:o})},value:c}),(0,m.jsx)(b,{groupedTags:f,activeCategory:a,onCategorySelect:e=>{r(e),E("personalization_tags_modal_category_menu_clicked",{category:e,openedBy:o})}}),(0,m.jsx)(j,{groupedTags:f,activeCategory:a,onInsert:t=>{e(t),E("personalization_tags_modal_tag_insert_button_clicked",{insertedTag:t,activeCategory:a,openedBy:o})},closeCallback:n,canInsertLink:i,openLinkModal:e=>{u(e),g(!0)}})]})},F=({contentRef:e,onUpdate:t})=>{const[n,i]=(0,l.useState)(!1),[o,a]=(0,l.useState)(null),[s,r]=(0,l.useState)(""),[c,d]=(0,l.useState)("");return(0,l.useEffect)((()=>{if(!e||!e.current)return;const t=e.current,n=e=>{const t=e.target.closest("span[data-rich-text-comment]");if(t){const e=t.innerText.replace(/^\[|\]$/g,"");d(e),r(e),a(t),i(!0)}};return t.addEventListener("click",n),()=>{t.removeEventListener("click",n)}}),[e]),(0,m.jsx)(m.Fragment,{children:n&&o&&(0,m.jsx)(y.Popover,{position:"bottom right",onClose:()=>i(!1),anchor:o,className:"mailpoet-personalization-tag-popover",children:(0,m.jsxs)("div",{className:"mailpoet-personalization-tag-popover-content",children:[(0,m.jsx)(y.TextControl,{label:(0,_.__)("Personalization Tag","mailpoet"),value:s,onChange:e=>r(e),__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0}),(0,m.jsxs)("div",{className:"mailpoet-personalization-tag-popover-content-buttons",children:[(0,m.jsx)(y.Button,{isTertiary:!0,onClick:()=>{i(!1)},children:(0,_.__)("Cancel","mailpoet")}),(0,m.jsx)(y.Button,{isPrimary:!0,onClick:()=>{t(c,s),i(!1)},children:(0,_.__)("Update","mailpoet")})]})]})})})},z=({contentRef:e,onUpdate:t})=>{const[n,i]=(0,l.useState)(!1),[o,a]=(0,l.useState)(null),[r,c]=(0,l.useState)(""),[d,p]=(0,l.useState)(""),u=(0,s.useSelect)((e=>e(I).getPersonalizationTagsList()),[]);return(0,l.useEffect)((()=>{if(!e||!e.current)return;const t=e.current,n=e=>{const t=e.target.closest("a[data-link-href]");t&&(a(t),p(t.getAttribute("data-link-href")||""),c(t.textContent||""),i(!0))};return t.addEventListener("click",n),()=>{t.removeEventListener("click",n)}}),[e]),(0,m.jsx)(m.Fragment,{children:n&&o&&(0,m.jsx)(y.Popover,{position:"bottom left",onClose:()=>i(!1),anchor:o,className:"mailpoet-personalization-tag-popover",children:(0,m.jsxs)("div",{className:"mailpoet-personalization-tag-popover-content",children:[(0,m.jsx)(y.TextControl,{label:(0,_.__)("Link Text","mailpoet"),value:r,onChange:e=>c(e),__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0,autoComplete:"off"}),(0,m.jsx)(y.SelectControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,label:(0,_.__)("Link tag","mailpoet"),value:d,onChange:e=>{p(e)},options:u.filter((e=>e.category===(0,_.__)("Link","mailpoet"))).map((e=>({label:e.name,value:e.token})))}),(0,m.jsxs)("div",{className:"mailpoet-personalization-tag-popover-content-buttons",children:[(0,m.jsx)(y.Button,{isTertiary:!0,onClick:()=>{i(!1)},children:(0,_.__)("Cancel","mailpoet")}),(0,m.jsx)(y.Button,{isPrimary:!0,onClick:()=>{i(!1),t(o,d,r)},children:(0,_.__)("Update link","mailpoet")})]})]})})})};function D({contentRef:e}){const[t,n]=(0,l.useState)(!1),i=(0,s.useSelect)((e=>e("core/block-editor").getSelectedBlockClientId())),{updateBlockAttributes:o}=(0,s.useDispatch)("core/block-editor"),a=(0,s.useSelect)((e=>{const t=e("core/block-editor").getBlockAttributes(i);return t?.content?.originalHTML||t?.content||""})),r=(0,l.useCallback)(((t,n)=>{let{start:s,end:l}=f(e,a),r="";if(n){let e=(0,x.create)({html:a});e=(0,x.insert)(e,n,s,l),l=s+n.length,e=(0,x.applyFormat)(e,{type:"mailpoet-email-editor/link-shortcode",attributes:{"data-link-href":t,contenteditable:"false",style:"text-decoration: underline;"}},s,l),r=(0,x.toHTMLString)({value:e})}else{let e=(0,x.create)({html:a});e=(0,x.insert)(e,(0,x.create)({html:`\x3c!--${t}--\x3e&nbsp;`}),s,l),r=(0,x.toHTMLString)({value:e})}o(i,{content:r})}),[a,e,i,o]);return(0,m.jsx)(d.BlockControls,{children:(0,m.jsxs)(y.ToolbarGroup,{children:[(0,m.jsx)(y.ToolbarButton,{icon:"shortcode",title:(0,_.__)("Personalization Tags","mailpoet"),onClick:()=>{n(!0),E("block_controls_personalization_tags_button_clicked")}}),(0,m.jsx)(F,{contentRef:e,onUpdate:(e,t)=>{const n=a.replace(`\x3c!--[${e}]--\x3e`,`\x3c!--[${t}]--\x3e`);o(i,{content:n})}}),(0,m.jsx)(z,{contentRef:e,onUpdate:(e,t,n)=>{const s=e.getAttribute("data-link-href").replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),l=new RegExp(`<a([^>]*?)data-link-href="${s}"([^>]*?)>${e.textContent}</a>`,"gi"),r=a.replace(l,((e,i,o)=>`<a${i}data-link-href="${t}"${o}>${n}</a>`));o(i,{content:r})}}),(0,m.jsx)(R,{isOpened:t,onInsert:(e,t)=>{r(e,t),n(!1)},closeCallback:()=>n(!1),canInsertLink:!0,openedBy:"block-controls"})]})})}const O=(0,p.createHigherOrderComponent)((e=>t=>{const{attributes:n,setAttributes:i,name:o}=t,{content:a}=n,r=(0,s.useSelect)((e=>e(I).getPersonalizationTagsList()),[]),c=(0,l.useCallback)((()=>a?v(a,r):""),[a,r]),d=(0,l.useCallback)((e=>{if(void 0!==e.content){const t=v(e.content,r);i({...e,content:t})}else i(e)}),[r,i]);return"core/paragraph"===o||"core/heading"===o||"core/list-item"===o?(0,m.jsx)(e,{...t,attributes:{...n,content:c()},setAttributes:d}):(0,m.jsx)(e,{...t})}),"personalizationTagsLiveContentUpdate");var V=n(894),H=n.n(V);const G=window.wp.blocks,$=window.wp.primitives,U=(0,m.jsx)($.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,m.jsx)($.Path,{d:"M9 9v6h11V9H9zM4 20h1.5V4H4v16z"})}),W=(0,m.jsx)($.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,m.jsx)($.Path,{d:"M12.5 15v5H11v-5H4V9h7V4h1.5v5h7v6h-7Z"})}),q=(0,m.jsx)($.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,m.jsx)($.Path,{d:"M4 15h11V9H4v6zM18.5 4v16H20V4h-1.5z"})}),Z="__experimentalEmailFlexLayout";function Y(e){return(0,G.hasBlockSupport)(e,Z)}function J({justificationValue:e,onChange:t,isToolbar:n=!1}){const i=[{value:"left",icon:U,label:(0,_.__)("Justify items left","mailpoet")},{value:"center",icon:W,label:(0,_.__)("Justify items center","mailpoet")},{value:"right",icon:q,label:(0,_.__)("Justify items right","mailpoet")}];if(n){const n=i.map((e=>e.value));return(0,m.jsx)(d.JustifyContentControl,{value:e,onChange:t,allowedControls:n,popoverProps:{placement:"bottom-start"}})}return(0,m.jsx)(y.__experimentalToggleGroupControl,{__nextHasNoMarginBottom:!0,label:(0,_.__)("Justification","mailpoet"),value:e,onChange:t,className:"block-editor-hooks__flex-layout-justification-controls",children:i.map((({value:e,icon:t,label:n})=>(0,m.jsx)(y.__experimentalToggleGroupControlOptionIcon,{value:e,icon:t,label:n},e)))})}function X({setAttributes:e,attributes:t,name:n}){if(!(0,G.getBlockSupport)(n,Z,{}))return null;const{justifyContent:i="left"}=t.layout||{},o=n=>{e({layout:{...t.layout,justifyContent:n}})};return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(d.InspectorControls,{children:(0,m.jsx)(y.PanelBody,{title:(0,_.__)("Layout","mailpoet"),children:(0,m.jsx)(y.Flex,{children:(0,m.jsx)(y.FlexItem,{children:(0,m.jsx)(J,{justificationValue:i,onChange:o})})})})}),(0,m.jsx)(d.BlockControls,{group:"block",__experimentalShareWithChildBlocks:!0,children:(0,m.jsx)(J,{justificationValue:i,onChange:o,isToolbar:!0})})]})}function K(e){return Y(e.name)?{...e,attributes:{...e.attributes,layout:{type:"object"}}}:e}const Q=(0,p.createHigherOrderComponent)((e=>t=>[Y(t.name)&&(0,m.jsx)(X,{...t},"layout"),(0,m.jsx)(e,{...t},"edit")]),"withLayoutControls");function ee({block:e,props:t}){const{attributes:n}=t,{layout:i}=n,o=`is-content-justification-${i?.justifyContent||"left"}`,a=H()(o,"is-layout-email-flex is-layout-flex");return(0,m.jsx)(e,{...t,className:a})}const te=(0,p.createHigherOrderComponent)((e=>function(t){return Y(t.name)?(0,m.jsx)(ee,{block:e,props:t}):(0,m.jsx)(e,{...t})}),"withLayoutStyles"),ne=window.wp.editor,ie=window.wp.coreData,oe=window.wp.mediaUtils;function ae(e){var t,n,i="";if("string"==typeof e||"number"==typeof e)i+=e;else if("object"==typeof e)if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(n=ae(e[t]))&&(i&&(i+=" "),i+=n)}else for(n in e)e[n]&&(i&&(i+=" "),i+=n);return i}const se=function(){for(var e,t,n=0,i="",o=arguments.length;n<o;n++)(e=arguments[n])&&(t=ae(e))&&(i&&(i+=" "),i+=t);return i},le=(0,m.jsx)($.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,m.jsx)($.Path,{d:"M16.7 7.1l-6.3 8.5-3.3-2.5-.9 1.2 4.5 3.4L17.9 8z"})}),re=(0,m.jsx)($.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,m.jsx)($.Path,{d:"M11.776 4.454a.25.25 0 01.448 0l2.069 4.192a.25.25 0 00.188.137l4.626.672a.25.25 0 01.139.426l-3.348 3.263a.25.25 0 00-.072.222l.79 4.607a.25.25 0 01-.362.263l-4.138-2.175a.25.25 0 00-.232 0l-4.138 2.175a.25.25 0 01-.363-.263l.79-4.607a.25.25 0 00-.071-.222L4.754 9.881a.25.25 0 01.139-.426l4.626-.672a.25.25 0 00.188-.137l2.069-4.192z"})}),ce=(0,m.jsx)($.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,m.jsx)($.Path,{fillRule:"evenodd",d:"M9.706 8.646a.25.25 0 01-.188.137l-4.626.672a.25.25 0 00-.139.427l3.348 3.262a.25.25 0 01.072.222l-.79 4.607a.25.25 0 00.362.264l4.138-2.176a.25.25 0 01.233 0l4.137 2.175a.25.25 0 00.363-.263l-.79-4.607a.25.25 0 01.072-.222l3.347-3.262a.25.25 0 00-.139-.427l-4.626-.672a.25.25 0 01-.188-.137l-2.069-4.192a.25.25 0 00-.448 0L9.706 8.646zM12 7.39l-.948 1.921a1.75 1.75 0 01-1.317.957l-2.12.308 1.534 1.495c.412.402.6.982.503 1.55l-.362 2.11 1.896-.997a1.75 1.75 0 011.629 0l1.895.997-.362-2.11a1.75 1.75 0 01.504-1.55l1.533-1.495-2.12-.308a1.75 1.75 0 01-1.317-.957L12 7.39z",clipRule:"evenodd"})}),de=window.wp.viewport,pe=window.wp.preferences,me=(0,m.jsx)($.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,m.jsx)($.Path,{d:"M12 13.06l3.712 3.713 1.061-1.06L13.061 12l3.712-3.712-1.06-1.06L12 10.938 8.288 7.227l-1.061 1.06L10.939 12l-3.712 3.712 1.06 1.061L12 13.061z"})}),ue=window.wp.deprecated;var _e=n.n(ue);function he(e){return["core/edit-post","core/edit-site"].includes(e)?(_e()(`${e} interface scope`,{alternative:"core interface scope",hint:"core/edit-post and core/edit-site are merging.",version:"6.6"}),"core"):e}function ge(e,t){return"core"===e&&"edit-site/template"===t?(_e()("edit-site/template sidebar",{alternative:"edit-post/document",version:"6.6"}),"edit-post/document"):"core"===e&&"edit-site/block-inspector"===t?(_e()("edit-site/block-inspector sidebar",{alternative:"edit-post/block",version:"6.6"}),"edit-post/block"):t}const xe=(e,t)=>({type:"SET_DEFAULT_COMPLEMENTARY_AREA",scope:e=he(e),area:t=ge(e,t)}),ye=(e,t)=>({registry:n,dispatch:i})=>{t&&(e=he(e),t=ge(e,t),n.select(pe.store).get(e,"isComplementaryAreaVisible")||n.dispatch(pe.store).set(e,"isComplementaryAreaVisible",!0),i({type:"ENABLE_COMPLEMENTARY_AREA",scope:e,area:t}))},fe=e=>({registry:t})=>{e=he(e),t.select(pe.store).get(e,"isComplementaryAreaVisible")&&t.dispatch(pe.store).set(e,"isComplementaryAreaVisible",!1)},ve=(e,t)=>({registry:n})=>{if(!t)return;e=he(e),t=ge(e,t);const i=n.select(pe.store).get(e,"pinnedItems");!0!==i?.[t]&&n.dispatch(pe.store).set(e,"pinnedItems",{...i,[t]:!0})},be=(e,t)=>({registry:n})=>{if(!t)return;e=he(e),t=ge(e,t);const i=n.select(pe.store).get(e,"pinnedItems");n.dispatch(pe.store).set(e,"pinnedItems",{...i,[t]:!1})};function je(e,t){return function({registry:n}){_e()("dispatch( 'core/interface' ).toggleFeature",{since:"6.0",alternative:"dispatch( 'core/preferences' ).toggle"}),n.dispatch(pe.store).toggle(e,t)}}function we(e,t,n){return function({registry:i}){_e()("dispatch( 'core/interface' ).setFeatureValue",{since:"6.0",alternative:"dispatch( 'core/preferences' ).set"}),i.dispatch(pe.store).set(e,t,!!n)}}function Se(e,t){return function({registry:n}){_e()("dispatch( 'core/interface' ).setFeatureDefaults",{since:"6.0",alternative:"dispatch( 'core/preferences' ).setDefaults"}),n.dispatch(pe.store).setDefaults(e,t)}}function ke(e){return{type:"OPEN_MODAL",name:e}}function Ce(){return{type:"CLOSE_MODAL"}}const Te=(0,s.createRegistrySelector)((e=>(t,n)=>{n=he(n);const i=e(pe.store).get(n,"isComplementaryAreaVisible");if(void 0!==i)return!1===i?null:t?.complementaryAreas?.[n]})),Ee=(0,s.createRegistrySelector)((e=>(t,n)=>{n=he(n);const i=e(pe.store).get(n,"isComplementaryAreaVisible"),o=t?.complementaryAreas?.[n];return i&&void 0===o})),Ne=(0,s.createRegistrySelector)((e=>(t,n,i)=>{var o;i=ge(n=he(n),i);const a=e(pe.store).get(n,"pinnedItems");return null===(o=a?.[i])||void 0===o||o})),Pe=(0,s.createRegistrySelector)((e=>(t,n,i)=>(_e()("select( 'core/interface' ).isFeatureActive( scope, featureName )",{since:"6.0",alternative:"select( 'core/preferences' ).get( scope, featureName )"}),!!e(pe.store).get(n,i))));function Ie(e,t){return e.activeModal===t}const Me=(0,s.combineReducers)({complementaryAreas:function(e={},t){switch(t.type){case"SET_DEFAULT_COMPLEMENTARY_AREA":{const{scope:n,area:i}=t;return e[n]?e:{...e,[n]:i}}case"ENABLE_COMPLEMENTARY_AREA":{const{scope:n,area:i}=t;return{...e,[n]:i}}}return e},activeModal:function(e=null,t){switch(t.type){case"OPEN_MODAL":return t.name;case"CLOSE_MODAL":return null}return e}}),Be=(0,s.createReduxStore)("core/interface",{reducer:Me,actions:e,selectors:t});(0,s.register)(Be);const Ae=(0,window.wp.plugins.withPluginContext)(((e,t)=>({icon:t.icon||e.icon,identifier:t.identifier||`${e.name}/${t.name}`}))),Le=Ae((function({as:e=y.Button,scope:t,identifier:n,icon:i,selectedIcon:o,name:a,...l}){const r=e,c=(0,s.useSelect)((e=>e(Be).getActiveComplementaryArea(t)===n),[n,t]),{enableComplementaryArea:d,disableComplementaryArea:p}=(0,s.useDispatch)(Be);return(0,m.jsx)(r,{icon:o&&c?o:i,"aria-controls":n.replace("/",":"),onClick:()=>{c?p(t):d(t,n)},...l})})),Re=({smallScreenTitle:e,children:t,className:n,toggleButtonProps:i})=>{const o=(0,m.jsx)(Le,{icon:me,...i});return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("div",{className:"components-panel__header interface-complementary-area-header__small",children:[e&&(0,m.jsx)("h2",{className:"interface-complementary-area-header__small-title",children:e}),o]}),(0,m.jsxs)("div",{className:se("components-panel__header","interface-complementary-area-header",n),tabIndex:-1,children:[t,o]})]})},Fe=()=>{};function ze({name:e,as:t=y.Button,onClick:n,...i}){return(0,m.jsx)(y.Fill,{name:e,children:({onClick:e})=>(0,m.jsx)(t,{onClick:n||e?(...t)=>{(n||Fe)(...t),(e||Fe)(...t)}:void 0,...i})})}ze.Slot=function({name:e,as:t=y.ButtonGroup,fillProps:n={},bubblesVirtually:i,...o}){return(0,m.jsx)(y.Slot,{name:e,bubblesVirtually:i,fillProps:n,children:e=>{if(!l.Children.toArray(e).length)return null;const n=[];l.Children.forEach(e,(({props:{__unstableExplicitMenuItem:e,__unstableTarget:t}})=>{t&&e&&n.push(t)}));const i=l.Children.map(e,(e=>!e.props.__unstableExplicitMenuItem&&n.includes(e.props.__unstableTarget)?null:e));return(0,m.jsx)(t,{...o,children:i})}})};const De=ze,Oe=({__unstableExplicitMenuItem:e,__unstableTarget:t,...n})=>(0,m.jsx)(y.MenuItem,{...n});function Ve({scope:e,target:t,__unstableExplicitMenuItem:n,...i}){return(0,m.jsx)(Le,{as:i=>(0,m.jsx)(De,{__unstableExplicitMenuItem:n,__unstableTarget:`${e}/${t}`,as:Oe,name:`${e}/plugin-more-menu`,...i}),role:"menuitemcheckbox",selectedIcon:le,name:t,scope:e,...i})}function He({scope:e,...t}){return(0,m.jsx)(y.Fill,{name:`PinnedItems/${e}`,...t})}He.Slot=function({scope:e,className:t,...n}){return(0,m.jsx)(y.Slot,{name:`PinnedItems/${e}`,...n,children:e=>e?.length>0&&(0,m.jsx)("div",{className:se(t,"interface-pinned-items"),children:e})})};const Ge=He,$e={open:{width:280},closed:{width:0},mobileOpen:{width:"100vw"}};function Ue({activeArea:e,isActive:t,scope:n,children:i,className:o,id:a}){const s=(0,p.useReducedMotion)(),r=(0,p.useViewportMatch)("medium","<"),c=(0,p.usePrevious)(e),d=(0,p.usePrevious)(t),[,u]=(0,l.useState)({});(0,l.useEffect)((()=>{u({})}),[t]);const _={type:"tween",duration:s||r||c&&e&&e!==c?0:.3,ease:[.6,0,.4,1]};return(0,m.jsx)(y.Fill,{name:`ComplementaryArea/${n}`,children:(0,m.jsx)(y.__unstableAnimatePresence,{initial:!1,children:(d||t)&&(0,m.jsx)(y.__unstableMotion.div,{variants:$e,initial:"closed",animate:r?"mobileOpen":"open",exit:"closed",transition:_,className:"interface-complementary-area__fill",children:(0,m.jsx)("div",{id:a,className:o,style:{width:r?"100vw":280},children:i})})})})}const We=Ae((function({children:e,className:t,closeLabel:n=(0,_.__)("Close plugin"),identifier:i,header:o,headerClassName:a,icon:r,isPinnable:c=!0,panelClassName:d,scope:p,name:u,smallScreenTitle:h,title:g,toggleShortcut:x,isActiveByDefault:f}){const[v,b]=(0,l.useState)(!1),{isLoading:j,isActive:w,isPinned:S,activeArea:k,isSmall:C,isLarge:T,showIconLabels:E}=(0,s.useSelect)((e=>{const{getActiveComplementaryArea:t,isComplementaryAreaLoading:n,isItemPinned:o}=e(Be),{get:a}=e(pe.store),s=t(p);return{isLoading:n(p),isActive:s===i,isPinned:o(p,i),activeArea:s,isSmall:e(de.store).isViewportMatch("< medium"),isLarge:e(de.store).isViewportMatch("large"),showIconLabels:a("core","showIconLabels")}}),[i,p]);!function(e,t,n,i,o){const a=(0,l.useRef)(!1),r=(0,l.useRef)(!1),{enableComplementaryArea:c,disableComplementaryArea:d}=(0,s.useDispatch)(Be);(0,l.useEffect)((()=>{i&&o&&!a.current?(d(e),r.current=!0):r.current&&!o&&a.current?(r.current=!1,c(e,t)):r.current&&n&&n!==t&&(r.current=!1),o!==a.current&&(a.current=o)}),[i,o,e,t,n,d,c])}(p,i,k,w,C);const{enableComplementaryArea:N,disableComplementaryArea:P,pinItem:I,unpinItem:M}=(0,s.useDispatch)(Be);if((0,l.useEffect)((()=>{f&&void 0===k&&!C?N(p,i):void 0===k&&C&&P(p,i),b(!0)}),[k,f,p,i,C,N,P]),v)return(0,m.jsxs)(m.Fragment,{children:[c&&(0,m.jsx)(Ge,{scope:p,children:S&&(0,m.jsx)(Le,{scope:p,identifier:i,isPressed:w&&(!E||T),"aria-expanded":w,"aria-disabled":j,label:g,icon:E?le:r,showTooltip:!E,variant:E?"tertiary":void 0,size:"compact"})}),u&&c&&(0,m.jsx)(Ve,{target:u,scope:p,icon:r,children:g}),(0,m.jsxs)(Ue,{activeArea:k,isActive:w,className:se("interface-complementary-area",t),scope:p,id:i.replace("/",":"),children:[(0,m.jsx)(Re,{className:a,closeLabel:n,onClose:()=>P(p),smallScreenTitle:h,toggleButtonProps:{label:n,size:"small",shortcut:x,scope:p,identifier:i},children:o||(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("h2",{className:"interface-complementary-area-header__title",children:g}),c&&(0,m.jsx)(y.Button,{className:"interface-complementary-area__pin-unpin-item",icon:S?re:ce,label:S?(0,_.__)("Unpin from toolbar"):(0,_.__)("Pin to toolbar"),onClick:()=>(S?M:I)(p,i),isPressed:S,"aria-expanded":S,size:"compact"})]})}),(0,m.jsx)(y.Panel,{className:d,children:e})]})]})}));We.Slot=function({scope:e,...t}){return(0,m.jsx)(y.Slot,{name:`ComplementaryArea/${e}`,...t})};const qe=We,Ze=({isActive:e})=>((0,l.useEffect)((()=>{let e=!1;return document.body.classList.contains("sticky-menu")&&(e=!0,document.body.classList.remove("sticky-menu")),()=>{e&&document.body.classList.add("sticky-menu")}}),[]),(0,l.useEffect)((()=>(e?document.body.classList.add("is-fullscreen-mode"):document.body.classList.remove("is-fullscreen-mode"),()=>{e&&document.body.classList.remove("is-fullscreen-mode")})),[e]),null);function Ye({children:e,className:t,ariaLabel:n,as:i="div",...o}){return(0,m.jsx)(i,{className:se("interface-navigable-region",t),"aria-label":n,role:"region",tabIndex:"-1",...o,children:e})}const Je={type:"tween",duration:.25,ease:[.6,0,.4,1]},Xe={hidden:{opacity:1,marginTop:-60},visible:{opacity:1,marginTop:0},distractionFreeHover:{opacity:1,marginTop:0,transition:{...Je,delay:.2,delayChildren:.2}},distractionFreeHidden:{opacity:0,marginTop:-60},distractionFreeDisabled:{opacity:0,marginTop:0,transition:{...Je,delay:.8,delayChildren:.8}}},Ke=(0,l.forwardRef)((function({isDistractionFree:e,footer:t,header:n,editorNotices:i,sidebar:o,secondarySidebar:a,content:s,actions:r,labels:c,className:d,enableRegionNavigation:u=!0,shortcuts:h},g){const[x,f]=(0,p.useResizeObserver)(),v=(0,p.useViewportMatch)("medium","<"),b={type:"tween",duration:(0,p.useReducedMotion)()?0:.25,ease:[.6,0,.4,1]},j=(0,y.__unstableUseNavigateRegions)(h);!function(e){(0,l.useEffect)((()=>{const t=document&&document.querySelector(`html:not(.${e})`);if(t)return t.classList.toggle(e),()=>{t.classList.toggle(e)}}),[e])}("interface-interface-skeleton__html-container");const w={
/* translators: accessibility text for the top bar landmark region. */
header:(0,_._x)("Header","header landmark area"),
/* translators: accessibility text for the content landmark region. */
body:(0,_.__)("Content"),
/* translators: accessibility text for the secondary sidebar landmark region. */
secondarySidebar:(0,_.__)("Block Library"),
/* translators: accessibility text for the settings landmark region. */
sidebar:(0,_.__)("Settings"),
/* translators: accessibility text for the publish landmark region. */
actions:(0,_.__)("Publish"),
/* translators: accessibility text for the footer landmark region. */
footer:(0,_.__)("Footer"),...c};return(0,m.jsxs)("div",{...u?j:{},ref:(0,p.useMergeRefs)([g,u?j.ref:void 0]),className:se(d,"interface-interface-skeleton",j.className,!!t&&"has-footer"),children:[(0,m.jsxs)("div",{className:"interface-interface-skeleton__editor",children:[(0,m.jsx)(y.__unstableAnimatePresence,{initial:!1,children:!!n&&(0,m.jsx)(Ye,{as:y.__unstableMotion.div,className:"interface-interface-skeleton__header","aria-label":w.header,initial:e?"distractionFreeHidden":"hidden",whileHover:e?"distractionFreeHover":"visible",animate:e?"distractionFreeDisabled":"visible",exit:e?"distractionFreeHidden":"hidden",variants:Xe,transition:b,children:n})}),e&&(0,m.jsx)("div",{className:"interface-interface-skeleton__header",children:i}),(0,m.jsxs)("div",{className:"interface-interface-skeleton__body",children:[(0,m.jsx)(y.__unstableAnimatePresence,{initial:!1,children:!!a&&(0,m.jsx)(Ye,{className:"interface-interface-skeleton__secondary-sidebar",ariaLabel:w.secondarySidebar,as:y.__unstableMotion.div,initial:"closed",animate:v?"mobileOpen":"open",exit:"closed",variants:{open:{width:f.width},closed:{width:0},mobileOpen:{width:"100vw"}},transition:b,children:(0,m.jsxs)("div",{style:{position:"absolute",width:v?"100vw":"fit-content",height:"100%",right:0},children:[x,a]})})}),(0,m.jsx)(Ye,{className:"interface-interface-skeleton__content",ariaLabel:w.body,children:s}),!!o&&(0,m.jsx)(Ye,{className:"interface-interface-skeleton__sidebar",ariaLabel:w.sidebar,children:o}),!!r&&(0,m.jsx)(Ye,{className:"interface-interface-skeleton__actions",ariaLabel:w.actions,children:r})]})]}),!!t&&(0,m.jsx)(Ye,{className:"interface-interface-skeleton__footer",ariaLabel:w.footer,children:t})]})}));var Qe=n(192),et=n.n(Qe);function tt(){const{globalStylePost:e}=(0,s.useSelect)((e=>({globalStylePost:e(I).getGlobalEmailStylesPost()})),[]),t=(0,l.useCallback)((t=>{e&&(0,s.dispatch)(ie.store).editEntityRecord("postType","wp_global_styles",e.id,{styles:t.styles,settings:t.settings})}),[e]);return{userTheme:{settings:e?.settings,styles:e?.styles},updateUserTheme:t}}const nt=window.wp.privateApis,{unlock:it}=(0,nt.__dangerousOptInToUnstableAPIsOnlyForCoreModules)("I acknowledge private features are not for use in themes or plugins and doing so will break in the next version of WordPress.","@wordpress/edit-site"),{ExperimentalBlockCanvas:ot}=it(d.privateApis),{Tabs:at}=it(y.privateApis),{ColorPanel:st}=it(d.privateApis),{useGlobalStylesOutputWithConfig:lt}=it(d.privateApis);function rt(){const{userTheme:e}=tt(),{editorTheme:t}=(0,s.useSelect)((e=>({editorTheme:e(I).getTheme()})),[]),n=(0,l.useMemo)((()=>et().all([{},t||{},e||{}])),[t,e]),[i]=lt(n);return[i||[]]}function ct(){const{hasEdits:e,autosaveInterval:t}=(0,s.useSelect)((e=>({hasEdits:e(I).hasEdits(),autosaveInterval:e(I).getAutosaveInterval()})),[]),{saveEditedEmail:n}=(0,s.useDispatch)(I);return(0,l.useEffect)((()=>{let i;return e&&t>0&&(i=setTimeout((()=>{n(),E("editor_content_auto_saved")}),1e3*t)),()=>{i&&clearTimeout(i)}}),[e,t,n]),null}const dt=(0,m.jsx)($.SVG,{width:"24",height:"24",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,m.jsx)($.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M18 4H6c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-4 14.5H6c-.3 0-.5-.2-.5-.5V6c0-.3.2-.5.5-.5h8v13zm4.5-.5c0 .3-.2.5-.5.5h-2.5v-13H18c.3 0 .5.2.5.5v12z"})});function pt(){const{isEditingTemplate:e}=(0,s.useSelect)((e=>({isEditingTemplate:"wp_template"===e(ne.store).getCurrentPostType()})),[]);return[e?"template":"email"]}const mt=l.forwardRef((function(e,t){const[n]=pt();return(0,m.jsxs)(at.TabList,{ref:t,children:[(0,m.jsx)(at.Tab,{tabId:M,children:"template"===n?(0,_.__)("Template","mailpoet"):(0,_.__)("Email","mailpoet")}),(0,m.jsx)(at.Tab,{tabId:B,children:(0,_.__)("Block","mailpoet")})]})})),ut=(0,r.applyFilters)("mailpoet_email_editor_setting_sidebar_extension_component",(function({label:e,labelSuffix:t,help:n,placeholder:i,attributeName:o,attributeValue:a,updateProperty:r=()=>{}}){const[c,p]=(0,l.useState)(null),[u,h]=(0,l.useState)(!1),g=(0,s.useSelect)((e=>e(I).getPersonalizationTagsList()),[]),b=(0,l.useRef)(null),j=(0,l.useCallback)(((e,t,n)=>{var i,a;const s=null!==(i=n?.start)&&void 0!==i?i:t.length,l=null!==(a=n?.end)&&void 0!==a?a:t.length;let c=(0,x.create)({html:t});c=(0,x.insert)(c,(0,x.create)({html:`\x3c!--${e}--\x3e`}),s,l);const d=(0,x.toHTMLString)({value:c});r(o,d),p(null)}),[o,r]),w=(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("span",{children:e}),(0,m.jsx)(y.Button,{className:"mailpoet-settings-panel-personalization-tags-button",icon:"shortcode",title:(0,_.__)("Personalization Tags","mailpoet"),onClick:()=>{h(!0),E("rich_text_with_button_personalization_tags_shortcode_icon_clicked",{attributeName:o,label:e})}}),t]});return o?(0,m.jsxs)(y.BaseControl,{id:"",label:w,className:`mailpoet-settings-panel-${o}-text`,help:n,__nextHasNoMarginBottom:!0,children:[(0,m.jsx)(R,{isOpened:u,onInsert:e=>{j(e,null!=a?a:"",c),h(!1),E("rich_text_with_button_personalization_tags_inserted",{attributeName:o,value:e})},closeCallback:()=>h(!1),openedBy:"RichTextWithButton-BaseControl"}),(0,m.jsx)(F,{contentRef:b,onUpdate:(e,t)=>{const n=(null!=a?a:"").replace(`\x3c!--[${e}]--\x3e`,`\x3c!--[${t}]--\x3e`);r(o,n)}}),(0,m.jsx)(d.RichText,{ref:b,className:"mailpoet-settings-panel-richtext",placeholder:i,onFocus:()=>{p(f(b,null!=a?a:""))},onKeyUp:()=>{p(f(b,null!=a?a:""))},onClick:()=>{p(f(b,null!=a?a:""))},onChange:e=>{var t;e=v(null!==(t=e)&&void 0!==t?t:"",g),r(o,e),N("rich_text_with_button_input_field_updated",{attributeName:o})},value:null!=a?a:"","data-automation-id":`email_${o}`})]}):null}));function _t(){return(0,m.jsx)(y.PanelBody,{title:(0,_.__)("Details","mailpoet"),className:"mailpoet-email-editor__settings-panel",onToggle:e=>E("details_panel_body_toggle",{opened:e}),children:(0,m.jsx)(m.Fragment,{children:(0,m.jsx)(ut,{})})})}const ht=(0,l.forwardRef)((function({icon:e,size:t=24,...n},i){return(0,l.cloneElement)(e,{width:t,height:t,...n,ref:i})})),gt=(0,m.jsx)($.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,m.jsx)($.Path,{fillRule:"evenodd",d:"M6.863 13.644L5 13.25h-.5a.5.5 0 01-.5-.5v-3a.5.5 0 01.5-.5H5L18 6.5h2V16h-2l-3.854-.815.026.008a3.75 3.75 0 01-7.31-1.549zm1.477.313a2.251 2.251 0 004.356.921l-4.356-.921zm-2.84-3.28L18.157 8h.343v6.5h-.343L5.5 11.823v-1.146z",clipRule:"evenodd"})});function xt({close:e}){N("edit_template_modal_opened");const{onNavigateToEntityRecord:t,template:n}=(0,s.useSelect)((e=>{const{getEditorSettings:t}=e(ne.store);return{onNavigateToEntityRecord:t().onNavigateToEntityRecord,template:e(I).getCurrentTemplate()}}),[]);return(0,m.jsxs)(y.Modal,{size:"medium",onRequestClose:e,__experimentalHideHeader:!0,children:[(0,m.jsx)("p",{children:(0,_.__)("Note that the same template can be used by multiple emails, so any changes made here may affect other emails on the site. To switch back to editing the page content click the ‘Back’ button in the toolbar.","mailpoet")}),(0,m.jsxs)(y.Flex,{justify:"end",children:[(0,m.jsx)(y.FlexItem,{children:(0,m.jsx)(y.Button,{variant:"tertiary",onClick:()=>{E("edit_template_modal_cancel_button_clicked"),e()},children:(0,_.__)("Cancel","mailpoet")})}),(0,m.jsx)(y.FlexItem,{children:(0,m.jsx)(y.Button,{variant:"primary",onClick:()=>{E("edit_template_modal_continue_button_clicked",{templateId:n.id}),t({postId:n.id,postType:"wp_template"})},disabled:!n.id,children:(0,_.__)("Continue","mailpoet")})})]})]})}const yt=[];function ft(e,t){return e.map((e=>"core/post-content"===e.name?{...e,name:"core/group",innerBlocks:t}:e.innerBlocks?.length?{...e,innerBlocks:ft(e.innerBlocks,t)}:e))}const vt={};const bt=(0,m.jsx)($.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,m.jsx)($.Path,{d:"M19 8h-1V6h-5v2h-2V6H6v2H5c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-8c0-1.1-.9-2-2-2zm.5 10c0 .3-.2.5-.5.5H5c-.3 0-.5-.2-.5-.5v-8c0-.3.2-.5.5-.5h14c.3 0 .5.2.5.5v8z"})}),jt=(0,m.jsx)($.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,m.jsx)($.Path,{d:"M12 3.2c-4.8 0-8.8 3.9-8.8 8.8 0 4.8 3.9 8.8 8.8 8.8 4.8 0 8.8-3.9 8.8-8.8 0-4.8-4-8.8-8.8-8.8zm0 16c-4 0-7.2-3.3-7.2-7.2C4.8 8 8 4.8 12 4.8s7.2 3.3 7.2 7.2c0 4-3.2 7.2-7.2 7.2zM11 17h2v-6h-2v6zm0-8h2V7h-2v2z"})}),wt=(0,window.wp.priorityQueue.createQueue)();function St({children:e,placeholder:t}){const[n,i]=(0,l.useState)(!1);return(0,l.useEffect)((()=>{const e={};return wt.add(e,(()=>{(0,l.flushSync)((()=>{i(!0)}))})),()=>{wt.cancel(e)}}),[]),n?e:t}function kt(){return(0,m.jsxs)("div",{className:"block-editor-inserter__no-results",children:[(0,m.jsx)(ht,{className:"block-editor-inserter__no-results-icon",icon:bt}),(0,m.jsx)("p",{children:(0,_.__)("No recent templates.","mailpoet")}),(0,m.jsx)("p",{children:(0,_.__)("Your recent creations will appear here as soon as you begin.","mailpoet")})]})}const Ct=(0,l.memo)((function({templates:e,onTemplateSelection:t,selectedCategory:n}){const{layout:i}=(0,s.useSelect)((e=>{const{getEditorSettings:t}=e(ne.store);return{layout:t().__experimentalFeatures.layout}})),[o]=rt(),a=o.reduce(((e,t)=>{var n;return e+(null!==(n=t.css)&&void 0!==n?n:"")}),"")+`.is-root-container { width: ${i.contentSize}; margin: 0 auto; }`;return"recent"===n&&0===e.length?(0,m.jsx)(kt,{}):(0,m.jsx)("div",{className:"block-editor-block-patterns-list",role:"listbox",children:e.map((e=>(0,m.jsx)("div",{className:"block-editor-block-patterns-list__list-item email-editor-pattern__list-item",children:(0,m.jsx)("div",{className:"block-editor-block-patterns-list__item",role:"button",tabIndex:0,onClick:()=>{t(e)},onKeyPress:n=>{"Enter"!==n.key&&" "!==n.key||t(e)},children:(0,m.jsxs)(St,{placeholder:(0,m.jsx)("p",{children:(0,_.__)("rendering template","mailpoet")}),children:[(0,m.jsx)(d.BlockPreview,{blocks:e.previewContentParsed,viewportWidth:900,minHeight:300,additionalStyles:[{css:a}]}),(0,m.jsx)(y.__experimentalHStack,{className:"block-editor-patterns__pattern-details",children:(0,m.jsx)("h4",{className:"block-editor-block-patterns-list__item-title",children:e.displayName})})]})})},`${e.slug}_${e.displayName}_${e.id}`)))})}),((e,t)=>e.templates.length===t.templates.length&&e.selectedCategory===t.selectedCategory));function Tt({templates:e,onTemplateSelection:t,selectedCategory:n}){const i=(0,l.useMemo)((()=>e.filter((e=>e.category===n))),[n,e]);return(0,m.jsxs)("div",{className:"block-editor-block-patterns-explorer__list",children:["recent"===n&&(0,m.jsx)("div",{className:"email-editor-recent-templates-info",children:(0,m.jsxs)(y.__experimentalHStack,{spacing:1,expanded:!1,justify:"start",children:[(0,m.jsx)(ht,{icon:jt}),(0,m.jsx)("p",{children:(0,_.__)("Templates created on the legacy editor will not appear here.","mailpoet")})]})}),(0,m.jsx)(Ct,{templates:i,onTemplateSelection:t,selectedCategory:n})]})}function Et({selectedCategory:e,templateCategories:t,onClickCategory:n}){const i="block-editor-block-patterns-explorer__sidebar";return(0,m.jsx)("div",{className:i,children:(0,m.jsx)("div",{className:`${i}__categories-list`,children:t.map((({name:t,label:o})=>(0,m.jsx)(y.Button,{label:o,className:`${i}__categories-list__item`,isPressed:e===t,onClick:()=>{n(t)},children:o},t)))})})}const Nt=[{name:"recent",label:"Recent"},{name:"basic",label:"Basic"}],Pt=(0,l.memo)((function({hasEmailPosts:e,templates:t,handleTemplateSelection:n,templateSelectMode:i}){const[o,a]=(0,l.useState)(Nt[1].name),s="swap"===i,r=Nt.filter((({name:e})=>"recent"!==e||!s));return(0,l.useEffect)((()=>{setTimeout((()=>{e&&!s&&a(Nt[0].name)}),1e3)}),[e,s]),(0,m.jsxs)("div",{className:"block-editor-block-patterns-explorer",children:[(0,m.jsx)(Et,{templateCategories:r,selectedCategory:o,onClickCategory:e=>{E("template_select_modal_category_change",{category:e}),a(e)}}),(0,m.jsx)(Tt,{templates:t,onTemplateSelection:n,selectedCategory:o})]})}));function It({onSelectCallback:e,closeCallback:t=null,previewContent:n=""}){const i=n?"swap":"new";N("template_select_modal_opened",{templateSelectMode:i});const[o,a,c]=function(e=""){const{templates:t,patterns:n,emailPosts:i,hasEmailPosts:o}=(0,s.useSelect)((e=>{const t=e(I).getSentEmailEditorPosts();return{templates:e(I).getEmailTemplates(),patterns:e(I).getBlockPatternsForEmailTemplate(),emailPosts:t,hasEmailPosts:!(!t||!t?.length)}}),[]),a=(0,l.useMemo)((()=>{let i=[];const o=e&&(0,G.parse)(e);if(i=o?[{blocks:o}]:n,!i||!t)return yt;const a=[];return t?.filter((e=>"email-general"!==e.slug))?.forEach((e=>{i?.forEach((t=>{let n=(0,G.parse)(e.content?.raw);n=ft(n,t.blocks),a.push({id:e.id,slug:e.slug,previewContentParsed:n,emailParsed:t.blocks,template:e,category:"basic",type:e.type,displayName:t.title?`${e.title.rendered} - ${t.title}`:e.title.rendered})}))})),a}),[t,n,e]),c=(0,l.useMemo)((()=>i?.map((e=>{const t=(0,r.applyFilters)("mailpoet_email_editor_preferred_template_title","",e),{postTemplateContent:n}=function(e,t=[]){const n=e.template,i={postTemplateContent:null};if(!n)return i;if(vt[n])return vt[n];const o=t.find((e=>e.slug===n));if(!o)return i;const a={postTemplateContent:o?.template};return vt[n]=a,a}(e,a),i=(0,G.parse)(e.content?.raw);let o=i;n?.content?.raw&&(o=ft((0,G.parse)(n?.content?.raw),i));const s={...e,title:{raw:e.title.raw,rendered:t||e.title.rendered}};return{id:e.id,slug:e.slug,previewContentParsed:o,emailParsed:i,category:"recent",type:e.type,displayName:s.title.rendered,template:s}}))),[i,a]);return[a||yt,c||yt,o]}(n),d=o?.length>0,p=t=>{const o=t.type===A,a=t.template;E("template_select_modal_template_selected",{templateSlug:t.slug,templateSelectMode:i,templateType:t.type}),n||(0,s.dispatch)(ne.store).resetEditorBlocks(t.emailParsed),(0,s.dispatch)(I).setTemplateToPost(o?a.template:t.slug),e()},u=()=>{var e;const t=null!==(e=o[0])&&void 0!==e?e:null;t&&(E("template_select_modal_handle_close_without_template_selected"),p(t))};return(0,m.jsxs)(y.Modal,{title:"new"===i?(0,_.__)("Start with an email preset","mailpoet"):(0,_.__)("Select a template","mailpoet"),onRequestClose:()=>(E("template_select_modal_closed",{templateSelectMode:i}),t?t():u()),isFullScreen:!0,children:[(0,m.jsx)(Pt,{hasEmailPosts:c,templates:[...o,...a],handleTemplateSelection:p,templateSelectMode:i}),(0,m.jsx)(y.Flex,{className:"email-editor-modal-footer",justify:"flex-end",children:(0,m.jsx)(y.FlexItem,{children:(0,m.jsx)(y.Button,{variant:"tertiary",className:"email-editor-start_from_scratch_button",onClick:()=>(E("template_select_modal_start_from_scratch_clicked"),u()),isBusy:!d,children:(0,_.__)("Start from scratch","mailpoet")})})})]})}function Mt(){const{template:e,currentEmailContent:t}=(0,s.useSelect)((e=>({template:e(I).getCurrentTemplate(),currentEmailContent:e(I).getEditedEmailContent()})),[]),[n,i]=(0,l.useState)(!1),[o,a]=(0,l.useState)(!1);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(y.Panel,{className:"mailpoet-email-sidebar-email-type-info",children:(0,m.jsxs)(y.PanelBody,{children:[(0,m.jsxs)(y.PanelRow,{children:[(0,m.jsx)("span",{className:"mailpoet-email-type-info-icon",children:(0,m.jsx)(ht,{icon:gt})}),(0,m.jsxs)("div",{className:"mailpoet-email-type-info-content",children:[(0,m.jsx)("h2",{children:(0,_.__)("Newsletter","mailpoet")}),(0,m.jsx)("span",{children:(0,_.__)("Send or schedule a newsletter to connect with your subscribers.","mailpoet")})]})]}),e&&(0,m.jsx)(y.PanelRow,{children:(0,m.jsxs)(y.Flex,{justify:"start",children:[(0,m.jsx)(y.FlexItem,{className:"editor-post-panel__row-label",children:(0,_.__)("Template","mailpoet")}),(0,m.jsx)(y.FlexItem,{children:(0,m.jsx)(y.DropdownMenu,{icon:null,text:e?.title,toggleProps:{variant:"tertiary"},label:(0,_.__)("Template actions","mailpoet"),onToggle:t=>E("sidebar_template_actions_clicked",{currentTemplate:e?.title,isOpen:t}),children:({onClose:e})=>(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(y.MenuItem,{onClick:()=>{E("sidebar_template_actions_edit_template_clicked"),i(!0),e()},children:(0,_.__)("Edit template","mailpoet")}),(0,m.jsx)(y.MenuItem,{onClick:()=>{E("sidebar_template_actions_swap_template_clicked"),a(!0),e()},children:(0,_.__)("Swap template","mailpoet")})]})})})]})})]})}),n&&(0,m.jsx)(xt,{close:()=>(E("edit_template_modal_closed"),i(!1))}),o&&(0,m.jsx)(It,{onSelectCallback:()=>a(!1),closeCallback:()=>a(!1),previewContent:t})]})}function Bt(){return(0,m.jsxs)(y.Panel,{children:[(0,m.jsx)(Mt,{}),(0,m.jsx)(_t,{})]})}const At=(0,m.jsx)($.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,m.jsx)($.Path,{d:"M18 5.5H6a.5.5 0 00-.5.5v3h13V6a.5.5 0 00-.5-.5zm.5 5H10v8h8a.5.5 0 00.5-.5v-7.5zm-10 0h-3V18a.5.5 0 00.5.5h2.5v-8zM6 4h12a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2z"})}),Lt=(0,m.jsx)($.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,m.jsx)($.Path,{d:"M13 19h-2v-2h2v2zm0-6h-2v-2h2v2zm0-6h-2V5h2v2z"})});function Rt({close:e}){const t=(0,s.useSelect)((e=>e(I).getCurrentTemplate()),[]),{revertAndSaveTemplate:n}=(0,s.useDispatch)(I);return(0,m.jsxs)(y.Modal,{size:"medium",onRequestClose:e,__experimentalHideHeader:!0,children:[(0,m.jsx)("p",{children:(0,_.__)("This will clear ANY and ALL template customization. All updates made to the template will be lost. Do you want to proceed?","mailpoet")}),(0,m.jsxs)(y.Flex,{justify:"end",children:[(0,m.jsx)(y.FlexItem,{children:(0,m.jsx)(y.Button,{variant:"tertiary",onClick:e,children:(0,_.__)("Cancel","mailpoet")})}),(0,m.jsx)(y.FlexItem,{children:(0,m.jsx)(y.Button,{variant:"primary",onClick:async()=>{await n(t),e()},children:(0,_.__)("Reset","mailpoet")})})]})]})}function Ft(){const e=(0,s.useSelect)((e=>e(I).getCurrentTemplate()),[]),[t,n]=(0,l.useState)(!1),i=e?.description||"";return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(y.Panel,{className:"mailpoet-email-sidebar-email-type-info",children:(0,m.jsx)(y.PanelBody,{children:(0,m.jsxs)(y.PanelRow,{children:[(0,m.jsx)("span",{className:"mailpoet-email-type-info-icon",children:(0,m.jsx)(ht,{icon:At})}),(0,m.jsxs)("div",{className:"mailpoet-email-type-info-content",children:[(0,m.jsxs)("div",{className:"mailpoet-email-type-info-content-heading",children:[(0,m.jsx)("h2",{children:e?.title||(0,_.__)("Template","mailpoet")}),(0,m.jsx)(y.DropdownMenu,{icon:Lt,label:(0,_.__)("Template actions","mailpoet"),children:({onClose:e})=>(0,m.jsx)(y.MenuItem,{onClick:()=>{n(!0),e()},info:(0,_.__)("Reset to default to clear all customizations","mailpoet"),children:(0,_.__)("Reset","mailpoet")})})]}),i&&(0,m.jsx)("p",{children:i||""}),(0,m.jsx)("p",{children:(0,_.__)("Edit this template to be used across multiple emails.","mailpoet")})]})]})})}),t&&(0,m.jsx)(Rt,{close:()=>{n(!1)}})]})}function zt(){return(0,m.jsx)(y.Panel,{children:(0,m.jsx)(Ft,{})})}function Dt(e){const[t]=pt(),n=(0,l.useRef)(null),i=(0,l.useContext)(at.Context);return(0,m.jsx)(qe,{identifier:"email-editor/editor/main",closeLabel:(0,_.__)("Close sidebar","mailpoet"),headerClassName:"editor-sidebar__panel-tabs",className:"edit-post-sidebar",header:(0,m.jsx)(at.Context.Provider,{value:i,children:(0,m.jsx)(mt,{ref:n})}),icon:dt,scope:I,smallScreenTitle:(0,_.__)("No title","mailpoet"),isActiveByDefault:!0,...e,children:(0,m.jsxs)(at.Context.Provider,{value:i,children:[(0,m.jsx)(at.TabPanel,{tabId:M,children:"template"===t?(0,m.jsx)(zt,{}):(0,m.jsx)(Bt,{})}),(0,m.jsx)(at.TabPanel,{tabId:B,children:(0,m.jsx)(d.BlockInspector,{})})]})})}const Ot=(0,l.memo)((function(e){const{toggleSettingsSidebarActiveTab:t}=(0,s.useDispatch)(I),{activeTab:n,selectedBlockId:i}=(0,s.useSelect)((e=>({activeTab:e(I).getSettingsSidebarActiveTab(),selectedBlockId:e(d.store).getSelectedBlockClientId()})),[]);return(0,l.useEffect)((()=>{t(i?B:M)}),[i,t]),(0,m.jsx)(at,{selectedTabId:n||M,onSelect:e=>(E("sidebar_tab_selected",{tabKey:e}),t(e)),children:(0,m.jsx)(Dt,{...e})})})),Vt=e=>{const t=(0,G.getBlockSupport)(e,"background");return t&&!1!==t?.backgroundImage};function Ht(){const e=(0,s.useSelect)((e=>e("core/block-editor").getSelectedBlock()),[]),t=(0,G.hasBlockSupport)(e?.name,"border",!1)||(0,G.hasBlockSupport)(e?.name,"__experimentalBorder",!1);return(0,m.jsxs)(m.Fragment,{children:[t&&(0,m.jsx)(y.Fill,{name:"InspectorControlsBorder",children:(0,m.jsx)(y.Notice,{className:"mailpoet-grid-full-width",status:"warning",isDismissible:!1,children:(0,_.__)("Border display may vary or be unsupported in some email clients.","mailpoet")})}),Vt(e?.name)&&(0,m.jsx)(y.Fill,{name:"InspectorControlsBackground",children:(0,m.jsx)(y.Notice,{className:"mailpoet-grid-full-width",status:"warning",isDismissible:!1,children:(0,_.__)("Select a background color for email clients that do not support background images.","mailpoet")})})]})}const Gt=(0,m.jsx)($.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,m.jsx)($.Path,{d:"M11 12.5V17.5H12.5V12.5H17.5V11H12.5V6H11V11H6V12.5H11Z"})}),$t=(0,m.jsx)($.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,m.jsx)($.Path,{d:"M18.3 11.7c-.6-.6-1.4-.9-2.3-.9H6.7l2.9-3.3-1.1-1-4.5 5L8.5 16l1-1-2.7-2.7H16c.5 0 .9.2 1.3.5 1 1 1 3.4 1 4.5v.3h1.5v-.2c0-1.5 0-4.3-1.5-5.7z"})}),Ut=(0,m.jsx)($.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,m.jsx)($.Path,{d:"M15.6 6.5l-1.1 1 2.9 3.3H8c-.9 0-1.7.3-2.3.9-1.4 1.5-1.4 4.2-1.4 5.6v.2h1.5v-.3c0-1.1 0-3.5 1-4.5.3-.3.7-.5 1.3-.5h9.2L14.5 15l1.1 1.1 4.6-4.6-4.6-5z"})}),Wt=(0,m.jsx)($.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,m.jsx)($.Path,{d:"M3 6h11v1.5H3V6Zm3.5 5.5h11V13h-11v-1.5ZM21 17H10v1.5h11V17Z"})}),qt=(0,m.jsx)($.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,m.jsx)($.Path,{d:"M6.6 6L5.4 7l4.5 5-4.5 5 1.1 1 5.5-6-5.4-6zm6 0l-1.1 1 4.5 5-4.5 5 1.1 1 5.5-6-5.5-6z"})}),Zt=(0,m.jsx)($.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,m.jsx)($.Path,{d:"M11.6 7l-1.1-1L5 12l5.5 6 1.1-1L7 12l4.6-5zm6 0l-1.1-1-5.5 6 5.5 6 1.1-1-4.6-5 4.6-5z"})}),Yt=window.wp.keycodes,Jt=window.wp.notices;function Xt({onClose:e,onRemove:t,postId:n}){const{getLastEntityDeleteError:i}=(0,s.useSelect)(ie.store),{deleteEntityRecord:o}=(0,s.useDispatch)(ie.store),{createErrorNotice:a}=(0,s.useDispatch)(Jt.store),l=()=>{e()};return(0,m.jsxs)(y.Modal,{className:"mailpoet-move-to-trash-modal",title:(0,_.__)("Move to trash","mailpoet"),onRequestClose:()=>{l(),E("trash_modal_closed")},focusOnMount:!0,children:[(0,m.jsx)("p",{children:(0,_.__)("Are you sure you want to move this email to trash?","mailpoet")}),(0,m.jsxs)("div",{className:"mailpoet-send-preview-modal-footer",children:[(0,m.jsx)(y.Button,{variant:"tertiary",onClick:()=>{l(),E("trash_modal_cancel_button_clicked")},children:(0,_.__)("Cancel","mailpoet")}),(0,m.jsx)(y.Button,{variant:"primary",onClick:async()=>{if(E("trash_modal_move_to_trash_button_clicked"),await o("postType",A,n,{},{throwOnError:!1}))t();else{const e=i("postType",A,n);if(410===e?.code)t();else{const t=e?.message?e.message:(0,_.__)("An error occurred while moving the email to the trash.","mailpoet");E("trash_modal_move_to_trash_error",{errorMessage:t}),await a(t,{type:"snackbar",isDismissible:!0,context:"email-editor"})}}},children:(0,_.__)("Move to trash","mailpoet")})]})]})}function Kt(){const[e,t]=(0,l.useState)(!1),{urls:n,postId:i}=(0,s.useSelect)((e=>({urls:e(I).getUrls(),postId:e(I).getEmailPostId()})),[]),[o,a]=(0,ie.useEntityProp)("postType",A,"status"),{saveEditedEmail:r}=(0,s.useDispatch)(I);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(y.DropdownMenu,{className:"edit-site-more-menu",popoverProps:{className:"edit-site-more-menu__content"},icon:Lt,label:(0,_.__)("More","mailpoet"),onToggle:e=>E("header_more_menu_dropdown_toggle",{isOpened:e}),children:({onClose:e})=>(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(y.MenuGroup,{label:(0,_._x)("View","noun","mailpoet"),children:[(0,m.jsx)(pe.PreferenceToggleMenuItem,{scope:"core",name:"fixedToolbar",label:(0,_.__)("Top toolbar","mailpoet"),info:(0,_.__)("Access all block and document tools in a single place","mailpoet"),messageActivated:(0,_.__)("Top toolbar activated","mailpoet"),messageDeactivated:(0,_.__)("Top toolbar deactivated","mailpoet"),onToggle:()=>E("header_more_menu_fixed_toolbar_toggle")}),(0,m.jsx)(pe.PreferenceToggleMenuItem,{scope:"core",name:"focusMode",label:(0,_.__)("Spotlight mode","mailpoet"),info:(0,_.__)("Focus at one block at a time","mailpoet"),messageActivated:(0,_.__)("Spotlight mode activated","mailpoet"),messageDeactivated:(0,_.__)("Spotlight mode deactivated","mailpoet"),onToggle:()=>E("header_more_menu_focus_mode_toggle")}),(0,m.jsx)(pe.PreferenceToggleMenuItem,{scope:I,name:"fullscreenMode",label:(0,_.__)("Fullscreen mode","mailpoet"),info:(0,_.__)("Work without distraction","mailpoet"),messageActivated:(0,_.__)("Fullscreen mode activated","mailpoet"),messageDeactivated:(0,_.__)("Fullscreen mode deactivated","mailpoet"),shortcut:Yt.displayShortcut.secondary("f"),onToggle:()=>E("header_more_menu_fullscreen_mode_toggle")})]}),(0,m.jsx)(y.MenuGroup,{children:"trash"===o?(0,m.jsx)(y.MenuItem,{onClick:async()=>{await a("draft"),await r(),E("header_more_menu_restore_from_trash_button_clicked")},children:(0,_.__)("Restore from trash","mailpoet")}):(0,m.jsx)(y.MenuItem,{onClick:()=>{t(!0),E("header_more_menu_move_to_trash_button_clicked"),e()},isDestructive:!0,children:(0,_.__)("Move to trash","mailpoet")})})]})}),e&&(0,m.jsx)(Xt,{onClose:()=>t(!1),onRemove:()=>{window.location.href=n.listings},postId:i})]})}const Qt=(0,m.jsx)($.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,m.jsx)($.Path,{d:"M15 4H9c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h6c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm.5 14c0 .3-.2.5-.5.5H9c-.3 0-.5-.2-.5-.5V6c0-.3.2-.5.5-.5h6c.3 0 .5.2.5.5v12zm-4.5-.5h2V16h-2v1.5z"})}),en=(0,m.jsx)($.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,m.jsx)($.Path,{d:"M20.5 16h-.7V8c0-1.1-.9-2-2-2H6.2c-1.1 0-2 .9-2 2v8h-.7c-.8 0-1.5.7-1.5 1.5h20c0-.8-.7-1.5-1.5-1.5zM5.7 8c0-.3.2-.5.5-.5h11.6c.3 0 .5.2.5.5v7.6H5.7V8z"})}),tn=(0,m.jsx)($.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,m.jsx)($.Path,{d:"M19.5 4.5h-7V6h4.44l-5.97 5.97 1.06 1.06L18 7.06v4.44h1.5v-7Zm-13 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2v-3H17v3a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h3V5.5h-3Z"})}),nn=window.wp.url;let on=function(e){return e.SUCCESS="success",e.ERROR="error",e}({});const an=(0,r.applyFilters)("mailpoet_email_editor_check_sending_method_configuration_link","admin.php?page=mailpoet-settings#mta"),sn=(0,l.memo)((function(){const e=(0,l.useRef)(null),{requestSendingNewsletterPreview:t,togglePreviewModal:n,updateSendPreviewEmail:i}=(0,s.useDispatch)(I),{toEmail:o,isSendingPreviewEmail:a,sendingPreviewStatus:r,isModalOpened:c,errorMessage:d}=(0,s.useSelect)((e=>e(I).getPreviewState()),[]),p=()=>{t(o)},u=()=>{E("send_preview_email_modal_closed"),n(!1)};return(0,l.useEffect)((()=>{c&&(e.current?.focus(),E("send_preview_email_modal_opened"))}),[c]),c?(0,m.jsxs)(y.Modal,{className:"mailpoet-send-preview-email",title:(0,_.__)("Send a test email","mailpoet"),onRequestClose:u,focusOnMount:!1,children:[r===on.ERROR?(0,m.jsxs)("div",{className:"mailpoet-send-preview-modal-notice-error",children:[(0,m.jsx)("p",{children:(0,_.__)("Sorry, we were unable to send this email.","mailpoet")}),(0,m.jsx)("strong",{children:d&&(0,_.sprintf)(
// translators: %s is an error message.
// translators: %s is an error message.
(0,_.__)("Error: %s","mailpoet"),d)}),(0,m.jsxs)("ul",{children:[(0,m.jsx)("li",{children:an&&(0,l.createInterpolateElement)((0,_.__)("Please check your <link>sending method configuration</link> with your hosting provider.","mailpoet"),{link:(0,m.jsx)("a",{href:an,target:"_blank",rel:"noopener noreferrer",onClick:()=>E("send_preview_email_modal_check_sending_method_configuration_link_clicked")})})}),(0,m.jsx)("li",{children:(0,l.createInterpolateElement)((0,_.__)("Or, sign up for MailPoet Sending Service to easily send emails. <link>Sign up for free</link>","mailpoet"),{link:(0,m.jsx)("a",{href:`https://account.mailpoet.com/?s=1&g=1&utm_source=mailpoet_email_editor&utm_medium=plugin&utm_source_platform=${A}`,target:"_blank",rel:"noopener noreferrer",onClick:()=>E("send_preview_email_modal_sign_up_for_mailpoet_sending_service_link_clicked")},"sign-up-for-free")})})]})]}):null,(0,m.jsx)("p",{children:(0,l.createInterpolateElement)((0,_.__)("Send yourself a test email to test how your email would look like in different email apps. You can also test your spam score by sending a test email to <link1>{$serviceName}</link1>. <link2>Learn more</link2>.","mailpoet").replace("{$serviceName}","Mail Tester"),{link1:(0,m.jsx)("a",{href:"https://www.mail-tester.com/",target:"_blank",rel:"noopener noreferrer",onClick:()=>E("send_preview_email_modal_send_test_email_to_mail_tester_link_clicked")}),link2:(0,m.jsx)("a",{href:"https://kb.mailpoet.com/article/147-test-your-spam-score-with-mail-tester",target:"_blank",rel:"noopener noreferrer",onClick:()=>E("send_preview_email_modal_learn_more_about_mail_tester_link_clicked")})})}),(0,m.jsx)(y.TextControl,{label:(0,_.__)("Send to","mailpoet"),onChange:e=>{i(e),N("send_preview_email_modal_send_to_field_updated")},onKeyDown:e=>{const{keyCode:t}=e;t===Yt.ENTER&&(e.preventDefault(),p(),E("send_preview_email_modal_send_to_field_key_code_enter"))},value:o,type:"email",ref:e,required:!0}),r===on.SUCCESS?(0,m.jsxs)("p",{className:"mailpoet-send-preview-modal-notice-success",children:[(0,m.jsx)(ht,{icon:le,style:{fill:"#4AB866"}}),(0,_.__)("Test email sent successfully!","mailpoet")]}):null,(0,m.jsxs)("div",{className:"mailpoet-send-preview-modal-footer",children:[(0,m.jsx)(y.Button,{variant:"tertiary",onClick:()=>{E("send_preview_email_modal_close_button_clicked"),u()},children:(0,_.__)("Close","mailpoet")}),(0,m.jsx)(y.Button,{variant:"primary",onClick:()=>{p(),E("send_preview_email_modal_send_test_email_button_clicked")},disabled:a||!(0,nn.isEmail)(o),children:a?(0,_.__)("Sending…","mailpoet"):(0,_.__)("Send test email","mailpoet")})]})]}):null}));function ln(){const e=(0,s.useSelect)((e=>e(I).getDeviceType()),[]),{changePreviewDeviceType:t,togglePreviewModal:n}=(0,s.useDispatch)(I),i=e=>{t(e)},o={mobile:Qt,desktop:en};return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(y.DropdownMenu,{className:"mailpoet-preview-dropdown",label:(0,_.__)("Preview","mailpoet"),icon:o[e.toLowerCase()],onToggle:e=>E("header_preview_dropdown_clicked",{isOpened:e}),children:({onClose:t})=>(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(y.MenuGroup,{children:[(0,m.jsx)(y.MenuItem,{className:"block-editor-post-preview__button-resize",onClick:()=>{i("Desktop"),E("header_preview_dropdown_desktop_selected")},icon:"Desktop"===e&&le,children:(0,_.__)("Desktop","mailpoet")}),(0,m.jsx)(y.MenuItem,{className:"block-editor-post-preview__button-resize",onClick:()=>{i("Mobile"),E("header_preview_dropdown_mobile_selected")},icon:"Mobile"===e&&le,children:(0,_.__)("Mobile","mailpoet")})]}),(0,m.jsx)(y.MenuGroup,{children:(0,m.jsx)(y.MenuItem,{className:"block-editor-post-preview__button-resize",onClick:()=>{n(!0),E("header_preview_dropdown_send_test_email_selected"),t()},children:(0,_.__)("Send a test email","mailpoet")})}),(0,m.jsx)(y.MenuGroup,{children:(0,m.jsx)("div",{className:"edit-post-header-preview__grouping-external",children:(0,m.jsx)(ne.PostPreviewButton,{role:"menuitem",forceIsAutosaveable:!0,"aria-label":(0,_.__)("Preview in new tab","mailpoet"),textContent:(0,m.jsxs)(m.Fragment,{children:[(0,_.__)("Preview in new tab","mailpoet"),(0,m.jsx)(ht,{icon:tn})]}),onPreview:()=>{E("header_preview_dropdown_preview_in_new_tab_selected"),t()}})})})]})}),(0,m.jsx)(sn,{})]})}const rn=(0,m.jsx)($.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,m.jsx)($.Path,{d:"M17.3 10.1c0-2.5-2.1-4.4-4.8-4.4-2.2 0-4.1 1.4-4.6 3.3h-.2C5.7 9 4 10.7 4 12.8c0 2.1 1.7 3.8 3.7 3.8h9c1.8 0 3.2-1.5 3.2-3.3.1-1.6-1.1-2.9-2.6-3.2zm-.5 5.1h-9c-1.2 0-2.2-1.1-2.2-2.3s1-2.4 2.2-2.4h1.3l.3-1.1c.4-1.3 1.7-2.2 3.2-2.2 1.8 0 3.3 1.3 3.3 2.9v1.3l1.3.2c.8.1 1.4.9 1.4 1.8-.1 1-.9 1.8-1.8 1.8z"})});function cn(){const{saveEditedEmail:e}=(0,s.useDispatch)(I),{hasEdits:t,isEmpty:n,isSaving:i}=(0,s.useSelect)((e=>({hasEdits:e(I).hasEdits(),isEmpty:e(I).isEmpty(),isSaving:e(I).isSaving()})),[]),o=!n&&!i&&!t,a=!t&&(n||i||o);let l=(0,_.__)("Save Draft","mailpoet");return o?l=(0,_.__)("Saved","mailpoet"):i&&(l=(0,_.__)("Saving","mailpoet")),(0,m.jsxs)(y.Button,{variant:"tertiary",disabled:a,onClick:()=>{e(),E("header_save_email_button_clicked",{label:l,isSaving:i,isSaved:o})},children:[i&&(0,m.jsx)(ht,{icon:rn}),o&&(0,m.jsx)(ht,{icon:le}),l]})}const dn=(0,m.jsx)($.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,m.jsx)($.Path,{d:"M17.5 11.6L12 16l-5.5-4.4.9-1.2L12 14l4.5-3.6 1 1.2z"})});function pn(){const{showIconLabels:e}=(0,s.useSelect)((e=>({showIconLabels:e(I).isFeatureActive("showIconLabels"),postId:e(I).getEmailPostId()})),[]),[t="",n]=(0,ie.useEntityProp)("postType",A,"title"),i=(0,l.useRef)(null);return(0,m.jsx)("div",{ref:i,className:"mailpoet-email-editor-campaign-name",children:(0,m.jsx)(y.Dropdown,{popoverProps:{placement:"bottom",anchor:i.current},contentClassName:"mailpoet-email-editor-campaign-name-dropdown",renderToggle:({isOpen:n,onToggle:i})=>(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(y.Button,{onClick:()=>{i(),E("header_campaign_name_email_title_clicked",{isOpen:n})},className:"mailpoet-email-campaign-name-link",children:(0,m.jsxs)(y.__experimentalText,{size:"body",as:"h1",children:[(0,m.jsx)(y.VisuallyHidden,{as:"span",children:(0,_.__)("Editing email:","mailpoet")}),t]})}),(0,m.jsx)(y.Button,{className:"mailpoet-email-campaign-name__toggle",icon:dn,"aria-expanded":n,"aria-haspopup":"true",onClick:()=>{i(),E("header_campaign_name_toggle_icon_clicked",{isOpen:n})},label:(0,_.__)("Change campaign name","mailpoet"),children:e&&(0,_.__)("Rename","mailpoet")})]}),renderContent:()=>(0,m.jsx)("div",{className:"mailpoet-email-editor-email-title-edit",children:(0,m.jsx)(y.TextControl,{label:(0,_.__)("Campaign name","mailpoet"),value:t,onChange:e=>{n(e),N("header_campaign_name_title_updated")},name:"campaign_name",help:(0,_.__)("Name your email campaign to indicate its purpose. This would only be visible to you and not shown to your subscribers.","mailpoet")})})})})}function mn({validateContent:e,isContentInvalid:t}){const{isDirty:n}=(0,ne.useEntitiesSavedStatesIsDirty)(),{hasEmptyContent:i,isEmailSent:o,urls:a}=(0,s.useSelect)((e=>({hasEmptyContent:e(I).hasEmptyContent(),isEmailSent:e(I).isEmailSent(),urls:e(I).getUrls()})),[]);function l(){a.send&&(window.location.href=a.send)}const[c]=pt(),d="template"===c||i||o||t||n,p=(0,r.applyFilters)("mailpoet_email_editor_send_button_label",(0,_.__)("Send","mailpoet"));return(0,m.jsx)(y.Button,{variant:"primary",onClick:()=>{E("header_send_button_clicked"),e()&&(0,r.applyFilters)("mailpoet_email_editor_send_action_callback",l)()},disabled:d,"data-automation-id":"email_editor_send_button",children:p})}const un=({onToggle:e})=>((0,l.useEffect)((()=>{document.querySelectorAll(".mailpoet-email-editor-save-button-dropdown  .components-panel__body").forEach((e=>{const t=e.querySelector(".components-panel__body-title button");if(t&&t.textContent.trim()===(0,_.__)("Templates","mailpoet")){const t=e.querySelectorAll(".components-panel__row");t.length&&(t[0].textContent=(0,_.__)("This change will affect emails that use this template.","mailpoet"))}}))}),[]),(0,m.jsx)(ne.EntitiesSavedStates,{close:e}));function hn(){const{isSaving:e}=(0,s.useSelect)((e=>({isSaving:e(I).isSaving()})),[]),t=(0,l.useRef)(null);let n=(0,_.__)("Save","mailpoet");return e&&(n=(0,_.__)("Saving","mailpoet")),(0,m.jsx)("div",{ref:t,children:(0,m.jsx)(y.Dropdown,{popoverProps:{placement:"bottom",anchor:t.current},contentClassName:"mailpoet-email-editor-save-button-dropdown",renderToggle:({onToggle:t})=>(0,m.jsx)(y.Button,{onClick:()=>{E("header_save_all_button_save_button_clicked"),t()},variant:"primary",disabled:e,children:n}),renderContent:({onToggle:e})=>(0,m.jsx)(un,{onToggle:e})})})}const gn=window.wp.isShallowEqual;var xn=n.n(gn);function yn(e){const t=(0,l.useRef)(e);return xn()(e,t.current)||(t.current=e),t.current}const fn=()=>{const e="email-validation",t=(0,s.useSelect)((t=>t(Jt.store).getNotices(e)));return{notices:t,hasValidationNotice:(0,l.useCallback)((e=>e?void 0!==t.find((t=>t.id===e)):t?.length>0),[t]),addValidationNotice:(0,l.useCallback)(((t,n,i=[])=>{(0,s.dispatch)(Jt.store).createNotice("error",n,{id:t,isDismissible:!1,actions:i,context:e})}),[e]),removeValidationNotice:(0,l.useCallback)((t=>{(0,s.dispatch)(Jt.store).removeNotice(t,e)}),[e])}},vn=[],bn=y.ToolbarItem,jn=d.BlockToolbar;function wn(){const e=(0,l.useRef)(),t=(0,l.useRef)(),n=(0,l.useRef)(),i=(0,l.useRef)(),[o,a]=(0,l.useState)(!1),{undo:c,redo:p}=(0,s.useDispatch)(ie.store),{setIsInserterOpened:u,setIsListViewOpened:h}=(0,s.useDispatch)(ne.store),{isInserterSidebarOpened:g,isListviewSidebarOpened:x,isFixedToolbarActive:f,isBlockSelected:v,hasUndo:b,hasRedo:j}=(0,s.useSelect)((e=>({isInserterSidebarOpened:e(ne.store).isInserterOpened(),isListviewSidebarOpened:e(ne.store).isListViewOpened(),isFixedToolbarActive:e(pe.store).get("core","fixedToolbar"),isBlockSelected:!!e(d.store).getBlockSelectionStart(),hasUndo:e(ie.store).hasUndo(),hasRedo:e(ie.store).hasRedo()})),[]),[w]=pt(),{validateContent:S,isInvalid:k}=(()=>{const{addValidationNotice:e,hasValidationNotice:t,removeValidationNotice:n}=fn(),{editedContent:i,editedTemplateContent:o}=(0,s.useSelect)((e=>({editedContent:e(I).getEditedEmailContent(),editedTemplateContent:e(I).getCurrentTemplateContent()}))),a=(0,r.applyFilters)("mailpoet_email_editor_content_validation_rules",vn),c=yn(i),d=yn(o),p=(0,l.useCallback)((()=>{let i=!0;return a.forEach((({id:o,testContent:a,message:s,actions:l})=>{a(c+d)?(e(o,s,l),i=!1):t(o)&&n(o)})),i}),[c,d,e,n,t,a]);return(0,s.subscribe)((()=>{t()&&p()}),ie.store),{isInvalid:t(),validateContent:p}})(),{dirtyEntityRecords:C}=(0,ne.useEntitiesSavedStatesIsDirty)(),T=C.some((e=>e.name!==A)),N=e=>{e.preventDefault()},P=g?(0,_.__)("Close","mailpoet"):(0,_.__)("Add","mailpoet");return(0,m.jsxs)("div",{className:"editor-header edit-post-header",children:[(0,m.jsxs)("div",{className:"editor-header__toolbar",children:[(0,m.jsx)(d.NavigableToolbar,{className:"editor-document-tools edit-post-header-toolbar is-unstyled","aria-label":(0,_.__)("Email document tools","mailpoet"),children:(0,m.jsxs)("div",{className:"editor-document-tools__left",children:[(0,m.jsx)(bn,{ref:e,as:y.Button,className:"editor-header-toolbar__inserter-toggle edit-post-header-toolbar__inserter-toggle",variant:"primary",isPressed:g,onMouseDown:N,onClick:()=>g?(E("header_inserter_sidebar_closed"),u(!1)):(E("header_inserter_sidebar_opened"),u(!0)),disabled:!1,icon:Gt,label:P,showTooltip:!0,"aria-expanded":g}),(0,m.jsx)(bn,{ref:n,as:y.Button,className:"editor-history__undo",isPressed:!1,onMouseDown:N,onClick:()=>{c(),E("header_undo_icon_clicked")},disabled:!b,icon:$t,label:(0,_.__)("Undo","mailpoet"),showTooltip:!0}),(0,m.jsx)(bn,{ref:i,as:y.Button,className:"editor-history__redo",isPressed:!1,onMouseDown:N,onClick:()=>{p(),E("header_redo_icon_clicked")},disabled:!j,icon:Ut,label:(0,_.__)("Redo","mailpoet"),showTooltip:!0}),(0,m.jsx)(bn,{ref:t,as:y.Button,className:"editor-header-toolbar__document-overview-toggle edit-post-header-toolbar__document-overview-toggle",isPressed:x,onMouseDown:N,onClick:()=>x?(E("header_listview_sidebar_closed"),h(!1)):(E("header_listview_sidebar_opened"),h(!0)),disabled:!1,icon:Wt,label:(0,_.__)("List view","mailpoet"),showTooltip:!0,"aria-expanded":g})]})}),f&&v&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{className:H()("editor-collapsible-block-toolbar",{"is-collapsed":o}),children:(0,m.jsx)(jn,{hideDragHandle:!0})}),(0,m.jsx)(y.Button,{className:"editor-header__block-tools-toggle edit-post-header__block-tools-toggle",icon:o?qt:Zt,onClick:()=>{a((e=>!e)),E("header_blocks_tool_button_clicked",{isBlockToolsCollapsed:o})},label:o?(0,_.__)("Show block tools","mailpoet"):(0,_.__)("Hide block tools","mailpoet")})]})]}),(!f||!v||o)&&(0,m.jsx)("div",{className:"editor-header__center edit-post-header__center",children:"template"===w?(0,m.jsx)(ne.DocumentBar,{}):(0,m.jsx)(pn,{})}),(0,m.jsxs)("div",{className:"editor-header__settings edit-post-header__settings",children:[(0,m.jsx)(cn,{}),(0,m.jsx)(ln,{}),T?(0,m.jsx)(hn,{}):(0,m.jsx)(mn,{validateContent:S,isContentInvalid:k}),(0,m.jsx)(Ge.Slot,{scope:I}),(0,m.jsx)(Kt,{})]})]})}function Sn(){return(0,m.jsx)("div",{className:"editor-list-view-sidebar",children:(0,m.jsx)(d.__experimentalListView,{})})}function kn(){const{postContentId:e}=(0,s.useSelect)((e=>{const t=e(d.store).getBlocks();return{postContentId:t.find((e=>"core/post-content"===e.name))?.clientId}})),[t]=pt(),{setIsInserterOpened:n}=(0,s.useDispatch)(ne.store);return(0,m.jsx)("div",{className:"editor-inserter-sidebar",children:(0,m.jsx)("div",{className:"editor-inserter-sidebar__content",children:(0,m.jsx)(d.__experimentalLibrary,{showMostUsedBlocks:!0,showInserterHelpPanel:!1,rootClientId:"email"===t?e:null,onClose:()=>{n(!1),E("inserter_sidebar_library_close_icon_clicked",{editorMode:t})},onSelect:e=>{E("inserter_sidebar_library_block_selected",{editorMode:t,blockName:e?.name})}})})})}function Cn(){const{isEmailSent:e}=(0,s.useSelect)((e=>({isEmailSent:e(I).isEmailSent()})),[]);return(0,l.useEffect)((()=>{e&&((0,s.dispatch)(Jt.store).createNotice("warning",(0,_.__)("This email has already been sent. It can be edited, but not sent again. Duplicate this email if you want to send it again.","mailpoet"),{id:"email-sent",isDismissible:!1,context:"email-editor"}),E("editor_showed_email_sent_notice"))}),[e]),null}function Tn(){const{notices:e}=fn();return 0===e.length?null:(0,m.jsx)(y.Notice,{status:"error",className:"mailpoet-email-editor-validation-errors components-editor-notices__pinned",isDismissible:!1,children:(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("strong",{children:(0,_.__)("Fix errors to continue:","mailpoet")}),(0,m.jsx)("ul",{children:e.map((({id:e,content:t,actions:n})=>(0,m.jsxs)("li",{children:[t,n.length>0?n.map((({label:e,onClick:t})=>(0,m.jsx)(y.Button,{onClick:t,variant:"link",children:e},e))):null]},e)))})]})})}function En({context:e="email-editor"}){const{notices:t}=(0,s.useSelect)((t=>({notices:t(Jt.store).getNotices(e)})),[e]),n=(0,l.useMemo)((()=>({"site-editor-save-success":{content:(0,_.__)("Email design updated.","mailpoet"),removeActions:!0}})),[]),{removeNotice:i}=(0,s.useDispatch)(Jt.store),o=t.filter((({type:e})=>"snackbar"===e)).map((e=>n[e.id]?{...e,content:n[e.id].content,actions:n[e.id].removeActions?[]:e.actions}:e));return(0,m.jsx)(y.SnackbarList,{notices:o,className:"components-editor-notices__snackbar",onRemove:t=>i(t,e)})}function Nn(){const{notices:e}=(0,s.useSelect)((e=>({notices:e(Jt.store).getNotices("email-editor")})),[]),{removeNotice:t}=(0,s.useDispatch)(Jt.store),n=e.filter((({isDismissible:e,type:t})=>e&&"default"===t)),i=e.filter((({isDismissible:e,type:t})=>!e&&"default"===t));return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(y.NoticeList,{notices:i,className:"components-editor-notices__pinned"}),(0,m.jsx)(y.NoticeList,{notices:n,className:"components-editor-notices__dismissible",onRemove:e=>t(e,"email-editor")}),(0,m.jsx)(Tn,{}),(0,m.jsx)(En,{context:"global"}),(0,m.jsx)(En,{context:"email-editor"})]})}const Pn=(0,m.jsx)($.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,m.jsx)($.Path,{d:"M12 4c-4.4 0-8 3.6-8 8v.1c0 4.1 3.2 7.5 7.2 7.9h.8c4.4 0 8-3.6 8-8s-3.6-8-8-8zm0 15V5c3.9 0 7 3.1 7 7s-3.1 7-7 7z"})}),In=(0,m.jsx)($.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,m.jsx)($.Path,{d:"M6.9 7L3 17.8h1.7l1-2.8h4.1l1 2.8h1.7L8.6 7H6.9zm-.7 6.6l1.5-4.3 1.5 4.3h-3zM21.6 17c-.1.1-.2.2-.3.2-.1.1-.2.1-.4.1s-.3-.1-.4-.2c-.1-.1-.1-.3-.1-.6V12c0-.5 0-1-.1-1.4-.1-.4-.3-.7-.5-1-.2-.2-.5-.4-.9-.5-.4 0-.8-.1-1.3-.1s-1 .1-1.4.2c-.4.1-.7.3-1 .4-.2.2-.4.3-.6.5-.1.2-.2.4-.2.7 0 .3.1.5.2.8.2.2.4.3.8.3.3 0 .6-.1.8-.3.2-.2.3-.4.3-.7 0-.3-.1-.5-.2-.7-.2-.2-.4-.3-.6-.4.2-.2.4-.3.7-.4.3-.1.6-.1.8-.1.3 0 .6 0 .8.1.2.1.4.3.5.5.1.2.2.5.2.9v1.1c0 .3-.1.5-.3.6-.2.2-.5.3-.9.4-.3.1-.7.3-1.1.4-.4.1-.8.3-1.1.5-.3.2-.6.4-.8.7-.2.3-.3.7-.3 1.2 0 .6.2 1.1.5 1.4.3.4.9.5 1.6.5.5 0 1-.1 1.4-.3.4-.2.8-.6 1.1-1.1 0 .4.1.7.3 1 .2.3.6.4 1.2.4.4 0 .7-.1.9-.2.2-.1.5-.3.7-.4h-.3zm-3-.9c-.2.4-.5.7-.8.8-.3.2-.6.2-.8.2-.4 0-.6-.1-.9-.3-.2-.2-.3-.6-.3-1.1 0-.5.1-.9.3-1.2s.5-.5.8-.7c.3-.2.7-.3 1-.5.3-.1.6-.3.7-.6v3.4z"})}),Mn=(0,m.jsx)($.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,m.jsx)($.Path,{d:"M17.2 10.9c-.5-1-1.2-2.1-2.1-3.2-.6-.9-1.3-1.7-2.1-2.6L12 4l-1 1.1c-.6.9-1.3 1.7-2 2.6-.8 1.2-1.5 2.3-2 3.2-.6 1.2-1 2.2-1 3 0 3.4 2.7 6.1 6.1 6.1s6.1-2.7 6.1-6.1c0-.8-.3-1.8-1-3zm-5.1 7.6c-2.5 0-4.6-2.1-4.6-4.6 0-.3.1-1 .8-2.3.5-.9 1.1-1.9 2-3.1.7-.9 1.3-1.7 1.8-2.3.7.8 1.3 1.6 1.8 2.3.8 1.1 1.5 2.2 2 3.1.7 1.3.8 2 .8 2.3 0 2.5-2.1 4.6-4.6 4.6z"})}),Bn={start:{scale:1,opacity:1},hover:{scale:0,opacity:0}},An={hover:{opacity:1},start:{opacity:.5}},Ln={hover:{scale:1,opacity:1},start:{scale:0,opacity:0}};function Rn({label:e,isFocused:t,withHoverView:n}){const{styles:i,colors:o}=(0,s.useSelect)((e=>({styles:e(I).getStyles(),colors:e(I).getPaletteColors()})),[]),a=i?.color?.background||"#ffffff",r=i?.elements?.heading?.typography?.fontFamily||"inherit",c=i?.elements?.heading?.color?.text||"inherit",d=i?.elements?.heading?.typography?.fontWeight||"inherit",p=o.theme.concat(o.theme),u=p.filter((({color:e})=>e.toLowerCase()!==a.toLowerCase()&&e.toLowerCase()!==c.toLowerCase())).slice(0,2),[_,h]=(0,l.useState)(!1);return(0,m.jsx)("div",{onMouseEnter:()=>h(!0),onMouseLeave:()=>h(!1),children:(0,m.jsxs)(y.__unstableMotion.div,{style:{height:152,width:"100%",background:a,cursor:n?"pointer":void 0},initial:"start",animate:(_||t)&&e?"hover":"start",children:[(0,m.jsx)(y.__unstableMotion.div,{variants:Bn,style:{height:"100%",overflow:"hidden"},children:(0,m.jsxs)(y.__experimentalHStack,{spacing:10,justify:"center",style:{height:"100%",overflow:"hidden"},children:[(0,m.jsx)(y.__unstableMotion.div,{style:{fontFamily:r,fontSize:65,color:c,fontWeight:d},animate:{scale:1,opacity:1},initial:{scale:.1,opacity:0},transition:{delay:.3,type:"tween"},children:"Aa"}),(0,m.jsx)(y.__experimentalVStack,{spacing:4,children:u.map((({slug:e,color:t},n)=>(0,m.jsx)(y.__unstableMotion.div,{style:{height:32,width:32,background:t,borderRadius:16},animate:{scale:1,opacity:1},initial:{scale:.1,opacity:0},transition:{delay:1===n?.2:.1}},e)))})]})}),(0,m.jsx)(y.__unstableMotion.div,{variants:n&&An,style:{height:"100%",width:"100%",position:"absolute",top:0,overflow:"hidden",filter:"blur(60px)",opacity:.1},children:(0,m.jsx)(y.__experimentalHStack,{spacing:0,justify:"flex-start",style:{height:"100%",overflow:"hidden"},children:p.slice(0,4).map((({color:e})=>(0,m.jsx)("div",{style:{height:"100%",background:e,flexGrow:1}},e)))})}),(0,m.jsx)(y.__unstableMotion.div,{variants:Ln,style:{height:"100%",width:"100%",overflow:"hidden",position:"absolute",top:0},children:(0,m.jsx)(y.__experimentalVStack,{spacing:3,justify:"center",style:{height:"100%",overflow:"hidden",padding:10,boxSizing:"border-box"},children:e&&(0,m.jsx)("div",{style:{fontSize:40,fontFamily:r,color:c,fontWeight:d,lineHeight:"1em",textAlign:"center"},children:e})})})]})})}function Fn(){return(0,m.jsx)(y.Card,{size:"small",className:"edit-site-global-styles-screen-root",variant:"primary",children:(0,m.jsx)(y.CardBody,{children:(0,m.jsxs)(y.__experimentalVStack,{spacing:4,children:[(0,m.jsx)(y.Card,{children:(0,m.jsx)(y.CardMedia,{children:(0,m.jsx)(Rn,{})})}),(0,m.jsxs)(y.__experimentalItemGroup,{children:[(0,m.jsx)(y.__experimentalNavigatorButton,{path:"/typography",onClick:()=>E("styles_sidebar_navigation_click",{path:"typography"}),children:(0,m.jsx)(y.__experimentalItem,{children:(0,m.jsxs)(y.__experimentalHStack,{justify:"flex-start",children:[(0,m.jsx)(y.Icon,{icon:In,size:24}),(0,m.jsx)(y.FlexItem,{children:(0,_.__)("Typography","mailpoet")})]})})}),(0,m.jsx)(y.__experimentalNavigatorButton,{path:"/colors",onClick:()=>E("styles_sidebar_navigation_click",{path:"colors"}),children:(0,m.jsx)(y.__experimentalItem,{children:(0,m.jsxs)(y.__experimentalHStack,{justify:"flex-start",children:[(0,m.jsx)(y.Icon,{icon:Mn,size:24}),(0,m.jsx)(y.FlexItem,{children:(0,_.__)("Colors","mailpoet")})]})})}),(0,m.jsx)(y.__experimentalNavigatorButton,{path:"/layout",onClick:()=>E("styles_sidebar_navigation_click",{path:"layout"}),children:(0,m.jsx)(y.__experimentalItem,{children:(0,m.jsxs)(y.__experimentalHStack,{justify:"flex-start",children:[(0,m.jsx)(y.Icon,{icon:At,size:24}),(0,m.jsx)(y.FlexItem,{children:(0,_.__)("Layout","mailpoet")})]})})})]})]})})})}function zn(e){const t=e=>{if("object"==typeof e&&null!==e||void 0===e){if(Array.isArray(e)&&0===e.length)return;for(const n in e)if(e.hasOwnProperty(n)){const i=t(e[n]);void 0===i?delete e[n]:e[n]=i}}return e};return t(e)}const Dn=()=>{const{userTheme:e,updateUserTheme:t}=tt(),n=(0,l.useMemo)((()=>zn(function(e){const t=e=>{if("object"==typeof e&&null!==e)for(const n in e)e.hasOwnProperty(n)&&(e[n]=t(e[n]));else if("string"==typeof e)return e.replace(/var\(--([a-z]+)--([a-z]+(?:--[a-z0-9]+(?:-[a-z0-9]+)*)*)--([a-z0-9-]+)\)/g,((e,t,n,i)=>`var:${n.split("--").concat(i).join("|")}`));return e};return t(e)}(e?.styles))),[e]),{styles:i}=(0,s.useSelect)((e=>({styles:e(I).getStyles()}))),o=(0,l.useCallback)((n=>{const i={...e,styles:zn(n)};t(i)}),[t,e]),a=(0,l.useCallback)(((n,i)=>{const o=function(e,t,n){const i=Array.isArray(t)?[...t]:[t],o=Array.isArray(e)?[...e]:{...e},a=i.pop();let s=o;return i.forEach((e=>{const t=s[e];s[e]=Array.isArray(t)?[...t]:{...t},s=s[e]})),s[a]=n,o}(e,["styles",...n],i);t(o)}),[t,e]);return{styles:et().all([i||{},n||{}]),userStyles:e?.styles,defaultStyles:i,updateStyleProp:a,updateStyles:o}},On={typography:{},color:{}},Vn=(e,t,n="heading",i=!1)=>{switch(t){case"text":return{typography:e.typography,color:e.color};case"heading":return((e,t="heading",n=!1)=>n?et().all([On,e.elements.heading||{},e.elements[t]||{}]):{...On,...e.elements.heading||{},...e.elements[t]||{}})(e,null!=n?n:"heading",i);default:return e.elements[t]||On}};function Hn({element:e,label:t}){const{styles:n}=Dn(),i=Vn(n,e,null,!0),{fontFamily:o,fontStyle:a,fontWeight:s,letterSpacing:l,textDecoration:r,textTransform:c}=i.typography,d=i.color?.text||"inherit",p=i.color?.background||"#f0f0f0",u=(0,_.sprintf)(
// translators: %s: is a subset of Typography, e.g., 'text' or 'links'.
// translators: %s: is a subset of Typography, e.g., 'text' or 'links'.
(0,_.__)("Typography %s styles","mailpoet"),t);return(0,m.jsx)(y.__experimentalItem,{children:(0,m.jsx)(y.__experimentalNavigatorButton,{path:`/typography/${e}`,"aria-label":u,onClick:()=>E("styles_sidebar_screen_typography_button_click",{element:e,label:t,path:`typography/${e}`}),children:(0,m.jsxs)(y.__experimentalHStack,{justify:"flex-start",children:[(0,m.jsx)(y.FlexItem,{className:"edit-site-global-styles-screen-typography__indicator",style:{fontFamily:null!=o?o:"serif",background:p,color:d,fontStyle:null!=a?a:"normal",fontWeight:null!=s?s:"normal",letterSpacing:null!=l?l:"normal",textDecoration:null!=r?r:"link"===e?"underline":"none",textTransform:null!=c?c:"none"},children:"Aa"}),(0,m.jsx)(y.FlexItem,{children:t})]})})})}const Gn=function(){return(0,m.jsx)(y.Card,{size:"small",variant:"primary",isBorderless:!0,children:(0,m.jsx)(y.CardBody,{children:(0,m.jsxs)(y.__experimentalVStack,{spacing:3,children:[(0,m.jsx)(y.__experimentalHeading,{level:3,className:"edit-site-global-styles-subtitle",children:(0,_.__)("Elements","mailpoet")}),(0,m.jsxs)(y.__experimentalItemGroup,{isBordered:!0,isSeparated:!0,size:"small",children:[(0,m.jsx)(Hn,{element:"text",label:(0,_.__)("Text","mailpoet")}),(0,m.jsx)(Hn,{element:"link",label:(0,_.__)("Links","mailpoet")}),(0,m.jsx)(Hn,{element:"heading",label:(0,_.__)("Headings","mailpoet")}),(0,m.jsx)(Hn,{element:"button",label:(0,_.__)("Buttons","mailpoet")})]})]})})})},$n=(0,m.jsx)($.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,m.jsx)($.Path,{d:"M14.6 7l-1.2-1L8 12l5.4 6 1.2-1-4.6-5z"})});function Un({title:e,description:t,onBack:n}){return(0,m.jsxs)(y.__experimentalVStack,{spacing:0,children:[(0,m.jsx)(y.__experimentalView,{children:(0,m.jsx)(y.__experimentalSpacer,{marginBottom:0,paddingX:4,paddingY:3,children:(0,m.jsxs)(y.__experimentalHStack,{spacing:2,children:[(0,m.jsx)(y.__experimentalNavigatorToParentButton,{style:{minWidth:24,padding:0},icon:$n,size:"small","aria-label":(0,_.__)("Navigate to the previous view","mailpoet"),onClick:n}),(0,m.jsx)(y.__experimentalSpacer,{children:(0,m.jsx)(y.__experimentalHeading,{className:"mailpoet-email-editor-styles-header",level:2,size:13,children:e})})]})})}),t&&(0,m.jsx)("p",{className:"mailpoet-email-editor-styles-header-description",children:t})]})}const Wn=Un;function qn(){return N("styles_sidebar_screen_typography_opened"),(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(Wn,{title:(0,_.__)("Typography","mailpoet"),description:(0,_.__)("Manage the typography settings for different elements.","mailpoet")}),(0,m.jsx)(Gn,{})]})}const Zn={fontFamily:!0,fontSize:!0,fontAppearance:!0,lineHeight:!0,letterSpacing:!1,textTransform:!1,textDecoration:!1,writingMode:!0,textColumns:!0},Yn=function({element:e,headingLevel:t,defaultControls:n=Zn}){const[i,o]=(0,d.useSettings)("typography.fontSizes","typography.fontFamilies"),a=o?.default||[],{styles:s,defaultStyles:r,updateStyleProp:c}=Dn(),p=Vn(s,e,t),u=Vn(r,e,t),{fontFamily:h,fontSize:g,fontStyle:x,fontWeight:f,lineHeight:v,letterSpacing:b,textDecoration:j,textTransform:w}=p.typography,{fontFamily:S,fontSize:k,fontStyle:C,fontWeight:T,lineHeight:N,letterSpacing:I,textDecoration:M,textTransform:B}=u.typography,A="heading"!==e||"heading"!==t,L=(0,l.useCallback)(((n,i)=>{c("heading"===e?["elements",t,...n]:"text"===e?[...n]:["elements",e,...n],i)}),[e,c,t]),R=t=>{L(["typography","letterSpacing"],t),P("styles_sidebar_screen_typography_element_panel_set_letter_spacing",{element:e,newValue:t,selectedDefaultLetterSpacing:t===I})},F=t=>{L(["typography","lineHeight"],t),P("styles_sidebar_screen_typography_element_panel_set_line_height",{element:e,newValue:t,selectedDefaultLineHeight:t===N})},z=n=>{L(["typography","fontSize"],n),P("styles_sidebar_screen_typography_element_panel_set_font_size",{element:e,headingLevel:t,newValue:n,selectedDefaultFontSize:n===k})},D=t=>{L(["typography","fontFamily"],t),P("styles_sidebar_screen_typography_element_panel_set_font_family",{element:e,newValue:t,selectedDefaultFontFamily:t===S})},O=t=>{L(["typography","textDecoration"],t),P("styles_sidebar_screen_typography_element_panel_set_text_decoration",{element:e,newValue:t,selectedDefaultTextDecoration:t===M})},V=t=>{L(["typography","textTransform"],t),P("styles_sidebar_screen_typography_element_panel_set_text_transform",{element:e,newValue:t,selectedDefaultTextTransform:t===B})},H=({fontStyle:t,fontWeight:n})=>{L(["typography","fontStyle"],t),L(["typography","fontWeight"],n),P("styles_sidebar_screen_typography_element_panel_set_font_appearance",{element:e,newFontStyle:t,newFontWeight:n,selectedDefaultFontStyle:t===C,selectedDefaultFontWeight:n===T})};return(0,m.jsxs)(y.__experimentalToolsPanel,{label:(0,_.__)("Typography","mailpoet"),resetAll:()=>{L(["typography"],u.typography),E("styles_sidebar_screen_typography_element_panel_reset_all_styles_selected",{element:e,headingLevel:t})},children:[(0,m.jsx)(y.__experimentalToolsPanelItem,{label:(0,_.__)("Font family","mailpoet"),hasValue:()=>h!==S,onDeselect:()=>D(S),isShownByDefault:n.fontFamily,children:(0,m.jsx)(d.__experimentalFontFamilyControl,{value:h,onChange:D,size:"__unstable-large",fontFamilies:a,__nextHasNoMarginBottom:!0})}),A&&(0,m.jsx)(y.__experimentalToolsPanelItem,{label:(0,_.__)("Font size","mailpoet"),hasValue:()=>g!==k,onDeselect:()=>z(k),isShownByDefault:n.fontSize,children:(0,m.jsx)(y.FontSizePicker,{value:g,onChange:z,fontSizes:i,disableCustomFontSizes:!1,withReset:!1,withSlider:!0,size:"__unstable-large",__nextHasNoMarginBottom:!0})}),(0,m.jsx)(y.__experimentalToolsPanelItem,{className:"single-column",label:(0,_.__)("Appearance","mailpoet"),hasValue:()=>f!==T||x!==C,onDeselect:()=>{H({fontStyle:C,fontWeight:T})},isShownByDefault:n.fontAppearance,children:(0,m.jsx)(d.__experimentalFontAppearanceControl,{value:{fontStyle:x,fontWeight:f},onChange:H,hasFontStyles:!0,hasFontWeights:!0,size:"__unstable-large"})}),(0,m.jsx)(y.__experimentalToolsPanelItem,{className:"single-column",label:(0,_.__)("Line height","mailpoet"),hasValue:()=>v!==N,onDeselect:()=>F(N),isShownByDefault:n.lineHeight,children:(0,m.jsx)(d.LineHeightControl,{__nextHasNoMarginBottom:!0,__unstableInputWidth:"auto",value:v,onChange:F,size:"__unstable-large"})}),(0,m.jsx)(y.__experimentalToolsPanelItem,{className:"single-column",label:(0,_.__)("Letter spacing","mailpoet"),hasValue:()=>b!==I,onDeselect:()=>R(I),isShownByDefault:n.letterSpacing,children:(0,m.jsx)(d.__experimentalLetterSpacingControl,{value:b,onChange:R,size:"__unstable-large",__unstableInputWidth:"auto"})}),(0,m.jsx)(y.__experimentalToolsPanelItem,{className:"single-column",label:(0,_.__)("Text decoration","mailpoet"),hasValue:()=>j!==M,onDeselect:()=>O(M),isShownByDefault:n.textDecoration,children:(0,m.jsx)(d.__experimentalTextDecorationControl,{value:j,onChange:O,size:"__unstable-large",__unstableInputWidth:"auto"})}),(0,m.jsx)(y.__experimentalToolsPanelItem,{label:(0,_.__)("Letter case","mailpoet"),hasValue:()=>w!==B,onDeselect:()=>V(B),isShownByDefault:n.textTransform,children:(0,m.jsx)(d.__experimentalTextTransformControl,{value:w,onChange:V,showNone:!0,isBlock:!0,size:"__unstable-large",__nextHasNoMarginBottom:!0})})]})};function Jn({element:e,headingLevel:t}){const{styles:n}=Dn(),i=Vn(n,e,t,!0),{fontFamily:o,fontSize:a,fontStyle:s,fontWeight:l,lineHeight:r,letterSpacing:c,textDecoration:d,textTransform:p}=i.typography,u=i.color?.text||"inherit",_=i.color?.background||"#f0f0f0",h="link"===e?{textDecoration:null!=d?d:"underline"}:{};return(0,m.jsx)("div",{className:"edit-site-typography-preview",style:{fontFamily:null!=o?o:"serif",background:_,color:u,lineHeight:r,fontSize:a,fontStyle:s,fontWeight:l,letterSpacing:c,textDecoration:d,textTransform:p,...h},children:"Aa"})}const Xn={text:{title:(0,_.__)("Text","mailpoet"),description:(0,_.__)("Manage the fonts and typography used on text.","mailpoet"),defaultControls:Zn},link:{title:(0,_.__)("Links","mailpoet"),description:(0,_.__)("Manage the fonts and typography used on links.","mailpoet"),defaultControls:{...Zn,textDecoration:!0}},heading:{title:(0,_.__)("Headings","mailpoet"),description:(0,_.__)("Manage the fonts and typography used on headings.","mailpoet"),defaultControls:{...Zn,textTransform:!0}},button:{title:(0,_.__)("Buttons","mailpoet"),description:(0,_.__)("Manage the fonts and typography used on buttons.","mailpoet"),defaultControls:Zn}};function Kn({element:e}){N("styles_sidebar_screen_typography_element_opened",{element:e});const[t,n]=(0,l.useState)("heading");return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(Wn,{title:Xn[e].title,description:Xn[e].description}),(0,m.jsx)(y.__experimentalSpacer,{marginX:4,children:(0,m.jsx)(Jn,{element:e,headingLevel:t})}),"heading"===e&&(0,m.jsx)(y.__experimentalSpacer,{marginX:4,marginBottom:"1em",children:(0,m.jsxs)(y.__experimentalToggleGroupControl,{label:(0,_.__)("Select heading level","mailpoet"),hideLabelFromVision:!0,value:t,onChange:e=>{n(e.toString()),E("styles_sidebar_screen_typography_element_heading_level_selected",{value:e})},isBlock:!0,size:"__unstable-large",__nextHasNoMarginBottom:!0,children:[(0,m.jsx)(y.__experimentalToggleGroupControlOption,{value:"heading",label:(0,_._x)("All","heading levels","mailpoet")}),(0,m.jsx)(y.__experimentalToggleGroupControlOption,{value:"h1",label:(0,_._x)("H1","Heading Level","mailpoet")}),(0,m.jsx)(y.__experimentalToggleGroupControlOption,{value:"h2",label:(0,_._x)("H2","Heading Level","mailpoet")}),(0,m.jsx)(y.__experimentalToggleGroupControlOption,{value:"h3",label:(0,_._x)("H3","Heading Level","mailpoet")}),(0,m.jsx)(y.__experimentalToggleGroupControlOption,{value:"h4",label:(0,_._x)("H4","Heading Level","mailpoet")}),(0,m.jsx)(y.__experimentalToggleGroupControlOption,{value:"h5",label:(0,_._x)("H5","Heading Level","mailpoet")}),(0,m.jsx)(y.__experimentalToggleGroupControlOption,{value:"h6",label:(0,_._x)("H6","Heading Level","mailpoet")})]})}),(0,m.jsx)(Yn,{element:e,headingLevel:t,defaultControls:Xn[e].defaultControls})]})}function Qn(){N("styles_sidebar_screen_colors_opened");const{userStyles:e,styles:t,updateStyles:n}=Dn(),i=(0,s.useSelect)((e=>e(I).getTheme()),[]);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(Wn,{title:(0,_.__)("Colors","mailpoet"),description:(0,_.__)("Manage palettes and the default color of different global elements.","mailpoet")}),(0,m.jsx)(st,{value:e,inheritedValue:t,onChange:e=>{n(e),E("styles_sidebar_screen_colors_styles_updated")},settings:i?.settings,panelId:"colors"})]})}function ei(){const[e]=(0,d.useSettings)("spacing.units"),t=(0,y.__experimentalUseCustomUnits)({availableUnits:e}),{styles:n,defaultStyles:i,updateStyleProp:o}=Dn();return(0,m.jsxs)(y.__experimentalToolsPanel,{label:(0,_.__)("Dimensions","mailpoet"),resetAll:()=>{o(["spacing"],i.spacing),E("styles_sidebar_screen_layout_dimensions_reset_all_selected")},children:[(0,m.jsx)(y.__experimentalToolsPanelItem,{isShownByDefault:!0,hasValue:()=>!(0,S.isEqual)(n.spacing.padding,i.spacing.padding),label:(0,_.__)("Padding","mailpoet"),onDeselect:()=>{o(["spacing","padding"],i.spacing.padding),E("styles_sidebar_screen_layout_dimensions_padding_reset_clicked")},className:"tools-panel-item-spacing",children:(0,m.jsx)(d.__experimentalSpacingSizesControl,{allowReset:!0,values:n.spacing.padding,onChange:e=>{o(["spacing","padding"],e),P("styles_sidebar_screen_layout_dimensions_padding_updated",{value:e})},label:(0,_.__)("Padding","mailpoet"),sides:["horizontal","vertical","top","left","right","bottom"],units:t})}),(0,m.jsx)(y.__experimentalToolsPanelItem,{isShownByDefault:!0,label:(0,_.__)("Block spacing","mailpoet"),hasValue:()=>n.spacing.blockGap!==i.spacing.blockGap,onDeselect:()=>{o(["spacing","blockGap"],i.spacing.blockGap),E("styles_sidebar_screen_layout_dimensions_block_spacing_reset_clicked")},className:"tools-panel-item-spacing",children:(0,m.jsx)(d.__experimentalSpacingSizesControl,{label:(0,_.__)("Block spacing","mailpoet"),min:0,onChange:e=>{o(["spacing","blockGap"],e.top),P("styles_sidebar_screen_layout_dimensions_block_spacing_updated",{value:e})},showSideInLabel:!1,sides:["top"],values:{top:n.spacing.blockGap},allowReset:!0})})]})}function ti(){return N("styles_sidebar_screen_layout_opened"),(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(Un,{title:(0,_.__)("Layout","mailpoet")}),(0,m.jsx)(ei,{})]})}const ni=(0,l.memo)((function(e){return(0,m.jsx)(qe,{identifier:"email-editor/editor/styles",className:"mailpoet-email-editor-styles-panel",header:(0,_.__)("Styles","mailpoet"),closeLabel:(0,_.__)("Close styles sidebar","mailpoet"),icon:Pn,scope:I,smallScreenTitle:(0,_.__)("No title","mailpoet"),...e,children:(0,m.jsxs)(y.__experimentalNavigatorProvider,{initialPath:"/",children:[(0,m.jsx)(y.__experimentalNavigatorScreen,{path:"/",children:(0,m.jsx)(Fn,{})}),(0,m.jsx)(y.__experimentalNavigatorScreen,{path:"/typography",children:(0,m.jsx)(qn,{})}),(0,m.jsx)(y.__experimentalNavigatorScreen,{path:"/typography/text",children:(0,m.jsx)(Kn,{element:"text"})}),(0,m.jsx)(y.__experimentalNavigatorScreen,{path:"/typography/link",children:(0,m.jsx)(Kn,{element:"link"})}),(0,m.jsx)(y.__experimentalNavigatorScreen,{path:"/typography/heading",children:(0,m.jsx)(Kn,{element:"heading"})}),(0,m.jsx)(y.__experimentalNavigatorScreen,{path:"/typography/button",children:(0,m.jsx)(Kn,{element:"button"})}),(0,m.jsx)(y.__experimentalNavigatorScreen,{path:"/colors",children:(0,m.jsx)(Qn,{})}),(0,m.jsx)(y.__experimentalNavigatorScreen,{path:"/layout",children:(0,m.jsx)(ti,{})})]})})}));function ii({contentRef:e}){const{onNavigateToEntityRecord:t,templateId:n}=(0,s.useSelect)((e=>{const{getEditorSettings:t,getCurrentTemplateId:n}=e(ne.store);return{onNavigateToEntityRecord:t().onNavigateToEntityRecord,templateId:n()}}),[]),[i,o]=(0,l.useState)(!1);return(0,l.useEffect)((()=>{const t=e=>{e.target.classList.contains("is-root-container")&&(o(!0),N("edit_template_blocks_notification_opened"))},n=e.current;return n?.addEventListener("dblclick",t),()=>{n?.removeEventListener("dblclick",t)}}),[e]),(0,m.jsx)(y.__experimentalConfirmDialog,{isOpen:i,confirmButtonText:(0,_.__)("Edit template","mailpoet"),onConfirm:()=>{o(!1),t({postId:n,postType:"wp_template"}),E("edit_template_blocks_notification_edit_template_button_clicked",{templateId:n})},onCancel:()=>{o(!1),E("edit_template_blocks_notification_cancel_button_clicked",{templateId:n})},size:"medium",children:(0,_.__)("The block you’ve selected is part of a template that might be used in other emails. Are you sure you want to edit the template?","mailpoet")})}function oi(e,t,n){return Math.min(Math.max(e,t),n)}function ai({isEnabled:e=!0}={}){const t=(e=>{const{getEnabledClientIdsTree:t}=it(e);return t})((0,s.useSelect)(d.store)),{getBlockName:n,getBlockOrder:i}=(0,s.useSelect)(d.store),{selectBlock:o}=(0,s.useDispatch)(d.store);return(0,p.useRefEffect)((a=>{if(!e)return null;const s=e=>{(e.target===a||e.target.classList.contains("is-root-container"))&&((e,s)=>{const l=t().flatMap((({clientId:e})=>{const t=n(e);if("core/template-part"===t)return[];if("core/post-content"===t){const t=i(e);if(t.length)return t}return[e]})).reduce(((t,n)=>{const i=a.querySelector(`[data-block="${n}"]`);if(!i)return t;const o=i.getBoundingClientRect(),l=function(e,t,n){const i=e-oi(e,Number(n.left),Number(n.right)),o=t-oi(t,Number(n.top),Number(n.bottom));return Math.sqrt(i*i+o*o)}(Number(e),Number(s),o);return l<t.distance&&l<500?{clientId:n,distance:l}:t}),{clientId:null,distance:Number.POSITIVE_INFINITY}),r=l?.clientId||"";r&&o(r)})(e.clientX,e.clientY)};return a.addEventListener("click",s),()=>a.removeEventListener("click",s)}),[e])}const si="wp_block",li=[si,"wp_template","wp_navigation","wp_template_part"];function ri({styles:e,disableIframe:t=!1,iframeProps:n,contentRef:i,className:o}){var a;const{renderingMode:r,wrapperBlockName:c,wrapperUniqueId:u,deviceType:_,isFocusedEntity:h,layout:g}=(0,s.useSelect)((e=>{const{getCurrentPostId:t,getCurrentPostType:n,getEditorSettings:i,getRenderingMode:o,getDeviceType:a}=e(ne.store),s=n(),l=o();let r;s===si?r="core/block":"post-only"===l&&(r="core/post-content");const c=i();return{renderingMode:l,isDesignPostType:li.includes(s),wrapperBlockName:r,wrapperUniqueId:t(),deviceType:a(),isFocusedEntity:!!c.onNavigateToPreviousEntityRecord,postType:s,isPreview:c.__unstableIsPreviewMode,layout:c.__experimentalFeatures.layout}}),[]),x=(0,d.__experimentalUseResizeCanvas)(_),y=g,f=(0,l.useRef)(),v=(0,d.__unstableUseTypewriter)(),b=(0,p.useMergeRefs)([f,i,"post-only"===r?v:null,ai({isEnabled:"template-locked"===r})]),j=!t||["Tablet","Mobile"].includes(_),w=[...null!==(a=e)&&void 0!==a?a:[],{css:`.is-root-container{display:flow-root; width:${"Desktop"===_?g.contentSize:"100%"}; margin: 0 auto;box-sizing: border-box;}`}];return(0,m.jsx)("div",{className:H()("editor-visual-editor","edit-post-visual-editor",o,{"has-padding":h,"is-iframed":j}),children:(0,m.jsx)(ot,{shouldIframe:j,contentRef:b,styles:w,height:"100%",iframeProps:{...n,style:{...n?.style,...x}},children:(0,m.jsxs)(d.RecursionProvider,{blockName:c,uniqueId:u,children:[(0,m.jsx)(d.BlockList,{className:H()(`is-${_.toLowerCase()}-preview`,"has-global-padding"),layout:y,dropZoneElement:t?f.current:f.current?.parentNode,__unstableDisableDropZone:"template-locked"===r}),"template-locked"===r&&(0,m.jsx)(ii,{contentRef:f})]})})})}function ci(){const[e,t]=(0,l.useState)(!1),{emailContentIsEmpty:n,emailHasEdits:i}=(0,s.useSelect)((e=>({emailContentIsEmpty:e(I).hasEmptyContent(),emailHasEdits:e(I).hasEdits()})),[]);return!n||i||e?null:(0,m.jsx)(It,{onSelectCallback:()=>t(!0)})}function di(){N("editor_layout_loaded");const{isFullscreenActive:e,isSidebarOpened:t,initialSettings:n,previewDeviceType:i,isInserterSidebarOpened:o,isListviewSidebarOpened:a,canUserEditMedia:r,hasFixedToolbar:c,focusMode:p,styles:u}=(0,s.useSelect)((e=>({isFullscreenActive:e(I).isFeatureActive("fullscreenMode"),isSidebarOpened:e(I).isSidebarOpened(),isInserterSidebarOpened:e(ne.store).isInserterOpened(),isListviewSidebarOpened:e(ne.store).isListViewOpened(),initialSettings:e(I).getInitialEditorSettings(),previewDeviceType:e(I).getDeviceType(),canUserEditMedia:e(ie.store).canUser("create","media"),hasFixedToolbar:e(I).isFeatureActive("fixedToolbar"),focusMode:e(I).isFeatureActive("focusMode"),styles:e(I).getStyles()})),[]),{setIsInserterOpened:_}=(0,s.useDispatch)(ne.store),[h]=rt(),g=H()("edit-post-layout",{"is-sidebar-opened":t}),x=(0,l.useRef)(null),y={background:"Desktop"===i?u.color.background:"transparent",fontFamily:u.typography.fontFamily,transition:"all 0.3s ease 0s"},f={...n,mediaUpload:r?oe.uploadMedia:null,hasFixedToolbar:c,focusMode:p};return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(Ze,{isActive:e}),(0,m.jsx)(ne.UnsavedChangesWarning,{}),(0,m.jsx)(ct,{}),(0,m.jsx)(Cn,{}),(0,m.jsx)(Ot,{}),(0,m.jsx)(ni,{}),(0,m.jsx)(ci,{}),(0,m.jsx)(Ke,{className:g,header:(0,m.jsx)(wn,{}),editorNotices:(0,m.jsx)(Nn,{}),content:(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(Nn,{}),(0,m.jsx)(d.BlockSelectionClearer,{className:"edit-post-visual-editor",style:y,onClick:()=>{o&&_(!1)},children:(0,m.jsx)("div",{className:"visual-editor__email_content_wrapper",children:(0,m.jsx)(ri,{disableIframe:!1,styles:[...f.styles,...h],className:"has-global-padding",contentRef:x,iframeProps:{}})})})]}),sidebar:(0,m.jsx)(qe.Slot,{scope:I}),secondarySidebar:o&&(0,m.jsx)(kn,{})||a&&(0,m.jsx)(Sn,{})}),(0,m.jsx)(Ht,{})]})}function pi({postId:e,postType:t,settings:n,initialEdits:i,...o}){const{currentPost:a,onNavigateToEntityRecord:r,onNavigateToPreviousEntityRecord:c}=function(e,t,n){const[i,o]=(0,l.useReducer)(((e,{type:t,post:n,previousRenderingMode:i})=>"push"===t?[...e,{post:n,previousRenderingMode:i}]:"pop"===t&&e.length>1?e.slice(0,-1):e),[{post:{postId:e,postType:t}}]),{post:a,previousRenderingMode:r}=i[i.length-1],{getRenderingMode:c}=(0,s.useSelect)(ne.store),{setRenderingMode:d}=(0,s.useDispatch)(ne.store),p=(0,l.useCallback)((e=>{o({type:"push",post:{postId:e.postId,postType:e.postType},previousRenderingMode:c()}),d(n)}),[c,d,n]),m=(0,l.useCallback)((()=>{o({type:"pop"}),r&&d(r)}),[d,r]);return{currentPost:a,onNavigateToEntityRecord:p,onNavigateToPreviousEntityRecord:i.length>1?m:void 0}}(e,t,"post-only"),{post:d,template:p}=(0,s.useSelect)((e=>{const{getEntityRecord:t}=e(ie.store),{getEditedPostTemplate:n}=e(I),i=t("postType",a.postType,a.postId);return{template:"wp_template"!==a.postType?n():null,post:i}}),[a.postType,a.postId]),u=(0,s.useSelect)((e=>{const{hasFinishedResolution:t,getBlockPatternsForPostType:n}=(e=>{const{hasFinishedResolution:t,getBlockPatternsForPostType:n}=it(e(ie.store));return{hasFinishedResolution:t,getBlockPatternsForPostType:n}})(e),i=n(a.postType);return t("getBlockPatterns")?i:void 0}),[a.postType]),_=(0,l.useMemo)((()=>({...n,onNavigateToEntityRecord:r,onNavigateToPreviousEntityRecord:c,defaultRenderingMode:"template-locked",supportsTemplateMode:!0,__experimentalBlockPatterns:u})),[n,r,c,u]);return!d||"wp_template"!==a.postType&&!p?(0,m.jsx)("div",{className:"spinner-container",children:(0,m.jsx)(y.Spinner,{style:{width:"80px",height:"80px"}})}):(0,m.jsx)(y.SlotFillProvider,{children:(0,m.jsx)(ne.EditorProvider,{settings:_,post:d,initialEdits:i,useSubRegistry:!1,__unstableTemplate:p,...o,children:(0,m.jsxs)(ne.ErrorBoundary,{children:[(0,m.jsx)(di,{}),(0,m.jsx)(ne.PostLockedModal,{})]})})})}const mi=window.wp.dataControls,ui=window.wp.apiFetch;var _i=n.n(ui);const hi=window.wp.htmlEntities,gi=e=>({registry:t})=>t.dispatch(pe.store).toggle(I,e),xi=e=>({registry:t})=>{t.dispatch(ne.store).setDeviceType(e)};function yi(e){return{type:"CHANGE_PREVIEW_STATE",state:{isModalOpened:e}}}function fi(e,t={}){return{type:"CHANGE_PERSONALIZATION_TAGS_STATE",state:{isModalOpened:e,...t}}}function vi(e){return{type:"CHANGE_PREVIEW_STATE",state:{toEmail:e}}}const bi=(e=M)=>({registry:t})=>t.dispatch(Be).enableComplementaryArea(I,e),ji=()=>({registry:e})=>e.dispatch(Be).disableComplementaryArea(I);function wi(e){return{type:"TOGGLE_SETTINGS_SIDEBAR_ACTIVE_TAB",state:{activeTab:e}}}function*Si(){const e=(0,s.select)(I).getEmailPostId(),t=yield(0,s.dispatch)(ie.store).saveEditedEntityRecord("postType",A,e,{throwOnError:!0});t.then((()=>{(0,s.dispatch)(Jt.store).createErrorNotice((0,_.__)("Email saved!","mailpoet"),{type:"snackbar",isDismissible:!0,context:"email-editor"})})),t.catch((()=>{(0,s.dispatch)(Jt.store).createErrorNotice((0,_.__)("The email could not be saved. Please, clear browser cache and reload the page. If the problem persists, duplicate the email and try again.","mailpoet"),{type:"default",isDismissible:!0,context:"email-editor"})}))}const ki=e=>async({registry:t})=>{const n=t.select(I).getEmailPostId();t.dispatch(ie.store).editEntityRecord("postType",A,n,{template:e})};function*Ci(e){if(!(0,s.select)(I).getPreviewState().isSendingPreviewEmail){yield{type:"CHANGE_PREVIEW_STATE",state:{sendingPreviewStatus:null,isSendingPreviewEmail:!0}};try{const t=(0,s.select)(I).getEmailPostId();yield(0,mi.apiFetch)({path:"/mailpoet-email-editor/v1/send_preview_email",method:"POST",data:{email:e,postId:t}}),yield{type:"CHANGE_PREVIEW_STATE",state:{sendingPreviewStatus:on.SUCCESS,isSendingPreviewEmail:!1}},E("sent_preview_email",{postId:t,email:e})}catch(t){E("sent_preview_email_error",{email:e}),yield{type:"CHANGE_PREVIEW_STATE",state:{sendingPreviewStatus:on.ERROR,isSendingPreviewEmail:!1,errorMessage:JSON.stringify(t?.error)}}}}}function Ti(e){return async({registry:t})=>{try{const n=t.select(ie.store).getEntityConfig("postType",e.type),i=(0,nn.addQueryArgs)(`${n.baseURL}/${e.id}`,{context:"edit",source:"theme"}),o=await _i()({path:i}),a=({blocks:e=[]})=>(0,G.__unstableSerializeAndClean)(e),s=(0,G.parse)(o?.content?.raw);await t.dispatch(ie.store).editEntityRecord("postType",e.type,o.id,{content:a,blocks:s,source:"theme"}),await t.dispatch(ie.store).saveEditedEntityRecord("postType",e.type,e.id,{}),t.dispatch(Jt.store).createSuccessNotice((0,_.sprintf)(/* translators: The template/part's name. */ /* translators: The template/part's name. */
(0,_.__)('"%s" reset.',"mailpoet"),(0,hi.decodeEntities)(e.title)),{type:"snackbar",id:"edit-site-template-reverted"})}catch(e){t.dispatch(Jt.store).createErrorNotice((0,_.__)("An error occurred while reverting the template.","mailpoet"),{type:"snackbar"})}}}function Ei(e){return{type:"SET_IS_FETCHING_PERSONALIZATION_TAGS",state:{isFetching:e}}}function Ni(e){return{type:"SET_PERSONALIZATION_TAGS_LIST",state:{list:e}}}function Pi(e,t){switch(t.type){case"CHANGE_PREVIEW_STATE":return{...e,preview:{...e.preview,...t.state}};case"CHANGE_PERSONALIZATION_TAGS_STATE":case"SET_IS_FETCHING_PERSONALIZATION_TAGS":case"SET_PERSONALIZATION_TAGS_LIST":return{...e,personalizationTags:{...e.personalizationTags,...t.state}};case"TOGGLE_SETTINGS_SIDEBAR_ACTIVE_TAB":return{...e,settingsSidebar:{...e.settingsSidebar,activeTab:t.state.activeTab}};case"SET_PERSONALIZATION_TAGS":return{...e,personalizationTags:{...e.personalizationTags,list:t.personalizationTags}};default:return e}}function Ii(e){return e?.content&&"function"==typeof e.content?e.content(e):e?.blocks?(0,G.serialize)(e.blocks):e?.content?e.content:""}const Mi=new WeakMap;function Bi(e){let t=Mi.get(e);return t||(t={...e,get blocks(){return(0,G.parse)(e.content)}},Mi.set(e,t)),t}const Ai=(0,s.createRegistrySelector)((e=>(t,n)=>!!e(pe.store).get(I,n))),Li=(0,s.createRegistrySelector)((e=>()=>!!e(Be).getActiveComplementaryArea(I))),Ri=(0,s.createRegistrySelector)((e=>()=>{const t=e(I).getEmailPostId();return!!e(ie.store).hasEditsForEntityRecord("postType",A,t)})),Fi=(0,s.createRegistrySelector)((e=>()=>{const t=e(I).getEmailPostId();return!!e(ie.store).getEntityRecord("postType",A,t)})),zi=(0,s.createRegistrySelector)((e=>()=>{const t=e(I).getEmailPostId();return!!e(ie.store).isSavingEntityRecord("postType",A,t)})),Di=(0,s.createRegistrySelector)((e=>()=>{const t=e(I).getEmailPostId(),n=e(ie.store).getEntityRecord("postType",A,t);if(!n)return!0;const{content:i,title:o}=n;return!i.raw&&!o.raw})),Oi=(0,s.createRegistrySelector)((e=>()=>{const t=e(I).getEmailPostId(),n=e(ie.store).getEntityRecord("postType",A,t);if(!n)return!0;const{content:i}=n;return!i.raw})),Vi=(0,s.createRegistrySelector)((e=>()=>{const t=e(I).getEmailPostId(),n=e(ie.store).getEntityRecord("postType",A,t);return!!n&&"sent"===n.status})),Hi=(0,s.createRegistrySelector)((e=>()=>{const t=e(I).getEmailPostId(),n=e(ie.store).getEditedEntityRecord("postType",A,t);return n?Ii(n):""})),Gi=(0,s.createRegistrySelector)((e=>()=>e(ie.store).getEntityRecords("postType",A,{per_page:30,status:"publish,sent"})?.filter((e=>""!==e?.content?.raw))||[])),$i=(0,s.createRegistrySelector)((e=>(0,s.createSelector)((()=>e(ie.store).getBlockPatterns().filter((({templateTypes:e})=>Array.isArray(e)&&e.includes("email-template"))).map(Bi)),(()=>[e(ie.store).getBlockPatterns()])))),Ui=(0,s.createRegistrySelector)((e=>()=>{const t=e(ne.store).getEditedPostAttribute("template");if(t){const n=e(ie.store).getEntityRecords("postType","wp_template",{per_page:-1})?.find((e=>e.slug===t));return n?e(ie.store).getEditedEntityRecord("postType","wp_template",n.id):n}const n=e(ie.store).getDefaultTemplateId({slug:"email-general"});return e(ie.store).getEditedEntityRecord("postType","wp_template",n)})),Wi=(0,s.createRegistrySelector)((e=>()=>{if("wp_template"===e(ne.store).getCurrentPostType()){const t=e(ne.store).getCurrentPostId();return e(ie.store).getEditedEntityRecord("postType","wp_template",t)}return Ui()})),qi=()=>{const e=Wi();return e?Ii(e):""},Zi=(0,s.createRegistrySelector)((e=>()=>{const t=e(I).getGlobalStylesPostId();return t?e(ie.store).getEditedEntityRecord("postType","wp_global_styles",t):Ui()})),Yi=(0,s.createRegistrySelector)((e=>()=>e(ie.store).getEntityRecords("postType","wp_template",{per_page:-1,post_type:A})?.filter((e=>e.post_types.includes(A)))));function Ji(e){return e.postId}function Xi(e){return e.settingsSidebar.activeTab}function Ki(e){return e.editorSettings}function Qi(e){return e.editorSettings.__experimentalFeatures.color.palette}function eo(e){return e.preview}function to(e){return e.personalizationTags}function no(e){return e.personalizationTags.list}const io=(0,s.createRegistrySelector)((e=>()=>e(ne.store).getDeviceType()));function oo(e){return e.theme.styles}function ao(e){return e.autosaveInterval}function so(e){return e.theme}function lo(e){return e.styles.globalStylesPostId}function ro(e){return e.urls}function*co(){const e=yield(0,s.select)(I),t=e.personalizationTags?.isFetching;if(!t){yield Ei(!0);try{const e=yield(0,mi.apiFetch)({path:"/mailpoet-email-editor/v1/get_personalization_tags",method:"GET"});yield Ni(e.result)}finally{yield Ei(!1)}}}const po=window.wp.keyboardShortcuts;function mo(){const{undo:e,redo:t}=(0,s.useDispatch)(ie.store),{isSidebarOpened:n,hasEdits:i,isSaving:o}=(0,s.useSelect)((e=>({isSidebarOpened:e(I).isSidebarOpened(),isSaving:e(I).isSaving(),hasEdits:e(I).hasEdits()}))),{openSidebar:a,closeSidebar:r,saveEditedEmail:c,toggleFeature:d}=(0,s.useDispatch)(I),{registerShortcut:p}=(0,s.useDispatch)(po.store);return(0,l.useEffect)((()=>{p({name:"mailpoet/email-editor/toggle-fullscreen",category:"global",description:(0,_.__)("Toggle fullscreen mode.","mailpoet"),keyCombination:{modifier:"secondary",character:"f"}}),p({name:"mailpoet/email-editor/toggle-sidebar",category:"global",description:(0,_.__)("Show or hide the settings sidebar.","mailpoet"),keyCombination:{modifier:"primaryShift",character:","}}),p({name:"mailpoet/email-editor/save",category:"global",description:(0,_.__)("Save your changes.","mailpoet"),keyCombination:{modifier:"primary",character:"s"}}),p({name:"mailpoet/email-editor/undo",category:"block",description:(0,_.__)("Undo your last changes.","mailpoet"),keyCombination:{modifier:"primary",character:"z"}}),p({name:"mailpoet/email-editor/redo",category:"block",description:(0,_.__)("Redo your last undo.","mailpoet"),keyCombination:{modifier:"primaryShift",character:"z"}})}),[p]),(0,po.useShortcut)("mailpoet/email-editor/toggle-fullscreen",(()=>{E("keyboard_shortcuts_toggle_fullscreen"),d("fullscreenMode")})),(0,po.useShortcut)("mailpoet/email-editor/toggle-sidebar",(e=>{E("keyboard_shortcuts_toggle_sidebar"),e.preventDefault(),n?r():a()})),(0,po.useShortcut)("mailpoet/email-editor/save",(e=>{E("keyboard_shortcuts_save"),e.preventDefault(),i&&!o&&c()})),(0,po.useShortcut)("mailpoet/email-editor/undo",(t=>{e(),t.preventDefault()})),(0,po.useShortcut)("mailpoet/email-editor/redo",(e=>{t(),e.preventDefault()})),null}const uo=e=>{(0,r.doAction)("mailpoet_email_editor_events",e.detail)};window.addEventListener("unload",(function(){k&&T.removeEventListener(C,uo)}));const _o=(0,r.applyFilters)("mailpoet_email_editor_wrap_editor_component",(function(){const{postId:e,settings:t}=(0,s.useSelect)((e=>({postId:e(I).getEmailPostId(),settings:e(I).getInitialEditorSettings()})),[]);return(0,m.jsxs)(l.StrictMode,{children:[(0,m.jsx)(mo,{}),(0,m.jsx)(pi,{initialEdits:[],postId:e,postType:A,settings:t})]})}));function ho(e){const t=document.getElementById(e);t&&(k&&T.addEventListener(C,uo),(()=>{const e=(0,s.createReduxStore)(I,{actions:i,controls:mi.controls,selectors:o,resolvers:a,reducer:Pi,initialState:{inserterSidebar:{isOpened:!1},listviewSidebar:{isOpened:!1},settingsSidebar:{activeTab:M},postId:L,editorSettings:window.MailPoetEmailEditor.editor_settings,theme:window.MailPoetEmailEditor.editor_theme,styles:{globalStylesPostId:window.MailPoetEmailEditor.user_theme_post_id},autosaveInterval:60,urls:window.MailPoetEmailEditor.urls,preview:{deviceType:"Desktop",toEmail:window.MailPoetEmailEditor.current_wp_user_email,isModalOpened:!1,isSendingPreviewEmail:!1,sendingPreviewStatus:null},personalizationTags:{list:[],isFetching:!1}}});(0,s.register)(e)})(),(0,r.addFilter)("blocks.registerBlockType","mailpoet-email-editor/layout/addAttribute",K),(0,r.addFilter)("editor.BlockListBlock","mailpoet-email-editor/with-layout-styles",te),(0,r.addFilter)("editor.BlockEdit","mailpoet-email-editor/with-inspector-controls",Q),(0,r.addFilter)("editor.BlockEdit","mailpoet-email-editor/deactivate-stack-on-mobile",u),(0,r.addFilter)("editor.BlockEdit","mailpoet-email-editor/hide-expand-on-click",g),(0,r.addFilter)("blocks.registerBlockType","mailpoet-email-editor/deactivate-image-filter",((e,t)=>"core/image"===t?{...e,supports:{...e.supports,filter:{duetone:!1}}}:e)),(0,x.unregisterFormatType)("core/image"),(0,x.unregisterFormatType)("core/code"),(0,x.unregisterFormatType)("core/language"),(0,r.addFilter)("blocks.registerBlockType","mailpoet-email-editor/disable-columns-layout",((e,t)=>"core/columns"===t||"core/column"===t?{...e,supports:{...e.supports,layout:!1}}:e)),(0,r.addFilter)("blocks.registerBlockType","mailpoet-email-editor/disable-group-variations",((e,t)=>"core/group"===t?{...e,variations:e.variations.filter((e=>"group"===e.name)),supports:{...e.supports,layout:!1}}:e)),(0,r.addFilter)("blocks.registerBlockType","mailpoet-email-editor/change-button",((e,t)=>"core/button"===t?{...e,styles:[]}:e)),(0,r.addFilter)("blocks.registerBlockType","mailpoet-email-editor/change-buttons",((e,t)=>"core/buttons"===t?{...e,supports:{...e.supports,layout:!1,__experimentalEmailFlexLayout:!0}}:e)),(0,r.addFilter)("blocks.registerBlockType","mailpoet-email-editor/change-column",((e,t)=>"core/column"===t?{...e,supports:{...e.supports,background:{backgroundImage:!0}}}:e)),(0,r.addFilter)("blocks.registerBlockType","mailpoet-email-editor/change-columns",((e,t)=>"core/columns"===t?{...e,supports:{...e.supports,background:{backgroundImage:!0}}}:e)),(0,r.addFilter)("blocks.registerBlockType","mailpoet-email-editor/change-post-content",((e,t)=>{return"core/post-content"===t?{...e,edit:(n=e.edit,function({context:e,__unstableLayoutClassNames:t}){const{postId:i,postType:o}=e;return i&&o?(0,m.jsx)(n,{context:e,__unstableLayoutClassNames:t}):(0,m.jsx)(h,{layoutClassNames:t})})}:e;var n})),(0,x.registerFormatType)("mailpoet-email-editor/shortcode",{name:"mailpoet-email-editor/shortcode",title:(0,_.__)("Personalization Tags","mailpoet"),className:"mailpoet-email-editor-personalization-tags",tagName:"span",attributes:{},edit:D}),(0,x.registerFormatType)("mailpoet-email-editor/link-shortcode",{name:"mailpoet-email-editor/link-shortcode",title:(0,_.__)("Personalization Tags Link","mailpoet"),className:"mailpoet-email-editor-personalization-tags-link",tagName:"a",attributes:{"data-link-href":"data-link-href",contenteditable:"contenteditable",style:"style"},edit:null}),(0,r.addFilter)("editor.BlockEdit","mailpoet-email-editor/with-live-content-update",O),(0,r.addFilter)("blocks.registerBlockType","mailpoet-email-editor/block-support",(e=>e.supports?.shadow?{...e,supports:{...e.supports,shadow:!1}}:e)),(0,c.registerCoreBlocks)(),(0,r.addFilter)("editor.MediaUpload","mailpoet/email-editor/replace-media-upload",(()=>oe.MediaUpload)),(0,l.createRoot)(t).render((0,m.jsx)(_o,{})))}window.addEventListener("DOMContentLoaded",(()=>{ho("mailpoet-email-editor")}))})()})();
>>>>>>> b1eea7a (Merged existing code from https://dev-vices.rafaeldeveloper.co)
